<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¯ YouTube í”„ë¡œ ë¶„ì„ê¸° - ì™„ì „ ë²¤ì¹˜ë§ˆí‚¹ ë„êµ¬</title>
    <style>
        :root {
            --bg-primary: #0f0f23;
            --bg-secondary: #1a1a2e;
            --bg-tertiary: #16213e;
            --bg-elevated: #0e3460;
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --text-tertiary: #707070;
            --accent-primary: #ff6b6b;
            --accent-secondary: #4ecdc4;
            --accent-tertiary: #45b7d1;
            --success: #51cf66;
            --warning: #ffd43b;
            --error: #ff6b6b;
            --purple: #8b5cf6;
            --pink: #ec4899;
            --space-xs: 4px;
            --space-sm: 8px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 32px;
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-xl: 16px;
            --transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --shadow: 0 10px 25px rgba(0,0,0,0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: var(--space-lg);
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: var(--space-xl);
            position: relative;
        }

        .header-container {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .api-settings-btn {
            position: absolute;
            top: 0;
            right: 0;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border: none;
            border-radius: var(--radius-lg);
            color: white;
            padding: var(--space-md) var(--space-lg);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition);
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }

        .api-settings-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
        }

        .api-settings-btn.connected {
            background: linear-gradient(135deg, var(--success), #40c057);
            box-shadow: 0 4px 12px rgba(81, 207, 102, 0.3);
        }

        .api-settings-btn.connected:hover {
            box-shadow: 0 6px 20px rgba(81, 207, 102, 0.4);
        }

        .api-status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: white;
        }

        .quota-monitor {
            position: absolute;
            top: 50px;
            right: 0;
            background: var(--bg-secondary);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: var(--radius-md);
            padding: var(--space-sm) var(--space-md);
            font-size: 0.8rem;
            color: var(--text-secondary);
            min-width: 150px;
        }

        .quota-usage {
            font-weight: 600;
        }

        .quota-warning {
            color: var(--warning) !important;
        }

        .quota-critical {
            color: var(--error) !important;
        }

        @media (max-width: 768px) {
            .api-settings-btn {
                position: static;
                margin-top: var(--space-md);
                align-self: center;
            }
        }

        .header h1 {
            font-size: clamp(2rem, 5vw, 3.5rem);
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary), var(--accent-tertiary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: var(--space-md);
        }

        .header p {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: var(--space-lg);
        }

        .api-key-setup {
            background: linear-gradient(135deg, var(--warning), #f59e0b);
            color: #000;
            padding: var(--space-md);
            border-radius: var(--radius-lg);
            margin-bottom: var(--space-lg);
            font-weight: 500;
            display: none;
        }

        .api-key-setup.show {
            display: block;
        }

        /* Navigation */
        .nav-tabs {
            display: flex;
            gap: var(--space-sm);
            margin-bottom: var(--space-xl);
            overflow-x: auto;
            padding: var(--space-sm);
            border-radius: var(--radius-lg);
            background: var(--bg-secondary);
        }

        .nav-tab {
            padding: var(--space-md) var(--space-lg);
            background: transparent;
            border: 1px solid transparent;
            border-radius: var(--radius-md);
            color: var(--text-secondary);
            cursor: pointer;
            font-weight: 500;
            transition: all var(--transition);
            white-space: nowrap;
            flex-shrink: 0;
        }

        .nav-tab.active {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            border-color: transparent;
            box-shadow: var(--shadow);
        }

        /* Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Cards */
        .card {
            background: var(--bg-secondary);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            margin-bottom: var(--space-lg);
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .card-header {
            margin-bottom: var(--space-lg);
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        /* Forms */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--space-lg);
            margin-bottom: var(--space-lg);
        }

        .quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-sm);
            margin-bottom: var(--space-lg);
        }

        .quick-action {
            padding: var(--space-xs) var(--space-md);
            background: var(--bg-tertiary);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: var(--radius-lg);
            color: var(--text-primary);
            text-decoration: none;
            font-size: 0.9rem;
            transition: all var(--transition);
        }

        .quick-action:hover {
            background: var(--accent-primary);
            color: white;
            transform: translateY(-1px);
        }

        .advanced-filters-section {
            margin-bottom: var(--space-lg);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: var(--radius-lg);
        }

        .advanced-filters-toggle {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-md);
            cursor: pointer;
            user-select: none;
            transition: all var(--transition);
        }

        .advanced-filters-toggle:hover {
            background: rgba(255,255,255,0.05);
        }

        .advanced-filters-toggle.active {
            background: rgba(255,255,255,0.1);
        }

        .toggle-icon {
            transition: transform var(--transition);
        }

        .advanced-filters-content {
            border-top: 1px solid rgba(255,255,255,0.1);
            padding: var(--space-lg);
        }

        .filter-category {
            margin-bottom: var(--space-lg);
        }

        .filter-category-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--space-md);
            padding-bottom: var(--space-sm);
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .filter-actions {
            display: flex;
            gap: var(--space-md);
            margin-top: var(--space-lg);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .btn-accent {
            background: linear-gradient(135deg, var(--accent-tertiary), var(--purple));
            color: white;
        }

        .results-section {
            margin-top: var(--space-xl);
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-lg);
        }

        .results-count {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .video-card {
            background: var(--bg-secondary);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: var(--radius-lg);
            overflow: hidden;
            transition: all var(--transition);
            position: relative;
        }

        .video-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow);
            border-color: var(--accent-primary);
        }

        .video-card.benchmark-selected {
            border-color: var(--accent-secondary);
            box-shadow: 0 0 20px rgba(78, 205, 196, 0.3);
        }

        .benchmark-checkbox {
            position: absolute;
            top: 8px;
            left: 8px;
            width: 20px;
            height: 20px;
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid var(--accent-secondary);
            border-radius: 4px;
            cursor: pointer;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition);
        }

        .benchmark-checkbox:hover {
            background: rgba(78, 205, 196, 0.2);
            border-color: var(--accent-primary);
        }

        .benchmark-checkbox.checked {
            background: var(--accent-secondary);
            border-color: var(--accent-primary);
        }

        .benchmark-checkbox.checked::after {
            content: 'âœ“';
            color: white;
            font-weight: bold;
            font-size: 14px;
        }

        .benchmark-controls {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-elevated);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-lg);
            padding: var(--space-md);
            box-shadow: var(--shadow);
            z-index: 1000;
            display: none;
            align-items: center;
            gap: var(--space-md);
            backdrop-filter: blur(10px);
        }

        .benchmark-controls.show {
            display: flex;
        }

        .benchmark-info {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .benchmark-btn {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border: none;
            border-radius: var(--radius-md);
            color: white;
            padding: var(--space-sm) var(--space-md);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition);
        }

        .benchmark-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.4);
        }

        .benchmark-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .benchmark-results {
            margin-top: var(--space-lg);
            padding: var(--space-lg);
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .benchmark-results h3 {
            color: var(--accent-secondary);
            margin-bottom: var(--space-md);
        }

        .benchmark-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
        }

        .benchmark-stat {
            background: var(--bg-tertiary);
            padding: var(--space-md);
            border-radius: var(--radius-md);
            text-align: center;
        }

        .benchmark-stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent-primary);
        }

        .benchmark-stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: var(--space-xs);
        }

        /* Benchmark Report Overlay */
        .benchmark-report-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(6px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .benchmark-report {
            width: min(1200px, 96vw);
            height: min(90vh, 900px);
            background: var(--bg-secondary);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .benchmark-report-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--space-md) var(--space-lg);
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .benchmark-report-body {
            padding: var(--space-lg);
            overflow: auto;
            display: grid;
            gap: var(--space-lg);
        }

        .report-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--space-lg);
        }

        .report-card {
            background: var(--bg-tertiary);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: var(--radius-lg);
            padding: var(--space-md);
        }

        /* ì „ë¬¸ê°€ ì»¨ì„¤íŒ… ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .consulting-section {
            margin-top: 32px;
            padding: 24px;
            background: linear-gradient(135deg, var(--bg-primary), var(--bg-secondary));
            border-radius: 16px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .consulting-section h2 {
            text-align: center;
            margin-bottom: 32px;
            color: var(--accent-primary);
            font-size: 2rem;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .consulting-item {
            background: var(--bg-tertiary);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .consulting-item h3 {
            color: var(--accent-secondary);
            font-size: 1.5rem;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--accent-secondary);
        }

        .consulting-item h4 {
            color: var(--accent-tertiary);
            font-size: 1.2rem;
            margin: 20px 0 12px 0;
            font-weight: 600;
        }

        .consulting-item ul {
            margin: 0;
            padding-left: 20px;
        }

        .consulting-item li {
            margin-bottom: 8px;
            line-height: 1.6;
            color: var(--text-primary);
        }

        .insights, .recommendations, .action-items, .content-ideas, .seo-optimization, .thumbnail-templates, .script-templates, .marketing-channels {
            margin-bottom: 20px;
        }

        .phases {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }

        .phase {
            background: var(--bg-primary);
            padding: 16px;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .phase h4 {
            color: var(--accent-primary);
            margin-bottom: 12px;
            font-size: 1.1rem;
        }

        .kpis {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            padding: 16px;
            border-radius: 8px;
            color: white;
        }

        .kpis h4 {
            color: white;
            margin-bottom: 12px;
        }

        .kpis li {
            color: white;
            font-weight: 500;
        }

        .bar {
            height: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 999px;
            overflow: hidden;
        }

        .bar > span {
            display: block;
            height: 100%;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            width: 0;
        }

        .copy-btn {
            background: var(--bg-tertiary);
            border: 1px solid rgba(255,255,255,0.2);
            color: var(--text-primary);
            border-radius: var(--radius-md);
            padding: 4px 10px;
            font-size: 12px;
            cursor: pointer;
        }

        .thumbnail {
            position: relative;
            width: 100%;
            aspect-ratio: 16/9;
            overflow: hidden;
        }

        .thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .duration {
            position: absolute;
            bottom: 8px;
            right: 8px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .outlier-badge {
            position: absolute;
            top: 8px;
            left: 8px;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
            backdrop-filter: blur(10px);
        }

        .rank-s { background: rgba(255, 215, 0, 0.9); color: #000; }
        .rank-a { background: rgba(50, 205, 50, 0.9); color: #000; }
        .rank-b { background: rgba(65, 105, 225, 0.9); color: white; }
        .rank-c { background: rgba(255, 165, 0, 0.9); color: #000; }
        .rank-d { background: rgba(220, 20, 60, 0.9); color: white; }

        .video-info {
            padding: var(--space-md);
        }

        .video-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--space-sm);
            line-height: 1.4;
            text-decoration: none;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .video-title:hover {
            color: var(--accent-primary);
        }

        .channel-name {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: var(--space-xs);
        }

        .video-meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-sm);
            font-size: 0.8rem;
            color: var(--text-tertiary);
            margin-bottom: var(--space-sm);
        }

        .benchmarking-data {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-xs);
            font-size: 0.7rem;
        }

        .benchmarking-data span {
            background: rgba(255,255,255,0.1);
            padding: 2px 6px;
            border-radius: 4px;
        }

        .video-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-sm) var(--space-md);
            background: rgba(255,255,255,0.05);
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .outlier-score-detail {
            text-align: center;
        }

        .score-main {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--accent-primary);
        }

        .score-label {
            font-size: 0.7rem;
            color: var(--text-tertiary);
        }

        .view-count {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .published {
            font-size: 0.7rem;
            color: var(--text-tertiary);
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
        }

        .form-label {
            font-weight: 500;
            color: var(--text-secondary);
        }

        .form-input, .form-select {
            padding: var(--space-md);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-md);
            background: var(--bg-tertiary);
            color: var(--text-primary);
            font-size: 1rem;
            transition: all var(--transition);
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.1);
        }

        /* í‚¤ì›Œë“œ ì…ë ¥ ê´€ë ¨ ìŠ¤íƒ€ì¼ */
        .keyword-input-container {
            width: 100%;
        }

        .keyword-input-wrapper {
            display: flex;
            gap: var(--space-sm);
            align-items: center;
        }

        .keyword-input {
            flex: 1;
        }

        .add-keyword-btn {
            padding: var(--space-md);
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            border: none;
            border-radius: var(--radius-md);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition);
            white-space: nowrap;
        }

        .add-keyword-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3);
        }

        .keywords-display {
            margin-top: var(--space-md);
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-sm);
            min-height: 40px;
            padding: var(--space-sm);
            border: 1px dashed rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-md);
            background: rgba(255, 255, 255, 0.02);
        }

        .keyword-tag {
            display: inline-flex;
            align-items: center;
            gap: var(--space-xs);
            padding: var(--space-xs) var(--space-sm);
            background: linear-gradient(135deg, var(--accent-tertiary), var(--purple));
            color: white;
            border-radius: var(--radius-sm);
            font-size: 0.85rem;
            font-weight: 500;
            transition: all var(--transition);
            cursor: default;
        }

        .keyword-tag.url-tag {
            background: linear-gradient(135deg, var(--success), #40c057);
        }

        .keyword-tag .remove-tag {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
            line-height: 1;
        }

        .keyword-tag .remove-tag:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .keywords-display:empty::before {
            content: "í‚¤ì›Œë“œë‚˜ URLì„ ì¶”ê°€í•˜ë©´ ì—¬ê¸°ì— íƒœê·¸ë¡œ í‘œì‹œë©ë‹ˆë‹¤";
            color: var(--text-tertiary);
            font-style: italic;
            font-size: 0.9rem;
        }

        /* Buttons */
        .btn {
            padding: var(--space-md) var(--space-lg);
            border: none;
            border-radius: var(--radius-md);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition);
            text-align: center;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: var(--space-xs);
            justify-content: center;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
        }

        .btn-analysis {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 8px;
            width: 100%;
        }

        .btn-analysis:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);
        }

        .analysis-actions {
            margin-top: 12px;
        }

        /* Loading */
        .loading {
            display: none;
            text-align: center;
            padding: var(--space-xl);
        }

        .loading.show {
            display: block;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 107, 107, 0.3);
            border-top: 4px solid var(--accent-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto var(--space-md);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Results */
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: var(--space-lg);
            margin-top: var(--space-lg);
        }

        .video-card {
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all var(--transition);
            cursor: pointer;
        }

        .video-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow);
        }

        .video-thumbnail {
            position: relative;
            width: 100%;
            height: 200px;
            overflow: hidden;
        }

        .video-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .video-info {
            padding: var(--space-md);
        }

        .video-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--space-sm);
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .video-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Analytics */
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-lg);
            margin-bottom: var(--space-lg);
        }

        .metric-card {
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .metric-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--space-xs);
        }

        .metric-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Insights */
        .insights {
            margin-top: var(--space-lg);
        }

        .insight-item {
            padding: var(--space-md);
            border-radius: var(--radius-md);
            margin-bottom: var(--space-sm);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .insight-item.success {
            background: rgba(81, 207, 102, 0.1);
            border-left: 4px solid var(--success);
        }

        .insight-item.warning {
            background: rgba(255, 212, 59, 0.1);
            border-left: 4px solid var(--warning);
        }

        .insight-item.info {
            background: rgba(69, 183, 209, 0.1);
            border-left: 4px solid var(--accent-tertiary);
        }

        /* Progress bars */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-sm);
            overflow: hidden;
            margin: var(--space-sm) 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            transition: width var(--transition);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: var(--bg-secondary);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: var(--space-md);
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .analytics-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .results-grid {
                grid-template-columns: 1fr;
            }

            .api-settings-btn {
                position: static;
                margin-top: var(--space-md);
            }
        }

        /* Analysis Modal Styles */
        .analysis-modal {
            z-index: 10000;
        }

        .analysis-content {
            max-width: 95vw;
            max-height: 95vh;
            width: 1200px;
            overflow-y: auto;
            padding: 0;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px;
            border-bottom: 1px solid var(--border-color);
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
        }

        .modal-header h2 {
            margin: 0;
            font-size: 24px;
        }

        .close-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            font-size: 24px;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .analysis-loading {
            text-align: center;
            padding: 60px 20px;
        }

        .spinner-large {
            width: 60px;
            height: 60px;
            border: 6px solid rgba(99, 102, 241, 0.3);
            border-top: 6px solid #6366f1;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 24px;
        }

        .analysis-loading h3 {
            color: var(--accent-primary);
            margin-bottom: 12px;
        }

        .analysis-loading p {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .analysis-results {
            padding: 24px;
            max-height: calc(95vh - 100px);
            overflow-y: auto;
        }

        .analysis-section {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
        }

        .analysis-section h3 {
            color: var(--accent-primary);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .metric-card {
            background: white;
            padding: 16px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .metric-card h4 {
            margin: 0 0 12px 0;
            color: var(--text-primary);
            font-size: 14px;
            font-weight: 600;
        }

        .metric-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--accent-primary);
            margin-bottom: 4px;
        }

        .metric-label {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .recommendations-card {
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            border: 2px solid var(--accent-primary);
            border-radius: 12px;
            padding: 24px;
            margin-top: 20px;
        }

        .recommendations-card h3 {
            color: var(--accent-primary);
            margin-bottom: 20px;
        }

        .recommendation-item {
            background: white;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 12px;
            border-left: 4px solid var(--accent-primary);
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .recommendation-item h4 {
            margin: 0 0 8px 0;
            color: var(--text-primary);
        }

        .recommendation-item p {
            margin: 0;
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.5;
        }

        .chart-container {
            background: white;
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
            border: 1px solid var(--border-color);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-container">
                <button class="api-settings-btn" id="apiSettingsBtn" onclick="openApiModal()">
                    <span class="api-status-indicator"></span>
                    <span id="apiSettingsBtnText">âš™ï¸ API ì„¤ì •</span>
                </button>
                
                <div class="quota-monitor" id="quotaMonitor">
                    <div>ğŸ“Š API ì‚¬ìš©ëŸ‰</div>
                    <div class="quota-usage" id="quota-usage">0/10000 (0.0%)</div>
                </div>
                
                <h1>ğŸ¯ YouTube í”„ë¡œ ë¶„ì„ê¸°</h1>
                <p>YouTube Data APIë¥¼ í™œìš©í•œ ì™„ì „ ë²¤ì¹˜ë§ˆí‚¹ & ê²½ìŸë¶„ì„ ë„êµ¬</p>
            </div>
            
            <div class="api-key-setup" id="apiKeySetup">
                <strong>âš ï¸ API ì„¤ì • í•„ìš”:</strong> 
                YouTube Data API í‚¤ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.
            </div>
        </div>

        <!-- API Usage Monitor -->
        <div class="quota-monitor" id="quotaMonitor" style="text-align: center; margin: 20px 0; padding: 12px; background: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border-color);">
            <div style="font-size: 14px; font-weight: 500; margin-bottom: 4px;">ğŸ“Š API ì‚¬ìš©ëŸ‰</div>
            <div class="quota-usage" id="quota-usage" style="font-weight: 600;">0/10000 (0.0%)</div>
        </div>

        <!-- Navigation -->
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="switchTab('search')">ğŸ” ì˜ìƒ ê²€ìƒ‰</button>
            <button class="nav-tab" onclick="switchTab('competitor')">ğŸ† ê²½ìŸì ë¶„ì„</button>
            <button class="nav-tab" onclick="switchTab('trending')">ğŸ”¥ íŠ¸ë Œë“œ ë¶„ì„</button>
            <button class="nav-tab" onclick="switchTab('channel')">ğŸ“º ì±„ë„ ë¶„ì„</button>
            <button class="nav-tab" onclick="switchTab('keywords')">ğŸ’¡ í‚¤ì›Œë“œ ë§ˆì´ë‹</button>
            <button class="nav-tab" onclick="switchTab('analytics')">ğŸ“Š ì¢…í•© ë¶„ì„</button>
        </div>

        <!-- ì˜ìƒ ê²€ìƒ‰ íƒ­ -->
        <div id="search-tab" class="tab-content active">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸ” ê³ ê¸‰ ì˜ìƒ ê²€ìƒ‰ & ë¶„ì„</h3>
                </div>
                
                <form id="search-form">
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">ê²€ìƒ‰ í‚¤ì›Œë“œ/URL ì…ë ¥</label>
                        <div class="keyword-input-container">
                            <div class="keyword-input-wrapper">
                                <input type="text" id="searchQuery" class="form-input keyword-input" placeholder="í‚¤ì›Œë“œë‚˜ YouTube URLì„ ì…ë ¥í•˜ì„¸ìš”...">
                                <button type="button" id="addKeywordBtn" class="add-keyword-btn">ì¶”ê°€</button>
                            </div>
                            <div class="keywords-display" id="keywordsDisplay"></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ê²°ê³¼ ìˆ˜</label>
                        <select id="maxResults" class="form-select">
                            <option value="25">25ê°œ</option>
                            <option value="50">50ê°œ</option>
                            <option value="100">100ê°œ</option>
                            <option value="custom">ì§ì ‘ ì…ë ¥</option>
                        </select>
                        <input type="number" id="maxResultsCustom" class="form-input" 
                               placeholder="ê²°ê³¼ ìˆ˜ ì…ë ¥ (1-50)" 
                               min="1" max="50" 
                               style="display: none; margin-top: 8px;">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ì •ë ¬ ê¸°ì¤€</label>
                        <select id="orderBy" class="form-select">
                            <option value="relevance">ê´€ë ¨ë„</option>
                            <option value="viewCount">ì¡°íšŒìˆ˜</option>
                            <option value="date">ìµœì‹ ìˆœ</option>
                            <option value="rating">í‰ì ìˆœ</option>
                            <option value="outlier">Outlier Score</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ì˜ìƒ ê¸¸ì´</label>
                        <select id="videoDuration" class="form-select">
                            <option value="">ì „ì²´</option>
                            <option value="short">ìˆì¸  (4ë¶„ ë¯¸ë§Œ)</option>
                            <option value="medium">ì¤‘ê°„ (4-20ë¶„)</option>
                            <option value="long">ê¸´ì˜ìƒ (20ë¶„ ì´ìƒ)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ì—…ë¡œë“œ ê¸°ê°„</label>
                        <select id="publishedAfter" class="form-select">
                            <option value="">ì „ì²´</option>
                            <option value="day">24ì‹œê°„ ì´ë‚´</option>
                            <option value="week">1ì£¼ì¼ ì´ë‚´</option>
                            <option value="month">1ê°œì›” ì´ë‚´</option>
                            <option value="year">1ë…„ ì´ë‚´</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ì§€ì—­</label>
                        <select id="regionCode" class="form-select">
                            <option value="KR">í•œêµ­</option>
                            <option value="US">ë¯¸êµ­</option>
                            <option value="JP">ì¼ë³¸</option>
                            <option value="GB">ì˜êµ­</option>
                        </select>
                    </div>
                </div>
                <div class="quick-actions">
                    <a href="#" class="quick-action" onclick="quickSearch('ìš”ë¦¬ ë ˆì‹œí”¼')">ìš”ë¦¬ ë ˆì‹œí”¼</a>
                    <a href="#" class="quick-action" onclick="quickSearch('í”„ë¡œê·¸ë˜ë° ê°•ì˜')">í”„ë¡œê·¸ë˜ë°</a>
                    <a href="#" class="quick-action" onclick="quickSearch('ì¬í…Œí¬')">ì¬í…Œí¬</a>
                    <a href="#" class="quick-action" onclick="quickSearch('ìš´ë™')">í™ˆíŠ¸ë ˆì´ë‹</a>
                    <a href="#" class="quick-action" onclick="quickSearch('ê²Œì„')">ê²Œì„</a>
                    <a href="#" class="quick-action" onclick="quickSearch('ë·°í‹°')">ë·°í‹°</a>
                </div>
                <!-- ê³ ê¸‰ ë²¤ì¹˜ë§ˆí‚¹ í•„í„° -->
                <div class="advanced-filters-section">
                    <div class="advanced-filters-toggle" onclick="toggleAdvancedFilters()">
                        <span>ğŸ“Š ê³ ê¸‰ ë²¤ì¹˜ë§ˆí‚¹ í•„í„°</span>
                        <span class="toggle-icon">â–¼</span>
                    </div>
                    
                    <div class="advanced-filters-content" id="advanced-filters" style="display: none;">
                        <!-- í•µì‹¬ ì„±ê³¼ ì§€í‘œ -->
                        <div class="filter-category">
                            <h4 class="filter-category-title">ğŸ¯ í•µì‹¬ ì„±ê³¼ ì§€í‘œ</h4>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label class="form-label">ìµœì†Œ Outlier Score</label>
                                    <select id="minOutlierScore" class="form-select">
                                        <option value="">ì œí•œì—†ìŒ</option>
                                        <option value="1">1ì +</option>
                                        <option value="2">2ì +</option>
                                        <option value="3">3ì +</option>
                                        <option value="4">4ì +</option>
                                        <option value="5">5ì  (ìµœìƒìœ„)</option>
                                        <option value="custom">ì§ì ‘ì…ë ¥</option>
                                    </select>
                                    <input type="number" id="minOutlierScoreCustom" class="form-input" placeholder="0-5" min="0" max="5" step="0.1" style="display: none; margin-top: 4px;">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">ìµœì†Œ ë­í¬ ë“±ê¸‰</label>
                                    <select id="minRankGrade" class="form-select">
                                        <option value="">ì „ì²´ ë“±ê¸‰</option>
                                        <option value="D">Dë“±ê¸‰+</option>
                                        <option value="C">Cë“±ê¸‰+</option>
                                        <option value="B">Bë“±ê¸‰+</option>
                                        <option value="A">Aë“±ê¸‰+</option>
                                        <option value="S">Së“±ê¸‰ë§Œ</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <!-- ì¡°íšŒìˆ˜ & ì±„ë„ ê·œëª¨ -->
                        <div class="filter-category">
                            <h4 class="filter-category-title">ğŸ“Š ê·œëª¨ í•„í„°</h4>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label class="form-label">ì¡°íšŒìˆ˜ ë²”ìœ„</label>
                                    <div style="display: flex; gap: 4px;">
                                        <select id="minViews" class="form-select" style="flex: 1;">
                                            <option value="">ìµœì†Œ</option>
                                            <option value="1000">1K+</option>
                                            <option value="10000">10K+</option>
                                            <option value="100000">100K+</option>
                                            <option value="1000000">1M+</option>
                                            <option value="custom">ì§ì ‘</option>
                                        </select>
                                        <select id="maxViews" class="form-select" style="flex: 1;">
                                            <option value="">ìµœëŒ€</option>
                                            <option value="10000">10K</option>
                                            <option value="100000">100K</option>
                                            <option value="1000000">1M</option>
                                            <option value="10000000">10M</option>
                                            <option value="custom">ì§ì ‘</option>
                                        </select>
                                    </div>
                                    <div style="display: flex; gap: 4px; margin-top: 4px;">
                                        <input type="number" id="minViewsCustom" class="form-input" placeholder="ìµœì†Œ" style="display: none; flex: 1;">
                                        <input type="number" id="maxViewsCustom" class="form-input" placeholder="ìµœëŒ€" style="display: none; flex: 1;">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">êµ¬ë…ì ë²”ìœ„</label>
                                    <div style="display: flex; gap: 4px;">
                                        <select id="minSubscribers" class="form-select" style="flex: 1;">
                                            <option value="">ìµœì†Œ</option>
                                            <option value="1000">1K+</option>
                                            <option value="10000">10K+</option>
                                            <option value="100000">100K+</option>
                                            <option value="1000000">1M+</option>
                                            <option value="custom">ì§ì ‘</option>
                                        </select>
                                        <select id="maxSubscribers" class="form-select" style="flex: 1;">
                                            <option value="">ìµœëŒ€</option>
                                            <option value="10000">10K</option>
                                            <option value="100000">100K</option>
                                            <option value="1000000">1M</option>
                                            <option value="10000000">10M</option>
                                            <option value="custom">ì§ì ‘</option>
                                        </select>
                                    </div>
                                    <div style="display: flex; gap: 4px; margin-top: 4px;">
                                        <input type="number" id="minSubscribersCustom" class="form-input" placeholder="ìµœì†Œ" style="display: none; flex: 1;">
                                        <input type="number" id="maxSubscribersCustom" class="form-input" placeholder="ìµœëŒ€" style="display: none; flex: 1;">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- ì°¸ì—¬ë„ ì§€í‘œ -->
                        <div class="filter-category">
                            <h4 class="filter-category-title">ğŸ’¬ ì°¸ì—¬ë„ í•„í„°</h4>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label class="form-label">ìµœì†Œ ì°¸ì—¬ìœ¨ (%)</label>
                                    <select id="minEngagementRate" class="form-select">
                                        <option value="">ì œí•œì—†ìŒ</option>
                                        <option value="1">1%+</option>
                                        <option value="2">2%+</option>
                                        <option value="5">5%+</option>
                                        <option value="10">10%+</option>
                                        <option value="custom">ì§ì ‘ì…ë ¥</option>
                                    </select>
                                    <input type="number" id="minEngagementRateCustom" class="form-input" placeholder="0-100%" min="0" max="100" step="0.1" style="display: none; margin-top: 4px;">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">ì¢‹ì•„ìš”/ëŒ“ê¸€</label>
                                    <div style="display: flex; gap: 4px;">
                                        <select id="minLikes" class="form-select" style="flex: 1;">
                                            <option value="">ì¢‹ì•„ìš”</option>
                                            <option value="100">100+</option>
                                            <option value="1000">1K+</option>
                                            <option value="10000">10K+</option>
                                            <option value="custom">ì§ì ‘</option>
                                        </select>
                                        <select id="minComments" class="form-select" style="flex: 1;">
                                            <option value="">ëŒ“ê¸€</option>
                                            <option value="10">10+</option>
                                            <option value="100">100+</option>
                                            <option value="1000">1K+</option>
                                            <option value="custom">ì§ì ‘</option>
                                        </select>
                                    </div>
                                    <div style="display: flex; gap: 4px; margin-top: 4px;">
                                        <input type="number" id="minLikesCustom" class="form-input" placeholder="ì¢‹ì•„ìš”" style="display: none; flex: 1;">
                                        <input type="number" id="minCommentsCustom" class="form-input" placeholder="ëŒ“ê¸€" style="display: none; flex: 1;">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="filter-actions">
                            <button type="button" class="btn btn-secondary" onclick="resetAdvancedFilters()">í•„í„° ì´ˆê¸°í™”</button>
                            <button type="button" class="btn btn-accent" onclick="applyAdvancedFilters()">í•„í„° ì ìš©</button>
                        </div>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;" id="search-btn">
                    ğŸ” ê²€ìƒ‰ ë° ë¶„ì„ ì‹œì‘
                </button>
                </form>
            </div>
            <!-- ê²€ìƒ‰ ê²°ê³¼ -->
            <div id="error-message" class="error" style="display: none;"></div>
            <div class="results-section" id="results-section" style="display: none;">
                <div class="results-header">
                    <h3>ê²€ìƒ‰ ê²°ê³¼</h3>
                    <span class="results-count" id="results-count">0ê°œ ê²°ê³¼</span>
                </div>
                
                <div id="loading" class="loading" style="display: none;">
                    <div class="spinner"></div>
                    <p>ê²€ìƒ‰ ì¤‘...</p>
                </div>
                <div class="results-grid" id="results-grid" style="display: grid; gap: 1px; background: var(--border-primary);"></div>
                <div class="pagination" id="pagination" style="display: none;">
                    <button id="prev-btn" disabled>ì´ì „</button>
                    <button id="next-btn" disabled>ë‹¤ìŒ</button>
                </div>
            </div>
            <div class="loading" id="searchLoading">
                <div class="spinner"></div>
                <p>ì˜ìƒ ë¶„ì„ ì¤‘... ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”</p>
            </div>
            <div id="searchResults" class="results-grid"></div>
            
            <!-- ë²¤ì¹˜ë§ˆí‚¹ ì»¨íŠ¸ë¡¤ íŒ¨ë„ -->
            <div id="benchmark-controls" class="benchmark-controls">
                <div class="benchmark-info">
                    <span id="selected-count">0</span>ê°œ ì˜ìƒ ì„ íƒë¨
                </div>
                <button id="select-all-btn" class="benchmark-btn">ì „ì²´ ì„ íƒ</button>
                <button id="deselect-all-btn" class="benchmark-btn">ì „ì²´ í•´ì œ</button>
                <button id="analyze-benchmark-btn" class="benchmark-btn" disabled>ë¶„ì„ ì‹œì‘</button>
                <button id="view-benchmark-report" class="benchmark-btn" disabled>ë¶„ì„ê²°ê³¼ ë³´ê¸°</button>
            </div>
            
            <!-- ë²¤ì¹˜ë§ˆí‚¹ ê²°ê³¼ ì„¹ì…˜ -->
            <div id="benchmark-results" class="benchmark-results" style="display: none;">
                <h3>ğŸ“Š ë²¤ì¹˜ë§ˆí‚¹ ë¶„ì„ ê²°ê³¼</h3>
                <div id="benchmark-summary" class="benchmark-summary"></div>
                <div id="benchmark-details"></div>
            </div>
        </div>

        <!-- ë²¤ì¹˜ë§ˆí‚¹ ì „ì²´ ë¶„ì„ ê²°ê³¼ ì˜¤ë²„ë ˆì´ -->
        <div id="benchmark-report-overlay" class="benchmark-report-overlay" style="display: none;">
            <div class="benchmark-report">
                <div class="benchmark-report-header">
                    <h3>ğŸ“Š ë²¤ì¹˜ë§ˆí‚¹ ë¶„ì„ ê²°ê³¼</h3>
                    <button id="close-benchmark-report" class="benchmark-btn" style="background: var(--bg-tertiary); border: 1px solid rgba(255,255,255,0.2);">ë‹«ê¸°</button>
                </div>
                <div id="benchmark-report-body" class="benchmark-report-body"></div>
            </div>
        </div>

        <!-- ê²½ìŸì ë¶„ì„ íƒ­ -->
        <div id="competitor-tab" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸ† ê²½ìŸì ì±„ë„ ë¶„ì„</h3>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">ê²½ìŸ ì±„ë„ ì´ë¦„ ë˜ëŠ” ID</label>
                        <input type="text" id="competitorChannel" class="form-input" placeholder="ì˜ˆ: ì±„ë„ëª… ë˜ëŠ” UC...">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ë¶„ì„ ê¹Šì´</label>
                        <select id="competitorAnalysisType" class="form-select">
                            <option value="basic">ê¸°ë³¸ ë¶„ì„</option>
                            <option value="detailed">ìƒì„¸ ë¶„ì„</option>
                            <option value="comprehensive">ì¢…í•© ë¶„ì„</option>
                        </select>
                    </div>
                </div>
                <button class="btn btn-primary" style="width: 100%;" onclick="analyzeCompetitor()">
                    ğŸ“ˆ ê²½ìŸì ë¶„ì„ ì‹œì‘
                </button>
            </div>
            <div class="loading" id="competitorLoading">
                <div class="spinner"></div>
                <p>ê²½ìŸì ì±„ë„ ë¶„ì„ ì¤‘...</p>
            </div>
            <div id="competitorResults"></div>
        </div>

        <!-- íŠ¸ë Œë“œ ë¶„ì„ íƒ­ -->
        <div id="trending-tab" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸ”¥ íŠ¸ë Œë“œ ë¶„ì„</h3>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">ì¹´í…Œê³ ë¦¬</label>
                        <select id="trendingCategory" class="form-select">
                            <option value="">ì „ì²´</option>
                            <option value="1">ì˜í™” ë° ì• ë‹ˆë©”ì´ì…˜</option>
                            <option value="2">ìë™ì°¨</option>
                            <option value="10">ìŒì•…</option>
                            <option value="15">ì• ì™„ë™ë¬¼</option>
                            <option value="17">ìŠ¤í¬ì¸ </option>
                            <option value="19">ì—¬í–‰ ë° ì´ë²¤íŠ¸</option>
                            <option value="20">ê²Œì„</option>
                            <option value="22">ì‚¬ëŒ ë° ë¸”ë¡œê·¸</option>
                            <option value="23">ì½”ë¯¸ë””</option>
                            <option value="24">ì—”í„°í…Œì¸ë¨¼íŠ¸</option>
                            <option value="25">ë‰´ìŠ¤ ë° ì •ì¹˜</option>
                            <option value="26">ë…¸í•˜ìš° ë° ìŠ¤íƒ€ì¼</option>
                            <option value="27">êµìœ¡</option>
                            <option value="28">ê³¼í•™ ê¸°ìˆ </option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ì§€ì—­</label>
                        <select id="trendingRegion" class="form-select">
                            <option value="KR">í•œêµ­</option>
                            <option value="US">ë¯¸êµ­</option>
                            <option value="JP">ì¼ë³¸</option>
                            <option value="GB">ì˜êµ­</option>
                        </select>
                    </div>
                </div>
                <button class="btn btn-primary" style="width: 100%;" onclick="analyzeTrending()">
                    ğŸ”¥ íŠ¸ë Œë“œ ë¶„ì„ ì‹œì‘
                </button>
            </div>
            <div class="loading" id="trendingLoading">
                <div class="spinner"></div>
                <p>íŠ¸ë Œë“œ ë¶„ì„ ì¤‘...</p>
            </div>
            <div id="trendingResults"></div>
        </div>

        <!-- ì±„ë„ ë¶„ì„ íƒ­ -->
        <div id="channel-tab" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸ“º ì±„ë„ ìƒì„¸ ë¶„ì„</h3>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">ì±„ë„ ì´ë¦„ ë˜ëŠ” ID</label>
                        <input type="text" id="channelName" class="form-input" placeholder="ì˜ˆ: ì±„ë„ëª… ë˜ëŠ” UC...">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ë¶„ì„ ê¸°ê°„</label>
                        <select id="channelPeriod" class="form-select">
                            <option value="30">ìµœê·¼ 30ì¼</option>
                            <option value="90">ìµœê·¼ 3ê°œì›”</option>
                            <option value="180">ìµœê·¼ 6ê°œì›”</option>
                            <option value="365">ìµœê·¼ 1ë…„</option>
                        </select>
                    </div>
                </div>
                <button class="btn btn-primary" style="width: 100%;" onclick="analyzeChannel()">
                    ğŸ“Š ì±„ë„ ë¶„ì„ ì‹œì‘
                </button>
            </div>
            <div class="loading" id="channelLoading">
                <div class="spinner"></div>
                <p>ì±„ë„ ë¶„ì„ ì¤‘...</p>
            </div>
            <div id="channelResults"></div>
        </div>

        <!-- í‚¤ì›Œë“œ ë§ˆì´ë‹ íƒ­ -->
        <div id="keywords-tab" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸ’¡ í‚¤ì›Œë“œ ë§ˆì´ë‹</h3>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">ê¸°ë³¸ í‚¤ì›Œë“œ</label>
                        <input type="text" id="keywordSeed" class="form-input" placeholder="ì˜ˆ: í”„ë¡œê·¸ë˜ë°">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ë¶„ì„ ë°©ë²•</label>
                        <select id="keywordMethod" class="form-select">
                            <option value="related">ì—°ê´€ í‚¤ì›Œë“œ</option>
                            <option value="trending">íŠ¸ë Œë”© í‚¤ì›Œë“œ</option>
                            <option value="competitor">ê²½ìŸ í‚¤ì›Œë“œ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ê²°ê³¼ ìˆ˜</label>
                        <select id="keywordCount" class="form-select">
                            <option value="50">50ê°œ</option>
                            <option value="100">100ê°œ</option>
                            <option value="200">200ê°œ</option>
                        </select>
                    </div>
                </div>
                <button class="btn btn-primary" style="width: 100%;" onclick="mineKeywords()">
                    ğŸ’ í‚¤ì›Œë“œ ë§ˆì´ë‹ ì‹œì‘
                </button>
            </div>
            <div class="loading" id="keywordsLoading">
                <div class="spinner"></div>
                <p>í‚¤ì›Œë“œ ë¶„ì„ ì¤‘...</p>
            </div>
            <div id="keywordsResults"></div>
        </div>

        <!-- ì¢…í•© ë¶„ì„ íƒ­ -->
        <div id="analytics-tab" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸ“Š ì¢…í•© ë¶„ì„ ëŒ€ì‹œë³´ë“œ</h3>
                </div>
                <div id="analyticsResults">
                    <p style="text-align: center; color: var(--text-secondary); padding: 40px;">
                        ë‹¤ë¥¸ íƒ­ì—ì„œ ë¶„ì„ì„ ìˆ˜í–‰í•˜ë©´ ì—¬ê¸°ì— ì¢…í•© ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- API Settings Modal -->
    <div id="apiModal" class="modal">
        <div class="modal-content">
            <div class="card-header">
                <h3 class="card-title">âš™ï¸ YouTube API ì„¤ì •</h3>
            </div>
            <div class="form-group">
                <label class="form-label">YouTube Data API v3 í‚¤</label>
                <input type="password" id="apiKeyInput" class="form-input" placeholder="API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                <small style="color: var(--text-tertiary); margin-top: var(--space-xs);">
                    API í‚¤ëŠ” ë¡œì»¬ì—ë§Œ ì €ì¥ë˜ë©° ì„œë²„ë¡œ ì „ì†¡ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
                </small>
            </div>
            <div style="display: flex; gap: var(--space-md); margin-top: var(--space-lg);">
                <button class="btn btn-primary" onclick="saveApiKey()" style="flex: 1;">ì €ì¥</button>
                <button class="btn" onclick="closeApiSettings()" style="flex: 1; background: var(--bg-tertiary);">ì·¨ì†Œ</button>
            </div>
        </div>
    </div>

    <!-- Video Analysis Modal -->
    <div id="analysisModal" class="modal analysis-modal">
        <div class="modal-content analysis-content">
            <div class="modal-header">
                <h2>ğŸ”¬ ì˜ìƒ ë²¤ì¹˜ë§ˆí‚¹ ë¶„ì„ ê²°ê³¼</h2>
                <button class="close-btn" onclick="closeAnalysisModal()">Ã—</button>
            </div>
            
            <div class="analysis-loading" id="analysisLoading">
                <div class="spinner-large"></div>
                <h3>ì „ë¬¸ê°€ ìˆ˜ì¤€ ë¶„ì„ ì§„í–‰ ì¤‘...</h3>
                <p id="analysisProgress">ì˜ìƒ ì •ë³´ ìˆ˜ì§‘ ì¤‘...</p>
            </div>
            
            <div class="analysis-results" id="analysisResults" style="display: none;">
                <!-- ë¶„ì„ ê²°ê³¼ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì‚½ì…ë©ë‹ˆë‹¤ -->
            </div>
        </div>
    </div>

    <script>
        class YouTubeSearchApp {
            constructor() {
                this.apiKey = '';
                this.currentResults = [];
                this.filteredResults = [];
                this.nextPageToken = '';
                this.prevPageToken = '';
                this.isApiKeyVisible = false;
                this.channelAverages = new Map();
                
                // í‚¤ì›Œë“œ íƒœê·¸ ê´€ë¦¬
                this.keywords = [];
                this.keywordInput = null;
                this.addKeywordBtn = null;
                this.keywordsDisplay = null;
                
                // í• ë‹¹ëŸ‰ ê´€ë¦¬
                this.quotaUsage = JSON.parse(localStorage.getItem('quota_usage') || '{}');
                this.dailyQuotaLimit = 10000; // YouTube API ì¼ì¼ í• ë‹¹ëŸ‰
                this.quotaResetTime = localStorage.getItem('quota_reset_time') || this.getNextMidnight();
                this.quotaExceeded = false;
                
                // ë²¤ì¹˜ë§ˆí‚¹ ê¸°ëŠ¥
                this.selectedVideos = new Set();
                this.benchmarkResults = null;
                
                // API ìµœì í™” ê¸°ëŠ¥
                this.quotaUsage = parseInt(localStorage.getItem('api-quota-usage')) || 0;
                this.dailyQuotaLimit = 10000; // YouTube API v3 ì¼ì¼ í• ë‹¹ëŸ‰
                this.requestCache = new Map();
                this.cacheExpiry = 5 * 60 * 1000; // 5ë¶„ ìºì‹œ
                this.rateLimitQueue = [];
                this.lastRequestTime = 0;
                this.requestInterval = 100; // 100ms ê°„ê²©ìœ¼ë¡œ ìš”ì²­ ì œí•œ

                this.initialize();
            }

            initialize() {
                this.loadApiKey();
                this.setupEventListeners();
                this.updateQuotaDisplay();
                this.updateApiStatus();
                this.initializeModal();
                this.initializePagination();
                this.initializeQuotaManagement();
                this.initializeAdvancedFilters();
                this.initializeBenchmarkControls();
                this.initKeywordSystem();
            }

            setupEventListeners() {
                // API key input visibility toggle
                document.addEventListener('click', (e) => {
                    if (e.target.id === 'toggleApiKeyVisibility') {
                        this.toggleApiKeyVisibility();
                    }
                });

                // Form submission
                const searchForm = document.getElementById('search-form');
                if (searchForm) {
                    searchForm.addEventListener('submit', (e) => {
                        e.preventDefault();
                        this.performSearch();
                    });
                    // Custom result count toggle
                    document.getElementById('maxResults').addEventListener('change', (e) => {
                        const customInput = document.getElementById('maxResultsCustom');
                        if (e.target.value === 'custom') {
                            if (customInput) customInput.style.display = 'block';
                        } else {
                            if (customInput) customInput.style.display = 'none';
                        }
                    });
                } else {
                    console.warn('Search form not found');
                }

                // ì—”í„°í‚¤ë¡œ ê²€ìƒ‰ ì‹¤í–‰
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' && document.activeElement.id === 'searchQuery') {
                        e.preventDefault();
                        this.performSearch();
                    }
                });
            }

            initializePagination() {
                const prevBtn = document.getElementById('prev-btn');
                const nextBtn = document.getElementById('next-btn');

                if (prevBtn) {
                    prevBtn.addEventListener('click', () => {
                        this.performSearch(this.prevPageToken);
                    });
                }
                if (nextBtn) {
                    nextBtn.addEventListener('click', () => {
                        this.performSearch(this.nextPageToken);
                    });
                }
            }
            
            initializeModal() {
                const modal = document.getElementById('apiModal');
                if (modal) {
                    modal.addEventListener('click', (e) => {
                        if (e.target === modal) {
                            this.closeSettings();
                        }
                    });
                }

                // ESC key to close modal
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && modal && modal.classList.contains('show')) {
                        this.closeSettings();
                    }
                });
            }

            initializeAdvancedFilters() {
                // Setup event listeners for custom input fields
                const filterIds = [
                    'minViews', 'maxViews', 'minSubscribers', 'maxSubscribers',
                    'minOutlierScore', 'minEngagementRate', 'minLikes', 'minComments'
                ];

                filterIds.forEach(id => {
                    const selectElement = document.getElementById(id);
                    if (selectElement) {
                        selectElement.addEventListener('change', (e) => {
                            const customInput = document.getElementById(id + 'Custom');
                            if (customInput) {
                                if (e.target.value === 'custom') {
                                    customInput.style.display = 'inline-block';
                                } else {
                                    customInput.style.display = 'none';
                                }
                            }
                        });
                    }
                });
            }

            getMaxResults() {
                const maxResultsSelect = document.getElementById('maxResults');
                const customInput = document.getElementById('maxResultsCustom');
                
                if (maxResultsSelect && maxResultsSelect.value === 'custom' && customInput) {
                    const customValue = parseInt(customInput.value);
                    // Validate custom value (1-50 per YouTube API limits)
                    if (customValue && customValue >= 1 && customValue <= 50) {
                        return customValue.toString();
                    } else {
                        // Default to 25 if invalid custom value
                        return '25';
                    }
                }
                
                return maxResultsSelect?.value || '25';
            }

            loadApiKey() {
                this.apiKey = localStorage.getItem('youtube-api-key') || '';
                const apiKeyInput = document.getElementById('apiKeyInput');
                if (apiKeyInput) {
                    apiKeyInput.value = this.apiKey;
                }
            }

            openSettings() {
                const modal = document.getElementById('apiModal');
                if (modal) {
                    modal.classList.add('show');
                    const apiKeyInput = document.getElementById('apiKeyInput');
                    if (apiKeyInput) {
                        apiKeyInput.value = this.apiKey;
                        apiKeyInput.focus();
                    }
                }
            }

            closeSettings() {
                const modal = document.getElementById('apiModal');
                if (modal) {
                    modal.classList.remove('show');
                }
            }

            saveApiKey() {
                const apiKeyInput = document.getElementById('apiKeyInput');
                if (apiKeyInput) {
                    this.apiKey = apiKeyInput.value.trim();
                    if (this.apiKey) {
                        localStorage.setItem('youtube-api-key', this.apiKey);
                        this.updateApiStatus();
                        this.closeSettings();
                        alert('API í‚¤ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
                    } else {
                        alert('ìœ íš¨í•œ API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    }
                }
            }

            async testApiKey() {
                if (!this.apiKey) {
                    alert('API í‚¤ë¥¼ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }

                try {
                    const testUrl = `https://www.googleapis.com/youtube/v3/search?part=snippet&q=test&maxResults=1&key=${this.apiKey}`;
                    const response = await fetch(testUrl);
                    
                    if (response.ok) {
                        alert('âœ… API í‚¤ ì—°ê²° ì„±ê³µ!');
                        this.updateApiStatus();
                    } else {
                        const error = await response.json();
                        alert(`âŒ API í‚¤ ì˜¤ë¥˜: ${error.error?.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'}`);
                    }
                } catch (error) {
                    alert('âŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }
            }

            updateApiStatus() {
                const btn = document.getElementById('apiSettingsBtn');
                const btnText = document.getElementById('apiSettingsBtnText');
                const indicator = btn?.querySelector('.api-status-indicator');

                if (this.apiKey) {
                    if (btn) btn.classList.add('connected');
                    if (btnText) btnText.textContent = 'âœ… API ì—°ê²°ë¨';
                    if (indicator) indicator.style.background = '#51cf66';
                } else {
                    if (btn) btn.classList.remove('connected');
                    if (btnText) btnText.textContent = 'âš™ï¸ API ì„¤ì •';
                    if (indicator) indicator.style.background = 'white';
                }
            }

            updateQuotaDisplay() {
                const quotaElement = document.getElementById('quota-usage');
                if (quotaElement) {
                    const percentage = ((this.quotaUsage / this.dailyQuotaLimit) * 100).toFixed(1);
                    quotaElement.textContent = `${this.quotaUsage}/${this.dailyQuotaLimit} (${percentage}%)`;
                    
                    // Update quota warning colors
                    quotaElement.className = 'quota-usage';
                    if (percentage >= 90) {
                        quotaElement.classList.add('quota-critical');
                    } else if (percentage >= 75) {
                        quotaElement.classList.add('quota-warning');
                    }
                }
            }

            // Rate limiting function
            async rateLimitedRequest(requestFunction) {
                const now = Date.now();
                const timeSinceLastRequest = now - this.lastRequestTime;
                
                if (timeSinceLastRequest < this.requestInterval) {
                    await new Promise(resolve => setTimeout(resolve, this.requestInterval - timeSinceLastRequest));
                }
                
                this.lastRequestTime = Date.now();
                return await requestFunction();
            }

            // Cache management
            getCacheKey(params) {
                return btoa(params.toString()).replace(/[+/=]/g, '');
            }

            getCachedData(cacheKey) {
                const cached = this.requestCache.get(cacheKey);
                if (cached && (Date.now() - cached.timestamp) < this.cacheExpiry) {
                    return cached.data;
                }
                this.requestCache.delete(cacheKey);
                return null;
            }

            setCachedData(cacheKey, data) {
                this.requestCache.set(cacheKey, {
                    data: data,
                    timestamp: Date.now()
                });
                
                // Limit cache size to prevent memory issues
                if (this.requestCache.size > 100) {
                    const firstKey = this.requestCache.keys().next().value;
                    this.requestCache.delete(firstKey);
                }
            }

            async batchApiCall(ids, endpoint, type, quotaCost) {
                if (!ids.length) return { items: [] };
                
                const batchSize = 50; // API limits
                const batches = [];
                
                for (let i = 0; i < ids.length; i += batchSize) {
                    const batch = ids.slice(i, i + batchSize);
                    batches.push(batch);
                }
                
                const results = [];
                for (const batch of batches) {
                    const params = new URLSearchParams({
                        part: type === 'video-details' ? 'snippet,statistics,contentDetails' : 'snippet,statistics',
                        id: batch.join(','),
                        key: this.apiKey
                    });
                    
                    try {
                        const data = await this.callYouTubeAPI(params, endpoint, quotaCost);
                        if (data.items) {
                            results.push(...data.items);
                        }
                    } catch (error) {
                        console.warn(`Batch API call failed for ${endpoint}:`, error);
                    }
                    
                    // Small delay between batches
                    if (batches.indexOf(batch) < batches.length - 1) {
                        await new Promise(resolve => setTimeout(resolve, 100));
                    }
                }
                
                return { items: results };
            }

            async performSearch(pageToken = '') {
                if (!this.apiKey) {
                    this.showError('API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }

                // í‚¤ì›Œë“œ ì‹œìŠ¤í…œì—ì„œ ê²€ìƒ‰ì–´ ê°€ì ¸ì˜¤ê¸°
                const query = this.getSearchQuery();
                if (!query) {
                    this.showError('ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ê±°ë‚˜ í‚¤ì›Œë“œë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”.');
                    return;
                }

                this.showLoading(true);
                this.hideError();

                try {
                    // Build search parameters
                    const params = new URLSearchParams({
                        part: 'snippet',
                        type: 'video',
                        q: query,
                        maxResults: this.getMaxResults(),
                        key: this.apiKey
                    });

                    // Add optional parameters
                    const order = document.getElementById('orderBy')?.value;
                    const videoDuration = document.getElementById('videoDuration')?.value;
                    const publishedAfter = document.getElementById('publishedAfter')?.value;
                    const regionCode = document.getElementById('regionCode')?.value;

                    if (order && order !== 'outlier') params.append('order', order);
                    if (videoDuration) params.append('videoDuration', videoDuration);
                    if (regionCode) params.append('regionCode', regionCode);
                    if (pageToken) params.append('pageToken', pageToken);

                    // Add published after filter
                    if (publishedAfter) {
                        const publishedAfterDate = this.getPublishedAfterDate(publishedAfter);
                        if (publishedAfterDate) {
                            params.append('publishedAfter', publishedAfterDate);
                        }
                    }

                    // Search for videos
                    const searchData = await this.callYouTubeAPI(params, 'search', 100);
                    
                    if (!searchData.items || searchData.items.length === 0) {
                        this.showError('ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.');
                        return;
                    }

                    // Store results and pagination tokens
                    this.currentResults = searchData.items;
                    this.filteredResults = [...searchData.items];
                    this.nextPageToken = searchData.nextPageToken || '';
                    this.prevPageToken = searchData.prevPageToken || '';

                    // Enrich results with additional data
                    await this.enrichResults();
                    
                    // Display results
                    this.displayResults();
                    this.updatePagination();

                } catch (error) {
                    console.error('Search error:', error);
                    this.showError('ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                } finally {
                    this.showLoading(false);
                }
            }

            getPublishedAfterDate(period) {
                const now = new Date();
                const periods = {
                    day: new Date(now - 24 * 60 * 60 * 1000),
                    week: new Date(now - 7 * 24 * 60 * 60 * 1000),
                    month: new Date(now - 30 * 24 * 60 * 60 * 1000),
                    year: new Date(now - 365 * 24 * 60 * 60 * 1000)
                };

                return periods[period.value]?.toISOString() || '';
            }

            async callYouTubeAPI(params, endpoint = 'search', quotaCost = 1) {
                // ì¿¼í„° ì²´í¬
                if (this.quotaUsage + quotaCost > this.dailyQuotaLimit) {
                    throw new Error(`ì¼ì¼ API í• ë‹¹ëŸ‰ì„ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. (${this.quotaUsage}/${this.dailyQuotaLimit})`);
                }

                // ìºì‹œ í™•ì¸
                const cacheKey = this.getCacheKey(params);
                const cachedData = this.getCachedData(cacheKey);
                if (cachedData) {
                    console.log('ìºì‹œëœ ë°ì´í„° ì‚¬ìš©:', cacheKey);
                    return cachedData;
                }

                // Rate limiting ì ìš©
                return await this.rateLimitedRequest(async () => {
                    const url = `https://www.googleapis.com/youtube/v3/${endpoint}?${params}`;
                    const response = await fetch(url);
                    
                    if (!response.ok) {
                        const error = await response.json();
                        throw new Error(error.error?.message || 'API í˜¸ì¶œ ì‹¤íŒ¨');
                    }
                    
                    const data = await response.json();
                    
                    // ì¿¼í„° ì‚¬ìš©ëŸ‰ ì—…ë°ì´íŠ¸
                    this.quotaUsage += quotaCost;
                    localStorage.setItem('api-quota-usage', this.quotaUsage.toString());
                    this.updateQuotaDisplay();
                    
                    // ìºì‹œ ì €ì¥
                    this.setCachedData(cacheKey, data);
                    
                    return data;
                });
            }

            async enrichResults() {
                if (this.currentResults.length === 0) return;

                try {
                    // Get video IDs for detailed information (í•„í„°ë§ ì¶”ê°€)
                    const videoIds = this.currentResults
                        .map(item => item.id?.videoId)
                        .filter(id => id);
                    
                    if (videoIds.length === 0) return;

                    // ë°°ì¹˜ API í˜¸ì¶œë¡œ ìµœì í™”
                    const videoData = await this.batchApiCall(videoIds, 'videos', 'video-details', 3);

                    // Get channel information (ì¤‘ë³µ ì œê±°)
                    const channelIds = [...new Set(this.currentResults
                        .map(item => item.snippet?.channelId)
                        .filter(id => id))];
                    
                    const channelData = await this.batchApiCall(channelIds, 'channels', 'channel-basic', 1);

                    // Get recent videos for each channel to calculate averages
                    await this.getChannelAverages(channelIds);

                    // Merge the data
                    this.mergeEnrichedData(videoData.items || [], channelData.items || []);
                    
                    // Calculate outlier scores
                    this.calculateOutlierScores();
                    
                    // Apply advanced filters
                    this.applyAdvancedFilters();
                    
                } catch (error) {
                    console.warn('Failed to enrich results:', error);
                }
            }

            async getChannelAverages(channelIds) {
                this.channelAverages = new Map();
                
                for (const channelId of channelIds) {
                    try {
                        // Get recent videos for this channel
                        const searchParams = new URLSearchParams({
                            part: 'snippet',
                            channelId: channelId,
                            type: 'video',
                            order: 'date',
                            maxResults: '20',
                            key: this.apiKey
                        });

                        const searchResponse = await fetch(`https://www.googleapis.com/youtube/v3/search?${searchParams}`);
                        const searchData = await searchResponse.json();
                        
                        if (searchData.items && searchData.items.length > 0) {
                            // Get video statistics for average calculation
                            const recentVideoIds = searchData.items.map(item => item.id.videoId).join(',');
                            const videoParams = new URLSearchParams({
                                part: 'statistics',
                                id: recentVideoIds,
                                key: this.apiKey
                            });

                            const videoResponse = await fetch(`https://www.googleapis.com/youtube/v3/videos?${videoParams}`);
                            const videoData = await videoResponse.json();
                            
                            // Calculate averages
                            const views = videoData.items.map(v => parseInt(v.statistics.viewCount || '0'));
                            const avgViews = views.reduce((sum, v) => sum + v, 0) / views.length;
                            
                            this.channelAverages.set(channelId, {
                                avgViews: avgViews,
                                recentVideoCount: views.length,
                                totalViews: views.reduce((sum, v) => sum + v, 0)
                            });
                        }
                    } catch (error) {
                        console.warn(`Failed to get averages for channel ${channelId}:`, error);
                        this.channelAverages.set(channelId, { avgViews: 0, recentVideoCount: 0, totalViews: 0 });
                    }
                }
            }

            mergeEnrichedData(videoDetails, channelDetails) {
                const videoMap = new Map(videoDetails.map(v => [v.id, v]));
                const channelMap = new Map(channelDetails.map(c => [c.id, c]));

                this.currentResults.forEach(item => {
                    const videoDetail = videoMap.get(item.id.videoId);
                    const channelDetail = channelMap.get(item.snippet.channelId);

                    if (videoDetail) {
                        item.statistics = videoDetail.statistics;
                        item.contentDetails = videoDetail.contentDetails;
                    }

                    if (channelDetail) {
                        item.channelStatistics = channelDetail.statistics;
                    }
                });
            }

            calculateOutlierScores() {
                this.currentResults.forEach(item => {
                    const videoViews = parseInt(item.statistics?.viewCount || '0');
                    const subscriberCount = parseInt(item.channelStatistics?.subscriberCount || '1');
                    const channelAvg = this.channelAverages.get(item.snippet.channelId);
                    const avgViews = channelAvg?.avgViews || 1;
                    
                    // Calculate engagement rate
                    const likes = parseInt(item.statistics?.likeCount || '0');
                    const comments = parseInt(item.statistics?.commentCount || '0');
                    const engagementRate = videoViews > 0 ? (likes + comments) / videoViews : 0;
                    
                    // Calculate time factor (newer videos get bonus)
                    const publishedDate = new Date(item.snippet.publishedAt);
                    const ageInDays = (new Date() - publishedDate) / (1000 * 60 * 60 * 24);
                    const timeFactor = Math.max(5 - (ageInDays / 30), 0);
                    
                    // VidIQ-style Outlier Score calculation
                    const viewRatio = Math.min((videoViews / avgViews) * 20, 60);
                    const engagementBonus = Math.min(engagementRate * 1000, 20);
                    const subscriberBonus = Math.min((videoViews / subscriberCount) * 100, 15);
                    const timeBonus = timeFactor;
                    
                    const outlierScore = Math.round(viewRatio + engagementBonus + subscriberBonus + timeBonus);
                    
                    // Add calculated data to item
                    item.outlierScore = Math.min(outlierScore, 100);
                    item.viewRatio = videoViews / avgViews;
                    item.engagementRate = engagementRate;
                    item.channelAvgViews = avgViews;
                    
                    // Calculate and set rank grade based on outlier score
                    if (item.outlierScore >= 90) item.rankGrade = 'S';
                    else if (item.outlierScore >= 70) item.rankGrade = 'A';
                    else if (item.outlierScore >= 50) item.rankGrade = 'B';
                    else if (item.outlierScore >= 30) item.rankGrade = 'C';
                    else item.rankGrade = 'D';
                });
            }

            displayResults() {
                const container = document.getElementById('searchResults') || document.getElementById('results-grid');
                if (!container) return;
                
                const resultsSection = document.getElementById('results-section');
                const resultsCount = document.getElementById('results-count');

                container.innerHTML = '';
                const totalResults = this.currentResults.length;
                const filteredCount = this.filteredResults.length;
                
                if (resultsCount) {
                    resultsCount.innerHTML = `
                        <span>${filteredCount}ê°œ ê²°ê³¼</span>
                        ${filteredCount < totalResults ? `<span style="color: var(--text-tertiary);"> (ì „ì²´ ${totalResults}ê°œ ì¤‘)</span>` : ''}
                    `;
                }
                
                if (resultsSection) {
                    resultsSection.style.display = 'block';
                }

                this.filteredResults.forEach(item => {
                    const card = this.createVideoCard(item);
                    container.appendChild(card);
                });
                // reflect benchmarking selections after render
                this.applyBenchmarkStateToCards();
            }

            applyAdvancedFilters() {
                if (!this.currentResults || this.currentResults.length === 0) return;
                
                // Get filter values
                const getFilterValue = (selectId, customInputId) => {
                    const select = document.getElementById(selectId);
                    const customInput = document.getElementById(customInputId);
                    if (!select) return null;
                    
                    if (select.value === 'custom' && customInput && customInput.value) {
                        return parseFloat(customInput.value);
                    }
                    return select.value ? parseFloat(select.value) : null;
                };
                
                const filters = {
                    minViews: getFilterValue('minViews', 'minViewsCustom'),
                    maxViews: getFilterValue('maxViews', 'maxViewsCustom'),
                    minSubscribers: getFilterValue('minSubscribers', 'minSubscribersCustom'),
                    maxSubscribers: getFilterValue('maxSubscribers', 'maxSubscribersCustom'),
                    minOutlierScore: getFilterValue('minOutlierScore', 'minOutlierScoreCustom'),
                    minEngagementRate: getFilterValue('minEngagementRate', 'minEngagementRateCustom'),
                    minLikes: getFilterValue('minLikes', 'minLikesCustom'),
                    minComments: getFilterValue('minComments', 'minCommentsCustom'),
                    minRankGrade: document.getElementById('minRankGrade')?.value || null
                };
                
                // Apply filters
                this.filteredResults = this.currentResults.filter(video => {
                    // Views filter
                    const views = parseInt(video.statistics?.viewCount || 0);
                    if (filters.minViews !== null && views < filters.minViews) return false;
                    if (filters.maxViews !== null && views > filters.maxViews) return false;
                    
                    // Subscribers filter (channel data)
                    const subscribers = parseInt(video.channelStatistics?.subscriberCount || 0);
                    if (filters.minSubscribers !== null && subscribers < filters.minSubscribers) return false;
                    if (filters.maxSubscribers !== null && subscribers > filters.maxSubscribers) return false;
                    
                    // Outlier Score filter
                    if (filters.minOutlierScore !== null && (video.outlierScore || 0) < filters.minOutlierScore) return false;
                    
                    // Engagement Rate filter
                    const likes = parseInt(video.statistics?.likeCount || 0);
                    const engagementRate = views > 0 ? (likes / views) * 100 : 0;
                    if (filters.minEngagementRate !== null && engagementRate < filters.minEngagementRate) return false;
                    
                    // Likes filter
                    if (filters.minLikes !== null && likes < filters.minLikes) return false;
                    
                    // Comments filter
                    const comments = parseInt(video.statistics?.commentCount || 0);
                    if (filters.minComments !== null && comments < filters.minComments) return false;
                    
                    // Rank Grade filter
                    if (filters.minRankGrade) {
                        const rankOrder = { 'S': 5, 'A': 4, 'B': 3, 'C': 2, 'D': 1 };
                        const videoRank = video.rankGrade || 'D';
                        const minRankValue = rankOrder[filters.minRankGrade] || 1;
                        const videoRankValue = rankOrder[videoRank] || 1;
                        
                        if (videoRankValue < minRankValue) return false;
                    }
                    
                    return true;
                });
                
                // Re-display results with filters applied
                this.displayResults();
                
                console.log(`Advanced filters applied. ${this.filteredResults.length} results out of ${this.currentResults.length} total results.`);
            }

            createVideoCard(item) {
                const card = document.createElement('div');
                card.className = 'video-card';
                card.dataset.videoId = item.id.videoId;

                const thumbnail = item.snippet.thumbnails.medium || item.snippet.thumbnails.default;
                const stats = item.statistics || {};
                const viewCount = formatNumber(parseInt(stats.viewCount || '0'));
                const duration = formatDuration(item.contentDetails?.duration);
                const publishedAt = formatDate(item.snippet.publishedAt);
                const subscriberCount = formatNumber(parseInt(item.channelStatistics?.subscriberCount || '0'));
                
                // Outlier score and ranking
                const outlierScore = item.outlierScore || 0;
                const rank = this.getOutlierRank(outlierScore);
                const viewRatio = item.viewRatio || 0;
                const channelAvgViews = formatNumber(item.channelAvgViews || 0);
                const engagementRate = ((item.engagementRate || 0) * 100).toFixed(2);

                card.innerHTML = `
                    <div class="benchmark-checkbox" onclick="event.stopPropagation(); toggleBenchmarkSelection('${item.id.videoId}')"></div>
                    <div class="thumbnail">
                        <img src="${thumbnail.url}" alt="${escapeHtml(item.snippet.title)}" loading="lazy">
                        ${duration ? `<div class="duration">${duration}</div>` : ''}
                        <div class="outlier-badge ${rank.class}">${rank.emoji} ${rank.grade}</div>
                    </div>
                    <div class="video-info">
                        <a href="https://www.youtube.com/watch?v=${item.id.videoId}" 
                           target="_blank" class="video-title">
                            ${escapeHtml(item.snippet.title)}
                        </a>
                        <div class="channel-name">${escapeHtml(item.snippet.channelTitle)}</div>
                        <div class="video-meta">
                            <span>ì¡°íšŒìˆ˜ ${viewCount}</span>
                            <span>êµ¬ë…ì ${subscriberCount}</span>
                            <span>${publishedAt}</span>
                        </div>
                        <div class="benchmarking-data">
                            <span>ğŸ“Š Score: ${outlierScore}ì </span>
                            <span>ğŸ“ˆ í‰ê·  ëŒ€ë¹„: ${viewRatio.toFixed(1)}ë°°</span>
                            <span>ğŸ’¬ ì°¸ì—¬ë„: ${engagementRate}%</span>
                            <span>ğŸ“º ì±„ë„ í‰ê· : ${channelAvgViews}</span>
                        </div>
                        
                    </div>
                    <div class="video-stats">
                        <div class="outlier-score-detail">
                            <div class="score-main">${outlierScore}</div>
                            <div class="score-label">Outlier Score</div>
                        </div>
                        <div class="view-count">${viewCount} ì¡°íšŒ</div>
                        <div class="published">${publishedAt}</div>
                    </div>
                `;

                return card;
            }

            getOutlierRank(score) {
                if (score >= 90) return { grade: 'S', emoji: 'ğŸ†', class: 'rank-s' };
                if (score >= 70) return { grade: 'A', emoji: 'â­', class: 'rank-a' };
                if (score >= 50) return { grade: 'B', emoji: 'ğŸ”¥', class: 'rank-b' };
                if (score >= 30) return { grade: 'C', emoji: 'ğŸ“ˆ', class: 'rank-c' };
                return { grade: 'D', emoji: 'ğŸ“‰', class: 'rank-d' };
            }

            formatNumber(num) {
                if (num >= 1000000) {
                    return (num / 1000000).toFixed(1) + 'M';
                } else if (num >= 1000) {
                    return (num / 1000).toFixed(1) + 'K';
                }
                return num.toLocaleString();
            }

            formatDuration(isoDuration) {
                if (!isoDuration) return '';
                
                const match = isoDuration.match(/PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?/);
                if (!match) return '';

                const hours = parseInt(match[1] || '0');
                const minutes = parseInt(match[2] || '0');
                const seconds = parseInt(match[3] || '0');

                if (hours > 0) {
                    return `${hours}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                }
                return `${minutes}:${seconds.toString().padStart(2, '0')}`;
            }

            formatDate(isoDate) {
                const date = new Date(isoDate);
                const now = new Date();
                const diffTime = Math.abs(now - date);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

                if (diffDays === 1) return '1ì¼ ì „';
                if (diffDays < 7) return `${diffDays}ì¼ ì „`;
                if (diffDays < 30) return `${Math.floor(diffDays / 7)}ì£¼ ì „`;
                if (diffDays < 365) return `${Math.floor(diffDays / 30)}ê°œì›” ì „`;
                return `${Math.floor(diffDays / 365)}ë…„ ì „`;
            }

            cleanText(text) {
                if (!text) return '';
                
                // Comprehensive HTML entity decoding
                let decoded = text;
                
                // Common HTML entities map
                const entities = {
                    '&#39;': "'",
                    '&quot;': '"',
                    '&amp;': '&',
                    '&lt;': '<',
                    '&gt;': '>',
                    '&nbsp;': ' ',
                    '&#x27;': "'",
                    '&#x2F;': '/',
                    '&#x3D;': '=',
                    '&#x60;': '`'
                };
                
                // Replace known entities first
                for (const [entity, replacement] of Object.entries(entities)) {
                    decoded = decoded.replace(new RegExp(entity, 'g'), replacement);
                }
                
                // Use textarea for any remaining entities
                const textarea = document.createElement('textarea');
                textarea.innerHTML = decoded;
                decoded = textarea.value;
                
                return decoded;
            }

            updatePagination() {
                const pagination = document.getElementById('pagination');
                const prevBtn = document.getElementById('prev-btn');
                const nextBtn = document.getElementById('next-btn');

                if (prevBtn && nextBtn) {
                    prevBtn.disabled = !this.prevPageToken;
                    nextBtn.disabled = !this.nextPageToken;
                }
                
                if (pagination) {
                    pagination.style.display = (this.prevPageToken || this.nextPageToken) ? 'flex' : 'none';
                }
            }

            showLoading(show) {
                const loading = document.getElementById('searchLoading') || document.getElementById('loading');
                const searchBtn = document.getElementById('search-btn');
                
                if (loading) {
                    loading.style.display = show ? 'block' : 'none';
                    if (show) {
                        loading.classList.add('show');
                    } else {
                        loading.classList.remove('show');
                    }
                }
                
                if (searchBtn) {
                    searchBtn.disabled = show;
                    searchBtn.textContent = show ? 'ê²€ìƒ‰ ì¤‘...' : 'ğŸ” ê²€ìƒ‰ ë° ë¶„ì„ ì‹œì‘';
                }
            }

            showError(message) {
                const errorDiv = document.getElementById('error-message');
                if (errorDiv) {
                    errorDiv.textContent = message;
                    errorDiv.style.display = 'block';
                } else {
                    // Create error display in results area
                    const container = document.getElementById('searchResults') || document.getElementById('results-grid');
                    if (container) {
                        container.innerHTML = `<div class="card" style="background: var(--error); color: white;"><div class="card-header"><h3>âš ï¸ ì˜¤ë¥˜</h3></div><p>${message}</p></div>`;
                    }
                }
            }

            hideError() {
                const errorDiv = document.getElementById('error-message');
                if (errorDiv) {
                    errorDiv.style.display = 'none';
                }
            }
            
            // í‚¤ì›Œë“œ íƒœê·¸ ì‹œìŠ¤í…œ ì´ˆê¸°í™”
            initKeywordSystem() {
                this.keywordInput = document.getElementById('searchQuery');
                this.addKeywordBtn = document.getElementById('addKeywordBtn');
                this.keywordsDisplay = document.getElementById('keywordsDisplay');
                
                // keywords ë°°ì—´ ì´ˆê¸°í™”
                if (!this.keywords) {
                    this.keywords = [];
                }
                
                if (!this.keywordInput || !this.addKeywordBtn || !this.keywordsDisplay) {
                    console.warn('í‚¤ì›Œë“œ ì‹œìŠ¤í…œ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                
                // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
                this.addKeywordBtn.addEventListener('click', () => {
                    console.log('ì¶”ê°€ ë²„íŠ¼ í´ë¦­ë¨');
                    this.addKeyword();
                });
                
                this.keywordInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        this.addKeyword();
                    }
                });
                
                // ì €ì¥ëœ í‚¤ì›Œë“œ ë¡œë“œ
                this.loadSavedKeywords();
            }
            
            // í‚¤ì›Œë“œ ì¶”ê°€
            async addKeyword() {
                console.log('addKeyword í•¨ìˆ˜ í˜¸ì¶œë¨');
                const input = this.keywordInput.value.trim();
                console.log('ì…ë ¥ê°’:', input);
                if (!input) {
                    console.log('ì…ë ¥ê°’ì´ ë¹„ì–´ìˆìŒ');
                    return;
                }
                
                // keywords ë°°ì—´ì´ ì •ì˜ë˜ì§€ ì•Šì€ ê²½ìš° ì´ˆê¸°í™”
                if (!this.keywords) {
                    this.keywords = [];
                }
                
                let keywordData = {
                    text: '',
                    type: 'keyword', // 'keyword' ë˜ëŠ” 'url'
                    original: input
                };
                
                // URLì¸ì§€ í™•ì¸
                if (this.isYouTubeURL(input)) {
                    keywordData.type = 'url';
                    // URLì—ì„œ í‚¤ì›Œë“œ ì¶”ì¶œ (ë¹„ë™ê¸°)
                    try {
                        this.showNotification('URLì—ì„œ í‚¤ì›Œë“œë¥¼ ì¶”ì¶œí•˜ê³  ìˆìŠµë‹ˆë‹¤...', 'info');
                        keywordData.text = await this.extractKeywordsFromURL(input);
                    } catch (error) {
                        console.error('í‚¤ì›Œë“œ ì¶”ì¶œ ì˜¤ë¥˜:', error);
                        keywordData.text = `url_${Date.now()}`;
                    }
                } else {
                    keywordData.text = input;
                }
                
                // ì¤‘ë³µ ì²´í¬
                if (this.keywords.some(k => k.text === keywordData.text)) {
                    this.showNotification('ì´ë¯¸ ì¶”ê°€ëœ í‚¤ì›Œë“œì…ë‹ˆë‹¤.', 'warning');
                    return;
                }
                
                this.keywords.push(keywordData);
                this.keywordInput.value = '';
                this.updateKeywordsDisplay();
                this.saveKeywords();
                
                this.showNotification(`${keywordData.type === 'url' ? 'URLì—ì„œ í‚¤ì›Œë“œ ì¶”ì¶œ' : 'í‚¤ì›Œë“œ ì¶”ê°€'}: ${keywordData.text}`, 'success');
            }
            
            // YouTube URL í™•ì¸
            isYouTubeURL(text) {
                const youtubeRegex = /^(https?:\/\/)?(www\.)?(youtube\.com\/(watch\?v=|embed\/|v\/)|youtu\.be\/)/;
                return youtubeRegex.test(text);
            }
            
            // URLì—ì„œ í‚¤ì›Œë“œ ì¶”ì¶œ
            async extractKeywordsFromURL(url) {
                try {
                    // YouTube URLì—ì„œ ë¹„ë””ì˜¤ ID ì¶”ì¶œ
                    let videoId = this.extractVideoId(url);
                    
                    if (videoId) {
                        // APIê°€ ìˆìœ¼ë©´ ë¹„ë””ì˜¤ ì •ë³´ë¥¼ ê°€ì ¸ì™€ì„œ í‚¤ì›Œë“œ ì¶”ì¶œ
                        if (this.apiKey) {
                            try {
                                const videoInfo = await this.getVideoInfo(videoId);
                                if (videoInfo) {
                                    return this.extractKeywordsFromVideoInfo(videoInfo);
                                }
                            } catch (error) {
                                console.warn('APIë¥¼ í†µí•œ ë¹„ë””ì˜¤ ì •ë³´ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', error);
                            }
                        }
                        
                        // APIê°€ ì—†ê±°ë‚˜ ì‹¤íŒ¨í•œ ê²½ìš°, ë¹„ë””ì˜¤ ID ê¸°ë°˜ í‚¤ì›Œë“œ ìƒì„±
                        return `video_${videoId.substring(0, 8)}`;
                    }
                    
                    // ì±„ë„ URLì¸ì§€ í™•ì¸
                    if (url.includes('/channel/') || url.includes('/c/') || url.includes('/@')) {
                        const channelKeyword = this.extractChannelKeyword(url);
                        return channelKeyword || `channel_${Date.now()}`;
                    }
                    
                    // ì¼ë°˜ URLì—ì„œ í‚¤ì›Œë“œ ì¶”ì¶œ
                    const urlParts = url.split(/[\/\?\&\=\_\-]+/);
                    const keywords = urlParts.filter(part => 
                        part.length > 2 && 
                        !part.match(/^(https?|www|com|youtube|youtu|be|watch|embed|v|channel|c)$/i)
                    ).slice(0, 3).join('_');
                    
                    return keywords || `youtube_url_${Date.now()}`;
                } catch (error) {
                    console.error('URL í‚¤ì›Œë“œ ì¶”ì¶œ ì˜¤ë¥˜:', error);
                    return `url_keyword_${Date.now()}`;
                }
            }
            
            // ë¹„ë””ì˜¤ ID ì¶”ì¶œ
            extractVideoId(url) {
                let videoId = '';
                
                if (url.includes('watch?v=')) {
                    videoId = url.split('watch?v=')[1].split('&')[0];
                } else if (url.includes('youtu.be/')) {
                    videoId = url.split('youtu.be/')[1].split('?')[0];
                } else if (url.includes('/embed/')) {
                    videoId = url.split('/embed/')[1].split('?')[0];
                } else if (url.includes('/v/')) {
                    videoId = url.split('/v/')[1].split('?')[0];
                }
                
                return videoId;
            }
            
            // ì±„ë„ í‚¤ì›Œë“œ ì¶”ì¶œ
            extractChannelKeyword(url) {
                if (url.includes('/@')) {
                    return url.split('/@')[1].split('/')[0];
                } else if (url.includes('/c/')) {
                    return url.split('/c/')[1].split('/')[0];
                } else if (url.includes('/channel/')) {
                    const channelId = url.split('/channel/')[1].split('/')[0];
                    return `ch_${channelId.substring(0, 8)}`;
                }
                return null;
            }
            
            // ë¹„ë””ì˜¤ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
            async getVideoInfo(videoId) {
                try {
                    const response = await fetch(
                        `https://www.googleapis.com/youtube/v3/videos?id=${videoId}&part=snippet,statistics&key=${this.apiKey}`
                    );
                    
                    if (!response.ok) {
                        throw new Error('API ìš”ì²­ ì‹¤íŒ¨');
                    }
                    
                    const data = await response.json();
                    return data.items && data.items.length > 0 ? data.items[0] : null;
                } catch (error) {
                    console.error('ë¹„ë””ì˜¤ ì •ë³´ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', error);
                    return null;
                }
            }
            
            // ë¹„ë””ì˜¤ ì •ë³´ì—ì„œ í‚¤ì›Œë“œ ì¶”ì¶œ
            extractKeywordsFromVideoInfo(videoInfo) {
                try {
                    const snippet = videoInfo.snippet;
                    let keywords = [];
                    
                    // ì œëª©ì—ì„œ í‚¤ì›Œë“œ ì¶”ì¶œ
                    const title = snippet.title || '';
                    const titleWords = title.split(/[\s\-_]+/)
                        .filter(word => word.length > 2 && word.length < 15)
                        .slice(0, 3);
                    keywords.push(...titleWords);
                    
                    // íƒœê·¸ê°€ ìˆìœ¼ë©´ ì‚¬ìš©
                    if (snippet.tags && snippet.tags.length > 0) {
                        keywords.push(...snippet.tags.slice(0, 2));
                    }
                    
                    // ì¹´í…Œê³ ë¦¬ IDì—ì„œ í‚¤ì›Œë“œ ìƒì„± (ì„ íƒì‚¬í•­)
                    if (snippet.categoryId) {
                        const categoryMap = {
                            '1': 'film', '2': 'autos', '10': 'music', '15': 'pets',
                            '17': 'sports', '19': 'travel', '20': 'gaming', '22': 'people',
                            '23': 'comedy', '24': 'entertainment', '25': 'news', '26': 'howto',
                            '27': 'education', '28': 'science'
                        };
                        const category = categoryMap[snippet.categoryId];
                        if (category) keywords.push(category);
                    }
                    
                    // ì¤‘ë³µ ì œê±° ë° ì •ë¦¬
                    keywords = [...new Set(keywords)]
                        .filter(keyword => keyword && keyword.length > 1)
                        .slice(0, 3);
                    
                    return keywords.length > 0 ? keywords.join('_') : `video_${videoInfo.id}`;
                } catch (error) {
                    console.error('ë¹„ë””ì˜¤ ì •ë³´ í‚¤ì›Œë“œ ì¶”ì¶œ ì˜¤ë¥˜:', error);
                    return `video_${videoInfo.id || Date.now()}`;
                }
            }
            
            // í‚¤ì›Œë“œ ì‚­ì œ
            removeKeyword(index) {
                if (index >= 0 && index < this.keywords.length) {
                    const removed = this.keywords.splice(index, 1)[0];
                    this.updateKeywordsDisplay();
                    this.saveKeywords();
                    this.showNotification(`í‚¤ì›Œë“œ ì‚­ì œ: ${removed.text}`, 'info');
                }
            }
            
            // í‚¤ì›Œë“œ í‘œì‹œ ì—…ë°ì´íŠ¸
            updateKeywordsDisplay() {
                if (!this.keywordsDisplay) return;
                
                this.keywordsDisplay.innerHTML = '';
                
                this.keywords.forEach((keyword, index) => {
                    const tag = document.createElement('div');
                    tag.className = `keyword-tag ${keyword.type === 'url' ? 'url-tag' : ''}`;
                    
                    tag.innerHTML = `
                        <span>${keyword.text}</span>
                        <button class="remove-tag" onclick="youtubeApp.removeKeyword(${index})" title="ì‚­ì œ">Ã—</button>
                    `;
                    
                    this.keywordsDisplay.appendChild(tag);
                });
            }
            
            // í‚¤ì›Œë“œ ì €ì¥
            saveKeywords() {
                try {
                    localStorage.setItem('youtube-keywords', JSON.stringify(this.keywords));
                } catch (error) {
                    console.error('í‚¤ì›Œë“œ ì €ì¥ ì˜¤ë¥˜:', error);
                }
            }
            
            // ì €ì¥ëœ í‚¤ì›Œë“œ ë¡œë“œ
            loadSavedKeywords() {
                try {
                    const saved = localStorage.getItem('youtube-keywords');
                    if (saved) {
                        this.keywords = JSON.parse(saved);
                        this.updateKeywordsDisplay();
                    }
                } catch (error) {
                    console.error('í‚¤ì›Œë“œ ë¡œë“œ ì˜¤ë¥˜:', error);
                    this.keywords = [];
                }
            }
            
            // ê²€ìƒ‰ì— ì‚¬ìš©í•  í‚¤ì›Œë“œ ë¬¸ìì—´ ìƒì„±
            getSearchQuery() {
                if (this.keywords.length === 0) {
                    return this.keywordInput.value.trim();
                }
                return this.keywords.map(k => k.text).join(' ');
            }
            
            // ì•Œë¦¼ í‘œì‹œ
            showNotification(message, type = 'info') {
                // ê°„ë‹¨í•œ ì•Œë¦¼ ì‹œìŠ¤í…œ (ê¸°ì¡´ ì½”ë“œì— ì•Œë¦¼ ì‹œìŠ¤í…œì´ ìˆë‹¤ë©´ ê·¸ê²ƒì„ ì‚¬ìš©)
                console.log(`[${type.toUpperCase()}] ${message}`);
                
                // ì„ì‹œ ì•Œë¦¼ ìš”ì†Œ ìƒì„±
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    padding: 12px 20px;
                    border-radius: 8px;
                    color: white;
                    font-weight: 500;
                    z-index: 10000;
                    opacity: 0;
                    transform: translateX(100%);
                    transition: all 0.3s ease;
                `;
                
                // íƒ€ì…ë³„ ìƒ‰ìƒ ì„¤ì •
                switch (type) {
                    case 'success':
                        notification.style.background = 'linear-gradient(135deg, #51cf66, #40c057)';
                        break;
                    case 'warning':
                        notification.style.background = 'linear-gradient(135deg, #ffd43b, #fab005)';
                        notification.style.color = '#333';
                        break;
                    case 'error':
                        notification.style.background = 'linear-gradient(135deg, #ff6b6b, #e03131)';
                        break;
                    default:
                        notification.style.background = 'linear-gradient(135deg, #45b7d1, #339af0)';
                }
                
                notification.textContent = message;
                document.body.appendChild(notification);
                
                // ì• ë‹ˆë©”ì´ì…˜
                setTimeout(() => {
                    notification.style.opacity = '1';
                    notification.style.transform = 'translateX(0)';
                }, 100);
                
                // 3ì´ˆ í›„ ì œê±°
                setTimeout(() => {
                    notification.style.opacity = '0';
                    notification.style.transform = 'translateX(100%)';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }, 3000);
            }
            // ===== Benchmarking (multi-select) =====
            initializeBenchmarkControls() {
                this.benchmarkControlsEl = document.getElementById('benchmark-controls');
                this.selectedCountEl = document.getElementById('selected-count');
                this.analyzeBenchmarkBtn = document.getElementById('analyze-benchmark-btn');
                this.viewBenchmarkReportBtn = document.getElementById('view-benchmark-report');
                const selectAllBtn = document.getElementById('select-all-btn');
                const deselectAllBtn = document.getElementById('deselect-all-btn');

                if (selectAllBtn) {
                    selectAllBtn.addEventListener('click', () => this.selectAllBenchmarkVideos());
                }
                if (deselectAllBtn) {
                    deselectAllBtn.addEventListener('click', () => this.deselectAllBenchmarkVideos());
                }
                if (this.analyzeBenchmarkBtn) {
                    this.analyzeBenchmarkBtn.addEventListener('click', () => this.analyzeSelectedBenchmarkVideos());
                }
                if (this.viewBenchmarkReportBtn) {
                    this.viewBenchmarkReportBtn.addEventListener('click', () => this.showBenchmarkReport());
                }

                this.updateBenchmarkControlsVisibility();
            }

            updateBenchmarkControlsVisibility() {
                const count = this.selectedVideos.size;
                if (this.selectedCountEl) this.selectedCountEl.textContent = String(count);
                if (this.benchmarkControlsEl) {
                    if (count > 0) this.benchmarkControlsEl.classList.add('show');
                    else this.benchmarkControlsEl.classList.remove('show');
                }
                if (this.analyzeBenchmarkBtn) this.analyzeBenchmarkBtn.disabled = count === 0;
                if (this.viewBenchmarkReportBtn) this.viewBenchmarkReportBtn.disabled = !this.benchmarkResults;
            }

            toggleBenchmarkSelection(videoId) {
                if (!videoId) return;
                const wasSelected = this.selectedVideos.has(videoId);
                if (wasSelected) this.selectedVideos.delete(videoId);
                else this.selectedVideos.add(videoId);

                const card = document.querySelector(`.video-card[data-video-id="${videoId}"]`);
                if (card) {
                    card.classList.toggle('benchmark-selected', !wasSelected);
                    const checkbox = card.querySelector('.benchmark-checkbox');
                    if (checkbox) checkbox.classList.toggle('checked', !wasSelected);
                }
                this.updateBenchmarkControlsVisibility();
            }

            selectAllBenchmarkVideos() {
                const cards = document.querySelectorAll('.results-grid .video-card[data-video-id]');
                cards.forEach(card => {
                    const vid = card.dataset.videoId;
                    if (vid) {
                        this.selectedVideos.add(vid);
                        card.classList.add('benchmark-selected');
                        const cb = card.querySelector('.benchmark-checkbox');
                        if (cb) cb.classList.add('checked');
                    }
                });
                this.updateBenchmarkControlsVisibility();
            }

            deselectAllBenchmarkVideos() {
                this.selectedVideos.clear();
                const cards = document.querySelectorAll('.results-grid .video-card');
                cards.forEach(card => {
                    card.classList.remove('benchmark-selected');
                    const cb = card.querySelector('.benchmark-checkbox');
                    if (cb) cb.classList.remove('checked');
                });
                this.updateBenchmarkControlsVisibility();
            }

            applyBenchmarkStateToCards() {
                const cards = document.querySelectorAll('.results-grid .video-card[data-video-id]');
                cards.forEach(card => {
                    const vid = card.dataset.videoId;
                    const selected = !!(vid && this.selectedVideos.has(vid));
                    card.classList.toggle('benchmark-selected', selected);
                    const cb = card.querySelector('.benchmark-checkbox');
                    if (cb) cb.classList.toggle('checked', selected);
                });
                this.updateBenchmarkControlsVisibility();
            }

            analyzeSelectedBenchmarkVideos() {
                const selectedIds = Array.from(this.selectedVideos);
                if (selectedIds.length === 0) {
                    this.showNotification('ì„ íƒëœ ì˜ìƒì´ ì—†ìŠµë‹ˆë‹¤.', 'warning');
                    return;
                }

                const pool = (this.filteredResults && this.filteredResults.length) ? this.filteredResults : this.currentResults;
                const byId = new Map();
                pool.forEach(item => {
                    const vid = item?.id?.videoId || item?.id;
                    if (vid) byId.set(vid, item);
                });
                const selectedItems = selectedIds.map(id => byId.get(id)).filter(Boolean);

                // Ensure we have full details (snippet tags/category, contentDetails)
                this.fetchBenchmarkVideoDetails(selectedIds).then(detailsMap => {
                    const enriched = selectedItems.map(it => {
                        const vid = it.id?.videoId || it.id;
                        const full = detailsMap.get(vid);
                        return full ? this.mergeVideoDetails(it, full) : it;
                    });

                const stats = { count: enriched.length, views: 0, likes: 0, comments: 0, outlierSum: 0, engagementSum: 0 };
                enriched.forEach(it => {
                    const s = it.statistics || {};
                    stats.views += parseInt(s.viewCount || '0');
                    stats.likes += parseInt(s.likeCount || '0');
                    stats.comments += parseInt(s.commentCount || '0');
                    stats.outlierSum += it.outlierScore || 0;
                    stats.engagementSum += (it.engagementRate || 0);
                });

                const avgViews = Math.round(stats.views / Math.max(1, stats.count));
                const avgOutlier = (stats.outlierSum / Math.max(1, stats.count)).toFixed(1);
                const avgEngagement = ((stats.engagementSum / Math.max(1, stats.count)) * 100).toFixed(2);

                const resultsEl = document.getElementById('benchmark-results');
                const summaryEl = document.getElementById('benchmark-summary');
                const detailsEl = document.getElementById('benchmark-details');
                if (resultsEl) resultsEl.style.display = 'block';
                if (summaryEl) {
                    summaryEl.innerHTML = `
                        <div class="benchmark-stat">
                            <div class="benchmark-stat-value">${stats.count}</div>
                            <div class="benchmark-stat-label">ì„ íƒëœ ì˜ìƒ ìˆ˜</div>
                        </div>
                        <div class="benchmark-stat">
                            <div class="benchmark-stat-value">${formatNumber(avgViews)}</div>
                            <div class="benchmark-stat-label">í‰ê·  ì¡°íšŒìˆ˜</div>
                        </div>
                        <div class="benchmark-stat">
                            <div class="benchmark-stat-value">${avgOutlier}</div>
                            <div class="benchmark-stat-label">í‰ê·  Outlier Score</div>
                        </div>
                        <div class="benchmark-stat">
                            <div class="benchmark-stat-value">${avgEngagement}%</div>
                            <div class="benchmark-stat-label">í‰ê·  ì°¸ì—¬ìœ¨</div>
                        </div>
                    `;
                }
                if (detailsEl) {
                    detailsEl.innerHTML = enriched.slice(0, 50).map(it => {
                        const vid = it.id?.videoId || it.id;
                        const title = escapeHtml(it.snippet?.title || '');
                        const views = formatNumber(parseInt(it.statistics?.viewCount || '0'));
                        const outlier = (it.outlierScore || 0);
                        return `<div class="card" style="margin-bottom: 12px;"><div class="card-header"><h3>${title}</h3></div><div style=\"display:flex;gap:16px;\"><span>ğŸ‘€ ${views}</span><span>ğŸ“Š ${outlier}ì </span></div></div>`;
                    }).join('');
                }

                // Save for full-screen report
                this.benchmarkResults = {
                    stats,
                    avgViews,
                    avgOutlier,
                    avgEngagement,
                    items: enriched
                };
                if (this.viewBenchmarkReportBtn) this.viewBenchmarkReportBtn.disabled = false;
                this.showNotification(`ë²¤ì¹˜ë§ˆí‚¹ ë¶„ì„ ì™„ë£Œ: ${stats.count}ê°œ ì˜ìƒ`, 'success');
            });
            }

            async fetchBenchmarkVideoDetails(ids) {
                const resultMap = new Map();
                if (!ids || ids.length === 0) return resultMap;
                const batchSize = 50;
                for (let i = 0; i < ids.length; i += batchSize) {
                    const chunk = ids.slice(i, i + batchSize).join(',');
                    const url = `https://www.googleapis.com/youtube/v3/videos?part=snippet,contentDetails,statistics&id=${chunk}&key=${this.apiKey}`;
                    try {
                        const res = await fetch(url);
                        const data = await res.json();
                        (data.items || []).forEach(v => {
                            const vid = v.id;
                            resultMap.set(vid, v);
                        });
                    } catch (e) {
                        console.warn('ì„¸ë¶€ ì •ë³´ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', e);
                    }
                }
                return resultMap;
            }

            mergeVideoDetails(baseItem, full) {
                // Merge snippet, statistics, and contentDetails without overwriting existing computed fields
                const merged = { ...baseItem };
                merged.id = baseItem.id?.videoId ? baseItem.id : { videoId: full.id };
                merged.snippet = { ...(baseItem.snippet || {}), ...(full.snippet || {}) };
                merged.statistics = { ...(baseItem.statistics || {}), ...(full.statistics || {}) };
                merged.contentDetails = { ...(baseItem.contentDetails || {}), ...(full.contentDetails || {}) };
                return merged;
            }

            showBenchmarkReport() {
                console.log('showBenchmarkReport called');
                const overlay = document.getElementById('benchmark-report-overlay');
                const body = document.getElementById('benchmark-report-body');
                const closeBtn = document.getElementById('close-benchmark-report');
                
                console.log('Elements found:', { overlay: !!overlay, body: !!body, closeBtn: !!closeBtn });
                console.log('benchmarkResults:', this.benchmarkResults);
                
                if (!overlay || !body || !this.benchmarkResults) {
                    console.log('Missing elements or results, returning early');
                    return;
                }

                overlay.style.display = 'flex';
                if (closeBtn) closeBtn.onclick = () => { overlay.style.display = 'none'; };

                const { stats, avgViews, avgOutlier, avgEngagement, items } = this.benchmarkResults;
                const topByViews = [...items].sort((a,b) => (parseInt(b.statistics?.viewCount||0) - parseInt(a.statistics?.viewCount||0))).slice(0,5);
                const topByOutlier = [...items].sort((a,b) => (b.outlierScore||0) - (a.outlierScore||0)).slice(0,5);

                let consulting;
                try {
                    console.log('Building consulting recommendations...');
                    consulting = this.buildConsultingRecommendations(items);
                    console.log('Consulting recommendations built:', consulting);
                } catch (error) {
                    console.error('Error building consulting recommendations:', error);
                    consulting = {
                        strengths: 'ì˜¤ë¥˜ ë°œìƒ',
                        weaknesses: 'ì˜¤ë¥˜ ë°œìƒ',
                        strategy: 'ì˜¤ë¥˜ ë°œìƒ',
                        title: 'ì˜¤ë¥˜ ë°œìƒ',
                        description: 'ì˜¤ë¥˜ ë°œìƒ'
                    };
                }

                console.log('Setting body.innerHTML...');
                body.innerHTML = this.generateExpertReportHTML(consulting, stats, avgViews, avgOutlier, avgEngagement, topByViews, topByOutlier);
                console.log('body.innerHTML set successfully');
            }

            buildConsultingRecommendations(items) {
                console.log('ğŸ” ì „ë¬¸ê°€ ìˆ˜ì¤€ ë²¤ì¹˜ë§ˆí‚¹ ë¶„ì„ ì‹œì‘...');
                
                // ê³ ê¸‰ ë¶„ì„ ì§€í‘œ ê³„ì‚°
                const analysis = this.performAdvancedAnalysis(items);
                
                // ë¶„ì•¼ë³„ ì „ë¬¸ê°€ ì»¨ì„¤íŒ…
                const consulting = {
                    // 1. ë°ì´í„° ë¶„ì„ ì „ë¬¸ê°€ ì»¨ì„¤íŒ…
                    dataAnalysis: this.generateDataAnalysisReport(analysis),
                    
                    // 2. ì½˜í…ì¸  ì „ëµ ì „ë¬¸ê°€ ì»¨ì„¤íŒ…  
                    contentStrategy: this.generateContentStrategyReport(analysis, items),
                    
                    // 3. SEO/ì•Œê³ ë¦¬ì¦˜ ì „ë¬¸ê°€ ì»¨ì„¤íŒ…
                    seoStrategy: this.generateSEOStrategyReport(analysis, items),
                    
                    // 4. ì¸ë„¤ì¼/ì‹œê°ì  ì „ë¬¸ê°€ ì»¨ì„¤íŒ…
                    visualStrategy: this.generateVisualStrategyReport(analysis, items),
                    
                    // 5. ìŠ¤í¬ë¦½íŠ¸/êµ¬ì„± ì „ë¬¸ê°€ ì»¨ì„¤íŒ…
                    scriptStrategy: this.generateScriptStrategyReport(analysis, items),
                    
                    // 6. ë§ˆì¼€íŒ…/ë¸Œëœë”© ì „ë¬¸ê°€ ì»¨ì„¤íŒ…
                    marketingStrategy: this.generateMarketingStrategyReport(analysis, items),
                    
                    // 7. ì‹¤í–‰ ë¡œë“œë§µ
                    actionPlan: this.generateActionPlan(analysis, items),
                    
                    // 8. ê²½ìŸì‚¬ ë¶„ì„ ë° ì°¨ë³„í™” ì „ëµ
                    competitiveAnalysis: this.generateCompetitiveAnalysis(analysis, items),
                    
                    // 9. ìˆ˜ìµí™” ì „ëµ
                    monetizationStrategy: this.generateMonetizationStrategy(analysis, items),
                    
                    // 10. ì„±ì¥ ê°€ì†í™” ì „ëµ
                    growthAcceleration: this.generateGrowthAccelerationStrategy(analysis, items),
                    
                    // ê¸°ì¡´ í˜¸í™˜ì„±ì„ ìœ„í•œ ë ˆê±°ì‹œ í•„ë“œë“¤ (ì—…ê·¸ë ˆì´ë“œë¨)
                    strengths: this.generateStrengthsAnalysis(analysis, items),
                    weaknesses: this.generateWeaknessesAnalysis(analysis, items),
                    strategy: this.generateMasterStrategy(analysis, items),
                    title: this.generateOptimalTitles(analysis, items),
                    description: this.generateOptimalDescriptions(analysis, items),
                    hook: this.generateHookingStrategies(analysis, items),
                    script: this.generateScriptStructures(analysis, items),
                    structure: this.generateVideoStructures(analysis, items),
                    thumbnailPrompt: this.generateThumbnailPrompts(analysis, items)
                };

                console.log('âœ… ì „ë¬¸ê°€ ìˆ˜ì¤€ ì»¨ì„¤íŒ… ë¦¬í¬íŠ¸ ì™„ì„±');
                return consulting;
            }

            generateExpertReportHTML(consulting, stats, avgViews, avgOutlier, avgEngagement, topByViews, topByOutlier) {
                return `
                    <div style="padding: 20px; color: white; max-width: 1200px; margin: 0 auto;">
                        <!-- í—¤ë” -->
                        <div style="text-align: center; margin-bottom: 30px; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 15px;">
                            <h1 style="margin: 0; font-size: 2.5em; text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">ğŸ¯ ì „ë¬¸ê°€ ë²¤ì¹˜ë§ˆí‚¹ ë¶„ì„ ë¦¬í¬íŠ¸</h1>
                            <p style="margin: 10px 0 0 0; font-size: 1.2em; opacity: 0.9;">100ë§Œ ì¡°íšŒìˆ˜ ë‹¬ì„±ì„ ìœ„í•œ ì¢…í•© ì»¨ì„¤íŒ…</p>
                        </div>

                        <!-- í•µì‹¬ ì§€í‘œ ëŒ€ì‹œë³´ë“œ -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
                            <div style="background: linear-gradient(135deg, #ff6b6b, #ee5a24); padding: 20px; border-radius: 15px; text-align: center;">
                                <h3 style="margin: 0 0 10px 0; color: white;">ğŸ“Š ë¶„ì„ ì˜ìƒ</h3>
                                <div style="font-size: 2em; font-weight: bold;">${stats.count}ê°œ</div>
                            </div>
                            <div style="background: linear-gradient(135deg, #4ecdc4, #44a08d); padding: 20px; border-radius: 15px; text-align: center;">
                                <h3 style="margin: 0 0 10px 0; color: white;">ğŸ‘€ í‰ê·  ì¡°íšŒìˆ˜</h3>
                                <div style="font-size: 2em; font-weight: bold;">${formatNumber(avgViews)}</div>
                            </div>
                            <div style="background: linear-gradient(135deg, #45b7d1, #96c93d); padding: 20px; border-radius: 15px; text-align: center;">
                                <h3 style="margin: 0 0 10px 0; color: white;">ğŸ“ˆ í‰ê·  Outlier</h3>
                                <div style="font-size: 2em; font-weight: bold;">${avgOutlier}</div>
                            </div>
                            <div style="background: linear-gradient(135deg, #f093fb, #f5576c); padding: 20px; border-radius: 15px; text-align: center;">
                                <h3 style="margin: 0 0 10px 0; color: white;">ğŸ’¬ í‰ê·  ì°¸ì—¬ìœ¨</h3>
                                <div style="font-size: 2em; font-weight: bold;">${avgEngagement}%</div>
                            </div>
                        </div>

                        <!-- ì „ë¬¸ê°€ ì»¨ì„¤íŒ… ì„¹ì…˜ -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #ffd700; margin-bottom: 20px; text-align: center; font-size: 2em;">ğŸ† ì „ë¬¸ê°€ ì»¨ì„¤íŒ… ë¦¬í¬íŠ¸</h2>
                            
                            <!-- ë°ì´í„° ë¶„ì„ ì „ë¬¸ê°€ -->
                            <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 15px; margin-bottom: 20px; border-left: 5px solid #4ecdc4;">
                                <h3 style="color: #4ecdc4; margin-top: 0;">${consulting.dataAnalysis?.title || 'ğŸ“Š ë°ì´í„° ë¶„ì„ ì „ë¬¸ê°€ ë¦¬í¬íŠ¸'}</h3>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 15px 0;">
                                    ${Object.entries(consulting.dataAnalysis?.keyMetrics || {}).map(([key, value]) => 
                                        `<div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; text-align: center;">
                                            <div style="font-size: 1.5em; font-weight: bold; color: #4ecdc4;">${value}</div>
                                            <div style="font-size: 0.9em; opacity: 0.8;">${key}</div>
                                        </div>`
                                    ).join('')}
                                </div>
                                <div style="margin-top: 20px;">
                                    <h4 style="color: #4ecdc4;">ğŸ” í•µì‹¬ ì¸ì‚¬ì´íŠ¸</h4>
                                    <ul style="margin: 10px 0; padding-left: 20px;">
                                        ${(consulting.dataAnalysis?.insights || []).map(insight => `<li style="margin: 8px 0;">${insight}</li>`).join('')}
                                    </ul>
                                </div>
                                <div style="margin-top: 20px;">
                                    <h4 style="color: #4ecdc4;">ğŸ’¡ ì¶”ì²œì‚¬í•­</h4>
                                    <ul style="margin: 10px 0; padding-left: 20px;">
                                        ${(consulting.dataAnalysis?.recommendations || []).map(rec => `<li style="margin: 8px 0;">${rec}</li>`).join('')}
                                    </ul>
                                </div>
                            </div>

                            <!-- ì½˜í…ì¸  ì „ëµ ì „ë¬¸ê°€ -->
                            <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 15px; margin-bottom: 20px; border-left: 5px solid #ff6b6b;">
                                <h3 style="color: #ff6b6b; margin-top: 0;">${consulting.contentStrategy?.title || 'ğŸ¯ ì½˜í…ì¸  ì „ëµ ì „ë¬¸ê°€ ë¦¬í¬íŠ¸'}</h3>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 15px 0;">
                                    <div>
                                        <h4 style="color: #ff6b6b;">âœ… í˜„ì¬ ê°•ì </h4>
                                        <ul style="margin: 10px 0; padding-left: 20px;">
                                            ${(consulting.contentStrategy?.currentState?.strengths || []).map(strength => `<li style="margin: 5px 0;">${strength}</li>`).join('')}
                                        </ul>
                                    </div>
                                    <div>
                                        <h4 style="color: #ff6b6b;">âš ï¸ ê°œì„ ì </h4>
                                        <ul style="margin: 10px 0; padding-left: 20px;">
                                            ${(consulting.contentStrategy?.currentState?.weaknesses || []).map(weakness => `<li style="margin: 5px 0;">${weakness}</li>`).join('')}
                                        </ul>
                                    </div>
                                </div>
                                <div style="margin-top: 20px;">
                                    <h4 style="color: #ff6b6b;">ğŸš€ ì‹¤í–‰ ê³„íš</h4>
                                    <ol style="margin: 10px 0; padding-left: 20px;">
                                        ${(consulting.contentStrategy?.actionPlan || []).map(plan => `<li style="margin: 8px 0;">${plan}</li>`).join('')}
                                    </ol>
                                </div>
                            </div>

                            <!-- SEO ì „ëµ ì „ë¬¸ê°€ -->
                            <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 15px; margin-bottom: 20px; border-left: 5px solid #45b7d1;">
                                <h3 style="color: #45b7d1; margin-top: 0;">${consulting.seoStrategy?.title || 'ğŸ” SEO/ì•Œê³ ë¦¬ì¦˜ ì „ë¬¸ê°€ ë¦¬í¬íŠ¸'}</h3>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin: 15px 0;">
                                    <div>
                                        <h4 style="color: #45b7d1;">ğŸ¯ í•µì‹¬ í‚¤ì›Œë“œ</h4>
                                        <div style="display: flex; flex-wrap: wrap; gap: 8px; margin: 10px 0;">
                                            ${(consulting.seoStrategy?.keywordStrategy?.primary || []).map(keyword => 
                                                `<span style="background: #45b7d1; color: white; padding: 5px 10px; border-radius: 15px; font-size: 0.9em;">${keyword}</span>`
                                            ).join('')}
                                        </div>
                                    </div>
                                    <div>
                                        <h4 style="color: #45b7d1;">ğŸ“ˆ íŠ¸ë Œë“œ í‚¤ì›Œë“œ</h4>
                                        <div style="display: flex; flex-wrap: wrap; gap: 8px; margin: 10px 0;">
                                            ${(consulting.seoStrategy?.keywordStrategy?.trending || []).map(keyword => 
                                                `<span style="background: #f093fb; color: white; padding: 5px 10px; border-radius: 15px; font-size: 0.9em;">${keyword}</span>`
                                            ).join('')}
                                        </div>
                                    </div>
                                </div>
                                <div style="margin-top: 20px;">
                                    <h4 style="color: #45b7d1;">ğŸ’¡ SEO ìµœì í™” ì¶”ì²œ</h4>
                                    <ul style="margin: 10px 0; padding-left: 20px;">
                                        ${(consulting.seoStrategy?.recommendations || []).map(rec => `<li style="margin: 8px 0;">${rec}</li>`).join('')}
                                    </ul>
                                </div>
                            </div>

                            <!-- ì¸ë„¤ì¼/ì‹œê°ì  ì „ë¬¸ê°€ -->
                            <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 15px; margin-bottom: 20px; border-left: 5px solid #f093fb;">
                                <h3 style="color: #f093fb; margin-top: 0;">${consulting.visualStrategy?.title || 'ğŸ¨ ì¸ë„¤ì¼/ì‹œê°ì  ì „ë¬¸ê°€ ë¦¬í¬íŠ¸'}</h3>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 15px 0;">
                                    <div>
                                        <h4 style="color: #f093fb;">ğŸ¨ ë””ìì¸ ì „ëµ</h4>
                                        <ul style="margin: 10px 0; padding-left: 20px;">
                                            <li>ìƒ‰ìƒ: ${consulting.visualStrategy?.designStrategy?.colorScheme || 'ê³ ëŒ€ë¹„ ìƒ‰ìƒ í™œìš©'}</li>
                                            <li>íƒ€ì´í¬ê·¸ë˜í”¼: ${consulting.visualStrategy?.designStrategy?.typography || 'êµµì€ í°íŠ¸ ì‚¬ìš©'}</li>
                                            <li>êµ¬ì„±: ${consulting.visualStrategy?.designStrategy?.composition || '3ë¶„í•  ë²•ì¹™ ì ìš©'}</li>
                                        </ul>
                                    </div>
                                    <div>
                                        <h4 style="color: #f093fb;">ğŸ“± ìµœì í™” ì „ëµ</h4>
                                        <ul style="margin: 10px 0; padding-left: 20px;">
                                            <li>ëª¨ë°”ì¼ ìµœì í™”: ${consulting.visualStrategy?.optimization?.mobileOptimization || 'ì‘ì€ í™”ë©´ì—ì„œë„ ëª…í™•í•œ ê°€ë…ì„±'}</li>
                                            <li>A/B í…ŒìŠ¤íŠ¸: ${consulting.visualStrategy?.optimization?.a_bTesting || 'ë‹¤ì–‘í•œ ë²„ì „ í…ŒìŠ¤íŠ¸'}</li>
                                            <li>ë¸Œëœë“œ ì¼ê´€ì„±: ${consulting.visualStrategy?.optimization?.brandConsistency || 'ì±„ë„ ì•„ì´ë´í‹°í‹° ìœ ì§€'}</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <!-- ìŠ¤í¬ë¦½íŠ¸/êµ¬ì„± ì „ë¬¸ê°€ -->
                            <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 15px; margin-bottom: 20px; border-left: 5px solid #96c93d;">
                                <h3 style="color: #96c93d; margin-top: 0;">${consulting.scriptStrategy?.title || 'ğŸ“ ìŠ¤í¬ë¦½íŠ¸/êµ¬ì„± ì „ë¬¸ê°€ ë¦¬í¬íŠ¸'}</h3>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 15px 0;">
                                    <div>
                                        <h4 style="color: #96c93d;">ğŸ¬ ìŠ¤í¬ë¦½íŠ¸ êµ¬ì¡°</h4>
                                        <ul style="margin: 10px 0; padding-left: 20px;">
                                            <li>í›„í‚¹: ${consulting.scriptStrategy?.scriptStrategy?.hookFormulas || 'ì²« 3ì´ˆ ë‚´ ê°•í•œ ì„íŒ©íŠ¸'}</li>
                                            <li>ìŠ¤í† ë¦¬: ${consulting.scriptStrategy?.scriptStrategy?.storyStructure || 'ë„ì…-ì „ê°œ-ì ˆì •-ê²°ë§'}</li>
                                            <li>í˜ì´ì‹±: ${consulting.scriptStrategy?.scriptStrategy?.pacingTechniques || 'ì ì ˆí•œ ì†ë„ ì¡°ì ˆ'}</li>
                                        </ul>
                                    </div>
                                    <div>
                                        <h4 style="color: #96c93d;">ğŸ“‹ ì½˜í…ì¸  í”„ë ˆì„ì›Œí¬</h4>
                                        <ul style="margin: 10px 0; padding-left: 20px;">
                                            <li>ì˜¤í”„ë‹: ${consulting.scriptStrategy?.contentFramework?.opening || 'ê°•ë ¥í•œ ì²«ì¸ìƒ'}</li>
                                            <li>ë³¸ë¬¸: ${consulting.scriptStrategy?.contentFramework?.body || 'ì²´ê³„ì  ì •ë³´ ì „ë‹¬'}</li>
                                            <li>ë§ˆë¬´ë¦¬: ${consulting.scriptStrategy?.contentFramework?.conclusion || 'ëª…í™•í•œ ê²°ë¡ ê³¼ CTA'}</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <!-- ë§ˆì¼€íŒ…/ë¸Œëœë”© ì „ë¬¸ê°€ -->
                            <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 15px; margin-bottom: 20px; border-left: 5px solid #ffd700;">
                                <h3 style="color: #ffd700; margin-top: 0;">${consulting.marketingStrategy?.title || 'ğŸ“ˆ ë§ˆì¼€íŒ…/ë¸Œëœë”© ì „ë¬¸ê°€ ë¦¬í¬íŠ¸'}</h3>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 15px 0;">
                                    <div>
                                        <h4 style="color: #ffd700;">ğŸ¯ ë¸Œëœë“œ ë¶„ì„</h4>
                                        <ul style="margin: 10px 0; padding-left: 20px;">
                                            <li>í¬ì§€ì…”ë‹: ${consulting.marketingStrategy?.brandAnalysis?.positioning || 'ì°¨ë³„í™”ëœ í¬ì§€ì…”ë‹'}</li>
                                            <li>íƒ€ê²Ÿ: ${consulting.marketingStrategy?.brandAnalysis?.targetAudience || 'ëª…í™•í•œ íƒ€ê²Ÿ ì„¤ì •'}</li>
                                            <li>ê°€ì¹˜: ${consulting.marketingStrategy?.brandAnalysis?.valueProposition || 'ê³ ìœ í•œ ê°€ì¹˜ ì œì•ˆ'}</li>
                                        </ul>
                                    </div>
                                    <div>
                                        <h4 style="color: #ffd700;">ğŸš€ ì„±ì¥ ì „ëµ</h4>
                                        <ul style="margin: 10px 0; padding-left: 20px;">
                                            <li>ì½˜í…ì¸  ìº˜ë¦°ë”: ${consulting.marketingStrategy?.growthStrategy?.contentCalendar || 'ì²´ê³„ì  ì—…ë¡œë“œ ê³„íš'}</li>
                                            <li>í¬ë¡œìŠ¤ í”„ë¡œëª¨ì…˜: ${consulting.marketingStrategy?.growthStrategy?.crossPromotion || 'ë‹¤ì–‘í•œ ì±„ë„ í™œìš©'}</li>
                                            <li>ì»¤ë®¤ë‹ˆí‹°: ${consulting.marketingStrategy?.growthStrategy?.communityBuilding || 'ê°•ë ¥í•œ íŒ¬ ì»¤ë®¤ë‹ˆí‹° êµ¬ì¶•'}</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <!-- ì˜ìƒ ì œì‘ ë””ë ‰íŒ… ê°€ì´ë“œ -->
                            <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 15px; margin-bottom: 20px; border-left: 5px solid #667eea;">
                                <h3 style="color: #667eea; margin-top: 0;">ğŸ¬ ì˜ìƒ ì œì‘ ë””ë ‰íŒ… ê°€ì´ë“œ</h3>
                                <p style="margin: 10px 0; opacity: 0.9;">ì¡°íšŒìˆ˜ 1ë“±ì„ ìœ„í•œ ì™„ì „í•œ ì˜ìƒ ì œì‘ ê°€ì´ë“œ</p>
                                
                                <!-- ì œëª© ë””ë ‰íŒ… -->
                                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; margin: 15px 0;">
                                    <h4 style="color: #667eea; margin-top: 0;">ğŸ“ ìœ íŠœë¸Œ ì œëª© ë””ë ‰íŒ…</h4>
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin: 15px 0;">
                                        <div>
                                            <h5 style="color: #4ecdc4; margin: 10px 0;">Aê¸‰ ì œëª© (ì¶”ì²œ)</h5>
                                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; margin: 10px 0;">
                                                <p style="margin: 0; font-weight: bold; color: #4ecdc4;">${consulting.title || 'ì¡°íšŒìˆ˜ 100ë§Œ ë‹¬ì„± ë¹„ë²•: [í•µì‹¬ í‚¤ì›Œë“œ]ë¡œ 7ì¼ ë§Œì— ê²°ê³¼ ë§Œë“¤ê¸° (ì‹¤ì „ ê°€ì´ë“œ)'}</p>
                                            </div>
                                            <button onclick="navigator.clipboard.writeText('${consulting.title || ''}')" style="background: #4ecdc4; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-size: 0.9em;">ğŸ“‹ ë³µì‚¬</button>
                                        </div>
                                        <div>
                                            <h5 style="color: #ff6b6b; margin: 10px 0;">Bê¸‰ ì œëª© (ëŒ€ì•ˆ)</h5>
                                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; margin: 10px 0;">
                                                <p style="margin: 0; font-weight: bold; color: #ff6b6b;">[í•µì‹¬ í‚¤ì›Œë“œ] ì´ˆë³´ìë„ ë”°ë¼í•  ìˆ˜ ìˆëŠ” 100ë§Œ ì¡°íšŒìˆ˜ ë¹„ë²• ê³µê°œ</p>
                                            </div>
                                            <button onclick="navigator.clipboard.writeText('[í•µì‹¬ í‚¤ì›Œë“œ] ì´ˆë³´ìë„ ë”°ë¼í•  ìˆ˜ ìˆëŠ” 100ë§Œ ì¡°íšŒìˆ˜ ë¹„ë²• ê³µê°œ')" style="background: #ff6b6b; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-size: 0.9em;">ğŸ“‹ ë³µì‚¬</button>
                                        </div>
                                    </div>
                                    <div style="margin-top: 15px;">
                                        <h5 style="color: #ffd700; margin: 10px 0;">ì œëª© ë””ë ‰íŒ… í¬ì¸íŠ¸</h5>
                                        <ul style="margin: 10px 0; padding-left: 20px; font-size: 0.9em;">
                                            <li>í•µì‹¬ í‚¤ì›Œë“œë¥¼ ì œëª© ì•ìª½ 60ì ë‚´ì— ë°°ì¹˜</li>
                                            <li>ê°ì •ì  ì–´í•„ ìš”ì†Œ(!, ?, ìˆ«ì) í™œìš©</li>
                                            <li>êµ¬ì²´ì  ê²°ê³¼/í˜œíƒ ëª…ì‹œ (7ì¼, 100ë§Œ ì¡°íšŒìˆ˜)</li>
                                            <li>ëª¨ë°”ì¼ì—ì„œ ì™„ì „ í‘œì‹œë˜ë„ë¡ 30-60ìë¡œ ì œí•œ</li>
                                        </ul>
                                    </div>
                                </div>

                                <!-- ì„¤ëª… ë””ë ‰íŒ… -->
                                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; margin: 15px 0;">
                                    <h4 style="color: #667eea; margin-top: 0;">ğŸ“‹ ìœ íŠœë¸Œ ì„¤ëª… ë””ë ‰íŒ…</h4>
                                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; margin: 10px 0; max-height: 300px; overflow-y: auto;">
                                        <p style="margin: 0; font-size: 0.9em; line-height: 1.5; white-space: pre-wrap;">${consulting.description || 'ì´ ì˜ìƒì€ [í•µì‹¬ í‚¤ì›Œë“œ] ì£¼ì œë¡œ 100ë§Œ ì¡°íšŒìˆ˜ë¥¼ ëª©í‘œë¡œ ì œì‘ëœ ì‹¤ì „ ê°€ì´ë“œì…ë‹ˆë‹¤.'}</p>
                                    </div>
                                    <button onclick="navigator.clipboard.writeText('${consulting.description || ''}')" style="background: #667eea; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-top: 10px;">ğŸ“‹ ë³µì‚¬</button>
                                    
                                    <div style="margin-top: 15px;">
                                        <h5 style="color: #ffd700; margin: 10px 0;">ì„¤ëª… ë””ë ‰íŒ… í¬ì¸íŠ¸</h5>
                                        <ul style="margin: 10px 0; padding-left: 20px; font-size: 0.9em;">
                                            <li>ì²« 125ìì— í•µì‹¬ í‚¤ì›Œë“œì™€ ê°€ì¹˜ ì œì•ˆ ëª…ì‹œ</li>
                                            <li>íƒ€ì„ë¼ì¸ êµ¬ì¡°ë¡œ ì‹œì²­ì í¸ì˜ì„± ì œê³µ</li>
                                            <li>ê´€ë ¨ í•´ì‹œíƒœê·¸ 3-5ê°œë¡œ ê²€ìƒ‰ ë…¸ì¶œ í™•ëŒ€</li>
                                            <li>ëŒ“ê¸€ ìœ ë„ ì§ˆë¬¸ìœ¼ë¡œ ì°¸ì—¬ìœ¨ ì¦ëŒ€</li>
                                        </ul>
                                    </div>
                                </div>

                                <!-- íƒœê·¸ ë””ë ‰íŒ… -->
                                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; margin: 15px 0;">
                                    <h4 style="color: #667eea; margin-top: 0;">ğŸ·ï¸ ìœ íŠœë¸Œ íƒœê·¸ ë””ë ‰íŒ…</h4>
                                    <div style="display: flex; flex-wrap: wrap; gap: 8px; margin: 15px 0;">
                                        <span style="background: #4ecdc4; color: white; padding: 5px 10px; border-radius: 15px; font-size: 0.9em;">í•µì‹¬í‚¤ì›Œë“œ</span>
                                        <span style="background: #4ecdc4; color: white; padding: 5px 10px; border-radius: 15px; font-size: 0.9em;">í•µì‹¬í‚¤ì›Œë“œë¹„ë²•</span>
                                        <span style="background: #4ecdc4; color: white; padding: 5px 10px; border-radius: 15px; font-size: 0.9em;">ì¡°íšŒìˆ˜100ë§Œ</span>
                                        <span style="background: #4ecdc4; color: white; padding: 5px 10px; border-radius: 15px; font-size: 0.9em;">ì‹¤ì „ê°€ì´ë“œ</span>
                                        <span style="background: #4ecdc4; color: white; padding: 5px 10px; border-radius: 15px; font-size: 0.9em;">ë…¸í•˜ìš°</span>
                                        <span style="background: #4ecdc4; color: white; padding: 5px 10px; border-radius: 15px; font-size: 0.9em;">ì´ˆë³´ì</span>
                                        <span style="background: #4ecdc4; color: white; padding: 5px 10px; border-radius: 15px; font-size: 0.9em;">íŠœí† ë¦¬ì–¼</span>
                                        <span style="background: #4ecdc4; color: white; padding: 5px 10px; border-radius: 15px; font-size: 0.9em;">íŒ</span>
                                    </div>
                                    <button onclick="navigator.clipboard.writeText('í•µì‹¬í‚¤ì›Œë“œ, í•µì‹¬í‚¤ì›Œë“œë¹„ë²•, ì¡°íšŒìˆ˜100ë§Œ, ì‹¤ì „ê°€ì´ë“œ, ë…¸í•˜ìš°, ì´ˆë³´ì, íŠœí† ë¦¬ì–¼, íŒ')" style="background: #4ecdc4; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-top: 10px;">ğŸ“‹ ë³µì‚¬</button>
                                </div>

                                <!-- ìŠ¤í¬ë¦½íŠ¸ ë””ë ‰íŒ… -->
                                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; margin: 15px 0;">
                                    <h4 style="color: #667eea; margin-top: 0;">ğŸ“ ìƒì„¸ ìŠ¤í¬ë¦½íŠ¸ ë””ë ‰íŒ…</h4>
                                    <div style="margin-bottom: 15px;">
                                        <label style="color: #4ecdc4; font-weight: bold; margin-right: 10px;">ì˜ìƒ ê¸¸ì´ ì„ íƒ:</label>
                                        <select id="script-length-select" style="background: rgba(255,255,255,0.1); color: white; border: 1px solid #4ecdc4; border-radius: 5px; padding: 5px 10px; margin-right: 10px;">
                                            <option value="short">ìˆí¼ (30-60ì´ˆ)</option>
                                            <option value="medium">ë¯¸ë””ì—„ (2-5ë¶„)</option>
                                            <option value="long" selected>ë¡±í¼ (8-15ë¶„)</option>
                                        </select>
                                        <button onclick="generateScript()" style="background: #4ecdc4; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: bold;">ğŸ¬ AI ìŠ¤í¬ë¦½íŠ¸ ìƒì„±</button>
                                    </div>
                                    <div id="script-content" style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; margin: 10px 0; max-height: 500px; overflow-y: auto;">
                                        <p style="margin: 0; font-size: 0.9em; line-height: 1.5; white-space: pre-wrap; color: #ccc;">ìŠ¤í¬ë¦½íŠ¸ë¥¼ ìƒì„±í•˜ë ¤ë©´ ìœ„ì˜ "AI ìŠ¤í¬ë¦½íŠ¸ ìƒì„±" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.</p>
                                    </div>
                                    <button onclick="copyScript()" style="background: #667eea; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-top: 10px; display: none;" id="copy-script-btn">ğŸ“‹ ìŠ¤í¬ë¦½íŠ¸ ë³µì‚¬</button>
                                </div>

                                <!-- í›„í‚¹ ë””ë ‰íŒ… -->
                                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; margin: 15px 0;">
                                    <h4 style="color: #667eea; margin-top: 0;">ğŸ£ í›„í‚¹ ë””ë ‰íŒ…</h4>
                                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; margin: 10px 0;">
                                        <p style="margin: 0; font-size: 1em; line-height: 1.5; font-style: italic; color: #ffd700;">"${consulting.hook || 'ì§€ê¸ˆë¶€í„° 7ì¼ ì•ˆì— [í‚¤ì›Œë“œ]ë¡œ ê²°ê³¼ë¥¼ ë‚´ëŠ” ê°€ì¥ ë¹ ë¥¸ ë°©ë²•ì„ ê³µê°œí•©ë‹ˆë‹¤. ì‹¤íŒ¨í–ˆë˜ ì‚¬ëŒë“¤ë„ ì´ ìˆœì„œëŒ€ë¡œë§Œ í•˜ë©´ ë‹¬ë¼ì§‘ë‹ˆë‹¤.'}"</p>
                                    </div>
                                    <button onclick="navigator.clipboard.writeText('${consulting.hook || ''}')" style="background: #ffd700; color: black; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-top: 10px; font-weight: bold;">ğŸ“‹ ë³µì‚¬</button>
                                    
                                    <div style="margin-top: 15px;">
                                        <h5 style="color: #ffd700; margin: 10px 0;">í›„í‚¹ ë””ë ‰íŒ… í¬ì¸íŠ¸</h5>
                                        <ul style="margin: 10px 0; padding-left: 20px; font-size: 0.9em;">
                                            <li>ì²« 3ì´ˆ ë‚´ì— ê°•í•œ ì„íŒ©íŠ¸ ì „ë‹¬</li>
                                            <li>êµ¬ì²´ì  ê²°ê³¼/í˜œíƒ ì•½ì†</li>
                                            <li>ê°ì •ì  ì–´í•„ (í˜¸ê¸°ì‹¬, ê¸´ê¸‰ì„±)</li>
                                            <li>ì‹œì²­ìì—ê²Œ ì§ì ‘ì ìœ¼ë¡œ ë§í•˜ê¸°</li>
                                        </ul>
                                    </div>
                                </div>

                                <!-- ì´¬ì˜ ë°©ë²• ë””ë ‰íŒ… -->
                                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; margin: 15px 0;">
                                    <h4 style="color: #667eea; margin-top: 0;">ğŸ¥ ì˜ìƒ ì´¬ì˜ ë°©ë²• ë””ë ‰íŒ…</h4>
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 15px 0;">
                                        <div>
                                            <h5 style="color: #4ecdc4; margin: 10px 0;">ì´¬ì˜ ì„¤ì •</h5>
                                            <ul style="margin: 10px 0; padding-left: 20px; font-size: 0.9em;">
                                                <li>í•´ìƒë„: 4K (3840x2160) ìµœì†Œ 1080p</li>
                                                <li>í”„ë ˆì„ë ˆì´íŠ¸: 30fps (ì•ˆì •ì ), 60fps (ì•¡ì…˜)</li>
                                                <li>ë¹„íŠ¸ë ˆì´íŠ¸: 50Mbps ì´ìƒ</li>
                                                <li>ì½”ë±: H.264 ë˜ëŠ” H.265</li>
                                            </ul>
                                        </div>
                                        <div>
                                            <h5 style="color: #ff6b6b; margin: 10px 0;">ì˜¤ë””ì˜¤ ì„¤ì •</h5>
                                            <ul style="margin: 10px 0; padding-left: 20px; font-size: 0.9em;">
                                                <li>ìƒ˜í”Œë ˆì´íŠ¸: 48kHz</li>
                                                <li>ë¹„íŠ¸ë ˆì´íŠ¸: 320kbps</li>
                                                <li>ë§ˆì´í¬: ë¼ë²¨ ë§ˆì´í¬ ë˜ëŠ” ë³´ì´ìŠ¤ ë ˆì½”ë”</li>
                                                <li>ë…¸ì´ì¦ˆ ì œê±°: í•„ìˆ˜</li>
                                            </ul>
                                        </div>
                                        <div>
                                            <h5 style="color: #45b7d1; margin: 10px 0;">ì¡°ëª… ì„¤ì •</h5>
                                            <ul style="margin: 10px 0; padding-left: 20px; font-size: 0.9em;">
                                                <li>ì£¼ì¡°ëª…: 5600K (ìì—°ê´‘)</li>
                                                <li>ë³´ì¡°ì¡°ëª…: 3200K (ë”°ëœ»í•œ í†¤)</li>
                                                <li>ë°°ê²½ì¡°ëª…: 3ì  ì¡°ëª…ë²•</li>
                                                <li>ì‹¤ë‚´: LED íŒ¨ë„ 2-3ê°œ</li>
                                            </ul>
                                        </div>
                                        <div>
                                            <h5 style="color: #f093fb; margin: 10px 0;">êµ¬ë„ ì„¤ì •</h5>
                                            <ul style="margin: 10px 0; padding-left: 20px; font-size: 0.9em;">
                                                <li>ìƒ·: ë¯¸ë””ì—„ í´ë¡œì¦ˆì—… (ê°€ìŠ´ ìœ„)</li>
                                                <li>ê°ë„: ì•½ê°„ ì•„ë˜ì—ì„œ ìœ„ë¡œ</li>
                                                <li>ë°°ê²½: ë‹¨ìˆœí•˜ê³  ê¹”ë”í•œ ë°°ê²½</li>
                                                <li>ë£©: 3ë¶„í•  ë²•ì¹™ ì ìš©</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>

                                <!-- ì˜ìƒ êµ¬ì„± ë””ë ‰íŒ… -->
                                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; margin: 15px 0;">
                                    <h4 style="color: #667eea; margin-top: 0;">ğŸ¬ ì˜ìƒ êµ¬ì„± ë””ë ‰íŒ…</h4>
                                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; margin: 10px 0;">
                                        <p style="margin: 0; font-size: 0.9em; line-height: 1.5; white-space: pre-wrap;">${consulting.structure || '- ì˜¤í”„ë‹: 20ì´ˆ ë‚´ ê°•í•œ ë¹„ì£¼ì–¼ê³¼ ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸°\n- ë³¸ë¬¸: ë‹¨ê³„ë³„ ì‹œì—° + ì²´í¬ë¦¬ìŠ¤íŠ¸ ì˜¤ë²„ë ˆì´\n- B-roll: ì†/í™”ë©´ í´ë¡œì¦ˆì—…, í…ìŠ¤íŠ¸ íŒ\n- ì˜¤ë””ì˜¤: ê²½ì¾Œí•œ bpm 100-110, ì „í™˜ë§ˆë‹¤ ë¦¬ë“¬ í¬ì¸íŠ¸'}</p>
                                    </div>
                                    <button onclick="navigator.clipboard.writeText('${consulting.structure || ''}')" style="background: #667eea; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-top: 10px;">ğŸ“‹ ë³µì‚¬</button>
                                    
                                    <div style="margin-top: 15px;">
                                        <h5 style="color: #ffd700; margin: 10px 0;">êµ¬ì„± ë””ë ‰íŒ… í¬ì¸íŠ¸</h5>
                                        <ul style="margin: 10px 0; padding-left: 20px; font-size: 0.9em;">
                                            <li>ì˜¤í”„ë‹: 20ì´ˆ ë‚´ ê°•í•œ ë¹„ì£¼ì–¼ê³¼ ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸°</li>
                                            <li>ë³¸ë¬¸: ë‹¨ê³„ë³„ ì‹œì—° + ì²´í¬ë¦¬ìŠ¤íŠ¸ ì˜¤ë²„ë ˆì´</li>
                                            <li>B-roll: ì†/í™”ë©´ í´ë¡œì¦ˆì—…, í…ìŠ¤íŠ¸ íŒ</li>
                                            <li>ì˜¤ë””ì˜¤: ê²½ì¾Œí•œ bpm 100-110, ì „í™˜ë§ˆë‹¤ ë¦¬ë“¬ í¬ì¸íŠ¸</li>
                                            <li>ìƒ‰ê°: ê³ ëŒ€ë¹„, ë”°ëœ»í•œ í†¤ìœ¼ë¡œ ì‹ ë¢°ê° ì¡°ì„±</li>
                                            <li>í°íŠ¸: êµµê³  ëª…í™•í•œ sans-serif, ëª¨ë°”ì¼ ìµœì í™”</li>
                                        </ul>
                                    </div>
                                </div>

                                <!-- ì¸ë„¤ì¼ ë””ë ‰íŒ… -->
                                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; margin: 15px 0;">
                                    <h4 style="color: #667eea; margin-top: 0;">ğŸ¨ ì¸ë„¤ì¼ ë””ë ‰íŒ…</h4>
                                    <div style="margin-bottom: 15px;">
                                        <button onclick="generateThumbnailPrompt()" style="background: #f093fb; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: bold; margin-right: 10px;">ğŸ¨ AI ì¸ë„¤ì¼ í”„ë¡¬í”„íŠ¸ ìƒì„±</button>
                                        <button onclick="generateThumbnailImage()" style="background: #ff6b6b; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: bold;">ğŸ–¼ï¸ Geminië¡œ ì¸ë„¤ì¼ ìƒì„±</button>
                                    </div>
                                    <div id="thumbnail-prompt-content" style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; margin: 10px 0;">
                                        <p style="margin: 0; font-size: 0.9em; line-height: 1.5; color: #ccc;">ì¸ë„¤ì¼ í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•˜ë ¤ë©´ ìœ„ì˜ "AI ì¸ë„¤ì¼ í”„ë¡¬í”„íŠ¸ ìƒì„±" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.</p>
                                    </div>
                                    <div id="thumbnail-image-content" style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; margin: 10px 0; text-align: center;">
                                        <p style="margin: 0; font-size: 0.9em; color: #ccc;">ì¸ë„¤ì¼ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ë ¤ë©´ ìœ„ì˜ "Geminië¡œ ì¸ë„¤ì¼ ìƒì„±" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.</p>
                                    </div>
                                    <button onclick="copyThumbnailPrompt()" style="background: #f093fb; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-top: 10px; display: none;" id="copy-thumbnail-btn">ğŸ“‹ í”„ë¡¬í”„íŠ¸ ë³µì‚¬</button>
                                    
                                    <div style="margin-top: 15px;">
                                        <h5 style="color: #ffd700; margin: 10px 0;">ì¸ë„¤ì¼ ë””ë ‰íŒ… í¬ì¸íŠ¸</h5>
                                        <ul style="margin: 10px 0; padding-left: 20px; font-size: 0.9em;">
                                            <li>ê³ ëŒ€ë¹„ ìƒ‰ìƒìœ¼ë¡œ ëˆˆì— ë„ê²Œ</li>
                                            <li>êµµê³  ëª…í™•í•œ í…ìŠ¤íŠ¸ ì˜¤ë²„ë ˆì´</li>
                                            <li>ê°ì •ì  í‘œí˜„ì´ í’ë¶€í•œ ì–¼êµ´</li>
                                            <li>ê¹”ë”í•œ ë°°ê²½ìœ¼ë¡œ ì£¼ì œ ê°•ì¡°</li>
                                            <li>ëª¨ë°”ì¼ì—ì„œë„ ëª…í™•í•˜ê²Œ ë³´ì´ë„ë¡</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- ìƒìœ„ ì˜ìƒ ë¶„ì„ -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #ffd700; margin-bottom: 20px; text-align: center; font-size: 2em;">ğŸ† ìƒìœ„ ì˜ìƒ ë¶„ì„</h2>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(500px, 1fr)); gap: 20px;">
                                <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 15px;">
                                    <h3 style="color: #4ecdc4; margin-top: 0;">ğŸ‘€ ì¡°íšŒìˆ˜ TOP 5</h3>
                                    ${topByViews.map((v, index) => `
                                        <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; margin: 10px 0; display: flex; justify-content: space-between; align-items: center;">
                                            <div style="flex: 1;">
                                                <div style="font-weight: bold; margin-bottom: 5px;">${index + 1}. ${escapeHtml(v.snippet?.title || '')}</div>
                                                <div style="font-size: 0.9em; opacity: 0.8;">${escapeHtml(v.snippet?.channelTitle || '')}</div>
                                            </div>
                                            <div style="text-align: right;">
                                                <div style="font-size: 1.2em; font-weight: bold; color: #4ecdc4;">${formatNumber(parseInt(v.statistics?.viewCount || 0))}</div>
                                                <div style="font-size: 0.8em; opacity: 0.8;">ì¡°íšŒìˆ˜</div>
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                                
                                <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 15px;">
                                    <h3 style="color: #ff6b6b; margin-top: 0;">ğŸ“Š Outlier TOP 5</h3>
                                    ${topByOutlier.map((v, index) => `
                                        <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; margin: 10px 0; display: flex; justify-content: space-between; align-items: center;">
                                            <div style="flex: 1;">
                                                <div style="font-weight: bold; margin-bottom: 5px;">${index + 1}. ${escapeHtml(v.snippet?.title || '')}</div>
                                                <div style="font-size: 0.9em; opacity: 0.8;">${escapeHtml(v.snippet?.channelTitle || '')}</div>
                                            </div>
                                            <div style="text-align: right;">
                                                <div style="font-size: 1.2em; font-weight: bold; color: #ff6b6b;">${v.outlierScore || 0}</div>
                                                <div style="font-size: 0.8em; opacity: 0.8;">Outlier</div>
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>

                        <!-- ìµœì í™”ëœ ì½˜í…ì¸  ì œì•ˆ -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #ffd700; margin-bottom: 20px; text-align: center; font-size: 2em;">ğŸ’¡ ìµœì í™”ëœ ì½˜í…ì¸  ì œì•ˆ</h2>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px;">
                                <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 15px; border-left: 5px solid #4ecdc4;">
                                    <h3 style="color: #4ecdc4; margin-top: 0;">ğŸ“ ì¶”ì²œ ì œëª©</h3>
                                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; margin: 10px 0;">
                                        <p style="margin: 0; font-size: 1.1em; line-height: 1.5;">${consulting.title || 'ì¡°íšŒìˆ˜ 100ë§Œ ë‹¬ì„± ë¹„ë²•: [í•µì‹¬ í‚¤ì›Œë“œ]ë¡œ 7ì¼ ë§Œì— ê²°ê³¼ ë§Œë“¤ê¸° (ì‹¤ì „ ê°€ì´ë“œ)'}</p>
                                    </div>
                                    <button onclick="navigator.clipboard.writeText('${consulting.title || ''}')" style="background: #4ecdc4; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-top: 10px;">ğŸ“‹ ë³µì‚¬</button>
                                </div>
                                
                                <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 15px; border-left: 5px solid #ff6b6b;">
                                    <h3 style="color: #ff6b6b; margin-top: 0;">ğŸ“‹ ì¶”ì²œ ì„¤ëª…</h3>
                                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; margin: 10px 0; max-height: 200px; overflow-y: auto;">
                                        <p style="margin: 0; font-size: 0.9em; line-height: 1.5; white-space: pre-wrap;">${consulting.description || 'ì´ ì˜ìƒì€ [í•µì‹¬ í‚¤ì›Œë“œ] ì£¼ì œë¡œ 100ë§Œ ì¡°íšŒìˆ˜ë¥¼ ëª©í‘œë¡œ ì œì‘ëœ ì‹¤ì „ ê°€ì´ë“œì…ë‹ˆë‹¤.'}</p>
                                    </div>
                                    <button onclick="navigator.clipboard.writeText('${consulting.description || ''}')" style="background: #ff6b6b; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-top: 10px;">ğŸ“‹ ë³µì‚¬</button>
                                </div>
                                
                                <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 15px; border-left: 5px solid #45b7d1;">
                                    <h3 style="color: #45b7d1; margin-top: 0;">ğŸ£ í›„í‚¹ ì „ëµ</h3>
                                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; margin: 10px 0;">
                                        <p style="margin: 0; font-size: 1em; line-height: 1.5; font-style: italic;">"${consulting.hook || 'ì§€ê¸ˆë¶€í„° 7ì¼ ì•ˆì— [í‚¤ì›Œë“œ]ë¡œ ê²°ê³¼ë¥¼ ë‚´ëŠ” ê°€ì¥ ë¹ ë¥¸ ë°©ë²•ì„ ê³µê°œí•©ë‹ˆë‹¤.'}"</p>
                                    </div>
                                    <button onclick="navigator.clipboard.writeText('${consulting.hook || ''}')" style="background: #45b7d1; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-top: 10px;">ğŸ“‹ ë³µì‚¬</button>
                                </div>
                                
                                <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 15px; border-left: 5px solid #f093fb;">
                                    <h3 style="color: #f093fb; margin-top: 0;">ğŸ¨ ì¸ë„¤ì¼ í”„ë¡¬í”„íŠ¸</h3>
                                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; margin: 10px 0;">
                                        <p style="margin: 0; font-size: 0.9em; line-height: 1.5;">${consulting.thumbnailPrompt || 'Ultra-detailed thumbnail for YouTube about [í•µì‹¬ í‚¤ì›Œë“œ]. One main subject, high-contrast colors, bold 2-3 word overlay in Korean, expressive face or clear object, clean background, cinematic lighting, 4k, no clutter.'}</p>
                                    </div>
                                    <button onclick="navigator.clipboard.writeText('${consulting.thumbnailPrompt || ''}')" style="background: #f093fb; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-top: 10px;">ğŸ“‹ ë³µì‚¬</button>
                                </div>
                            </div>
                        </div>

                        <!-- í•˜ë‹¨ ì•¡ì…˜ ë²„íŠ¼ -->
                        <!-- AI API ì„¤ì • ì„¹ì…˜ -->
                        <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 15px; margin: 20px 0; border-left: 5px solid #ffd700;">
                            <h3 style="color: #ffd700; margin-top: 0;">ğŸ¤– AI API ì„¤ì •</h3>
                            <p style="margin: 10px 0; opacity: 0.9;">ì‹¤ì œ AIë¥¼ í†µí•œ ìŠ¤í¬ë¦½íŠ¸ ë° ì¸ë„¤ì¼ ìƒì„±</p>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 15px 0;">
                                <div>
                                    <h4 style="color: #4ecdc4; margin: 10px 0;">OpenAI API í‚¤</h4>
                                    <input type="password" id="ai-api-key" placeholder="sk-..." style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #4ecdc4; background: rgba(255,255,255,0.1); color: white; margin: 5px 0;">
                                    <button onclick="saveAIApiKey()" style="background: #4ecdc4; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin: 5px 0;">ğŸ’¾ ì €ì¥</button>
                                    <p style="font-size: 0.8em; opacity: 0.7; margin: 5px 0;">ìŠ¤í¬ë¦½íŠ¸ ìƒì„± ë° ì¸ë„¤ì¼ ìƒì„±ì— ì‚¬ìš©</p>
                                </div>
                                <div>
                                    <h4 style="color: #ff6b6b; margin: 10px 0;">AI ê¸°ëŠ¥ ìƒíƒœ</h4>
                                    <div id="ai-status" style="padding: 10px; border-radius: 5px; background: rgba(255,255,255,0.1); margin: 5px 0;">
                                        <span id="ai-status-text">API í‚¤ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”</span>
                                    </div>
                                    <button onclick="testAIApi()" style="background: #ff6b6b; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin: 5px 0;">ğŸ§ª í…ŒìŠ¤íŠ¸</button>
                                </div>
                            </div>
                            
                            <div style="margin-top: 15px;">
                                <h4 style="color: #ffd700; margin: 10px 0;">ì§€ì›í•˜ëŠ” AI ì„œë¹„ìŠ¤</h4>
                                <ul style="margin: 10px 0; padding-left: 20px; font-size: 0.9em;">
                                    <li>OpenAI GPT-4: ê³ í’ˆì§ˆ ìŠ¤í¬ë¦½íŠ¸ ìƒì„±</li>
                                    <li>DALL-E 3: ì „ë¬¸ê°€ ìˆ˜ì¤€ ì¸ë„¤ì¼ ìƒì„±</li>
                                    <li>Claude (ì˜ˆì •): ê³ ê¸‰ ë¶„ì„ ë° ì»¨ì„¤íŒ…</li>
                                    <li>Gemini (ì˜ˆì •): ë‹¤êµ­ì–´ ì§€ì›</li>
                                </ul>
                            </div>
                        </div>

                        <div style="text-align: center; margin-top: 30px; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 15px;">
                            <button onclick="window.print()" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; padding: 15px 30px; border-radius: 25px; font-size: 1.1em; cursor: pointer; margin: 0 10px;">
                                ğŸ–¨ï¸ ë¦¬í¬íŠ¸ ì¸ì‡„
                            </button>
                            <button onclick="navigator.clipboard.writeText(document.querySelector('#benchmark-report-body').innerText)" style="background: linear-gradient(135deg, #4ecdc4, #44a08d); color: white; border: none; padding: 15px 30px; border-radius: 25px; font-size: 1.1em; cursor: pointer; margin: 0 10px;">
                                ğŸ“‹ ì „ì²´ ë³µì‚¬
                            </button>
                        </div>
                    </div>
                `;
            }

            performAdvancedAnalysis(items) {
                try {
                    console.log('ğŸ”¬ ê³ ê¸‰ ë¶„ì„ ì—”ì§„ ì‹¤í–‰ ì¤‘...', items.length, 'ê°œ ì˜ìƒ ë¶„ì„');
                    
                    // ê¸°ë³¸ ë©”íŠ¸ë¦­ ì¶”ì¶œ
                    const views = items.map(v => parseInt(v.statistics?.viewCount||'0')).filter(n=>!isNaN(n));
                    const likes = items.map(v => parseInt(v.statistics?.likeCount||'0')).filter(n=>!isNaN(n));
                    const comments = items.map(v => parseInt(v.statistics?.commentCount||'0')).filter(n=>!isNaN(n));
                    const durations = items.map(v => parseDuration(v.contentDetails?.duration||'PT0S')).filter(n=>!isNaN(n));
                    const subscriberCounts = items.map(v => parseInt(v.channelDetails?.subscriberCount||'0')).filter(n=>!isNaN(n));
                
                    // ê¸°ë³¸ í†µê³„
                    const totalViews = views.reduce((a,b)=>a+b,0);
                    const avgViews = views.length ? totalViews/views.length : 0;
                    const maxViews = Math.max(...views, 0);
                    const minViews = Math.min(...views, 0);
                    const medianViews = this.calculateMedian(views);
                    
                    // ê³ ê¸‰ ë©”íŠ¸ë¦­ ê³„ì‚°
                    const engagementRate = this.calculateAdvancedEngagementRate(views, likes, comments);
                    const viewVelocity = this.calculateViewVelocity(items);
                    const viralPotential = this.calculateViralPotential(views, engagementRate, durations);
                    const contentQuality = this.calculateContentQualityScore(items);
                    const algorithmScore = this.calculateAlgorithmScore(views, engagementRate, durations);
                    
                    // CTR ë° AVD ì •êµí•œ ì¶”ì •
                    const estimatedCTR = this.estimateAdvancedCTR(avgViews, items.length, engagementRate);
                    const estimatedAVD = this.estimateAdvancedAVD(durations, views, engagementRate);
                    const retentionCurve = this.estimateAdvancedRetentionCurve(durations, views, engagementRate);
                    
                    // ê²½ìŸì‚¬ ì‹¬í™” ë¶„ì„
                    const competitiveAnalysis = this.performDeepCompetitiveAnalysis(items);
                    
                    // í‚¤ì›Œë“œ ì‹¬í™” ë¶„ì„
                    const keywordAnalysis = this.performDeepKeywordAnalysis(items);
                    
                    // ì‹œê°„ëŒ€ ì‹¬í™” ë¶„ì„
                    const timeAnalysis = this.performDeepTimeAnalysis(items);
                    
                    // ì¹´í…Œê³ ë¦¬ ì‹¬í™” ë¶„ì„
                    const categoryAnalysis = this.performDeepCategoryAnalysis(items);
                    
                    // íŠ¸ë Œë“œ ë¶„ì„
                    const trendAnalysis = this.performTrendAnalysis(items);
                    
                    // ì„±ì¥ íŒ¨í„´ ë¶„ì„
                    const growthPattern = this.analyzeGrowthPatterns(items);
                    
                    // ìˆ˜ìµí™” ì ì¬ë ¥ ë¶„ì„
                    const monetizationPotential = this.analyzeMonetizationPotential(items, views, engagementRate);
                    
                    return {
                        basic: { 
                            totalViews, avgViews, maxViews, minViews, medianViews, 
                            engagementRate, viewVelocity, viralPotential, contentQuality, algorithmScore 
                        },
                        advanced: { 
                            estimatedCTR, estimatedAVD, retentionCurve,
                            engagementRate, viewVelocity, viralPotential, contentQuality, algorithmScore
                        },
                        competitive: competitiveAnalysis,
                        keywords: keywordAnalysis,
                        timing: timeAnalysis,
                        categories: categoryAnalysis,
                        trends: trendAnalysis,
                        growth: growthPattern,
                        monetization: monetizationPotential,
                        items: items
                    };
                } catch (error) {
                    console.error('âŒ ê³ ê¸‰ ë¶„ì„ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                    return this.getDefaultAnalysis(items);
                }
            }

            // ===== ì „ë¬¸ê°€ ìˆ˜ì¤€ ë¶„ì„ ë©”ì„œë“œë“¤ =====
            
            calculateMedian(numbers) {
                const sorted = [...numbers].sort((a, b) => a - b);
                const mid = Math.floor(sorted.length / 2);
                return sorted.length % 2 !== 0 ? sorted[mid] : (sorted[mid - 1] + sorted[mid]) / 2;
            }

            calculateAdvancedEngagementRate(views, likes, comments) {
                const totalViews = views.reduce((a, b) => a + b, 0);
                const totalLikes = likes.reduce((a, b) => a + b, 0);
                const totalComments = comments.reduce((a, b) => a + b, 0);
                
                if (totalViews === 0) return 0;
                
                // ê°€ì¤‘ì¹˜ ì ìš©: ì¢‹ì•„ìš” 1ì , ëŒ“ê¸€ 3ì , ê³µìœ  5ì  (ê³µìœ ëŠ” ì¶”ì •)
                const estimatedShares = Math.floor(totalLikes * 0.1); // ì¢‹ì•„ìš”ì˜ 10%ê°€ ê³µìœ í•œë‹¤ê³  ê°€ì •
                const weightedEngagement = totalLikes + (totalComments * 3) + (estimatedShares * 5);
                
                return (weightedEngagement / totalViews * 100).toFixed(2);
            }

            calculateViewVelocity(items) {
                const now = new Date();
                const velocities = items.map(item => {
                    const publishDate = new Date(item.snippet?.publishedAt);
                    const daysSincePublish = (now - publishDate) / (1000 * 60 * 60 * 24);
                    const views = parseInt(item.statistics?.viewCount || 0);
                    return daysSincePublish > 0 ? views / daysSincePublish : 0;
                });
                
                return velocities.reduce((a, b) => a + b, 0) / velocities.length;
            }

            calculateViralPotential(views, engagementRate, durations) {
                const avgViews = views.reduce((a, b) => a + b, 0) / views.length;
                const avgDuration = durations.reduce((a, b) => a + b, 0) / durations.length;
                
                // ë°”ì´ëŸ´ ì ì¬ë ¥ ì ìˆ˜ (0-100)
                const viewScore = Math.min(avgViews / 10000, 100); // 1ë§Œ ì¡°íšŒìˆ˜ë‹¹ 1ì , ìµœëŒ€ 100ì 
                const engagementScore = Math.min(engagementRate * 10, 100); // ì°¸ì—¬ìœ¨ * 10, ìµœëŒ€ 100ì 
                const durationScore = avgDuration > 0 ? Math.min(avgDuration / 60 * 20, 100) : 0; // 1ë¶„ë‹¹ 20ì , ìµœëŒ€ 100ì 
                
                return ((viewScore + engagementScore + durationScore) / 3).toFixed(1);
            }

            calculateContentQualityScore(items) {
                // ì½˜í…ì¸  í’ˆì§ˆ ì ìˆ˜ ê³„ì‚° (ì œëª©, ì„¤ëª…, íƒœê·¸ ê¸°ë°˜)
                let totalScore = 0;
                
                items.forEach(item => {
                    let itemScore = 0;
                    const title = item.snippet?.title || '';
                    const description = item.snippet?.description || '';
                    const tags = item.snippet?.tags || [];
                    
                    // ì œëª© í’ˆì§ˆ (ê¸¸ì´, í‚¤ì›Œë“œ ë°€ë„, ê°ì •ì  ì–´í•„)
                    if (title.length >= 30 && title.length <= 60) itemScore += 20;
                    if (title.includes('!') || title.includes('?')) itemScore += 10;
                    if (title.match(/\d+/)) itemScore += 10; // ìˆ«ì í¬í•¨
                    
                    // ì„¤ëª… í’ˆì§ˆ
                    if (description.length >= 200) itemScore += 20;
                    if (description.includes('íƒ€ì„ë¼ì¸') || description.includes('00:')) itemScore += 15;
                    if (description.includes('#')) itemScore += 10;
                    
                    // íƒœê·¸ í’ˆì§ˆ
                    if (tags.length >= 5 && tags.length <= 15) itemScore += 15;
                    
                    totalScore += itemScore;
                });
                
                return Math.min(totalScore / items.length, 100).toFixed(1);
            }

            calculateAlgorithmScore(views, engagementRate, durations) {
                // YouTube ì•Œê³ ë¦¬ì¦˜ ì ìˆ˜ ì¶”ì •
                const avgViews = views.reduce((a, b) => a + b, 0) / views.length;
                const avgDuration = durations.reduce((a, b) => a + b, 0) / durations.length;
                
                let score = 0;
                
                // ì¡°íšŒìˆ˜ ì ìˆ˜ (40%)
                if (avgViews > 1000000) score += 40;
                else if (avgViews > 500000) score += 35;
                else if (avgViews > 100000) score += 30;
                else if (avgViews > 50000) score += 25;
                else if (avgViews > 10000) score += 20;
                else score += 10;
                
                // ì°¸ì—¬ìœ¨ ì ìˆ˜ (30%)
                if (engagementRate > 5) score += 30;
                else if (engagementRate > 3) score += 25;
                else if (engagementRate > 2) score += 20;
                else if (engagementRate > 1) score += 15;
                else score += 10;
                
                // ì‹œì²­ ì‹œê°„ ì ìˆ˜ (30%)
                if (avgDuration > 600) score += 30; // 10ë¶„ ì´ìƒ
                else if (avgDuration > 300) score += 25; // 5ë¶„ ì´ìƒ
                else if (avgDuration > 120) score += 20; // 2ë¶„ ì´ìƒ
                else if (avgDuration > 60) score += 15; // 1ë¶„ ì´ìƒ
                else score += 10;
                
                return Math.min(score, 100);
            }

            estimateAdvancedCTR(avgViews, itemCount, engagementRate) {
                // ê³ ê¸‰ CTR ì¶”ì • (ì¡°íšŒìˆ˜, ì°¸ì—¬ìœ¨, ê²½ìŸë„ ê³ ë ¤)
                let baseCTR = 2.0; // ê¸°ë³¸ CTR
                
                // ì¡°íšŒìˆ˜ ê¸°ë°˜ ì¡°ì •
                if (avgViews > 1000000) baseCTR += 3.0;
                else if (avgViews > 500000) baseCTR += 2.0;
                else if (avgViews > 100000) baseCTR += 1.0;
                else if (avgViews > 50000) baseCTR += 0.5;
                
                // ì°¸ì—¬ìœ¨ ê¸°ë°˜ ì¡°ì •
                if (engagementRate > 5) baseCTR += 2.0;
                else if (engagementRate > 3) baseCTR += 1.0;
                else if (engagementRate < 1) baseCTR -= 1.0;
                
                // ê²½ìŸë„ ê¸°ë°˜ ì¡°ì • (ì•„ì´í…œ ìˆ˜ê°€ ë§ì„ìˆ˜ë¡ CTR ë‚®ì•„ì§)
                if (itemCount > 50) baseCTR -= 1.0;
                else if (itemCount > 20) baseCTR -= 0.5;
                
                return Math.max(baseCTR, 0.5).toFixed(2);
            }

            estimateAdvancedAVD(durations, views, engagementRate) {
                if (durations.length === 0) return 0;
                
                const avgDuration = durations.reduce((a, b) => a + b, 0) / durations.length;
                const avgViews = views.reduce((a, b) => a + b, 0) / views.length;
                
                let retentionRate = 0.5; // ê¸°ë³¸ 50%
                
                // ì¡°íšŒìˆ˜ ê¸°ë°˜ ì¡°ì •
                if (avgViews > 1000000) retentionRate = 0.75;
                else if (avgViews > 500000) retentionRate = 0.65;
                else if (avgViews > 100000) retentionRate = 0.55;
                else if (avgViews > 50000) retentionRate = 0.45;
                else retentionRate = 0.35;
                
                // ì°¸ì—¬ìœ¨ ê¸°ë°˜ ì¡°ì •
                if (engagementRate > 5) retentionRate += 0.1;
                else if (engagementRate > 3) retentionRate += 0.05;
                else if (engagementRate < 1) retentionRate -= 0.1;
                
                return Math.max(avgDuration * retentionRate, 0).toFixed(0);
            }

            estimateAdvancedRetentionCurve(durations, views, engagementRate) {
                const avgDuration = durations.reduce((a, b) => a + b, 0) / durations.length;
                const avgViews = views.reduce((a, b) => a + b, 0) / views.length;
                
                // ê¸°ë³¸ retention curve
                let curve = {
                    '0-15ì´ˆ': 85,
                    '15-30ì´ˆ': 72,
                    '30-60ì´ˆ': 58,
                    '1-2ë¶„': 45,
                    '2-5ë¶„': 32,
                    '5ë¶„+': 18
                };
                
                // ì¡°íšŒìˆ˜ì™€ ì°¸ì—¬ìœ¨ì— ë”°ë¥¸ ì¡°ì •
                const adjustment = avgViews > 100000 ? 5 : avgViews > 50000 ? 2 : 0;
                const engagementAdjustment = engagementRate > 3 ? 3 : engagementRate > 1 ? 1 : -2;
                
                Object.keys(curve).forEach(key => {
                    curve[key] = Math.max(0, Math.min(100, curve[key] + adjustment + engagementAdjustment));
                });
                
                return curve;
            }

            // ===== ì „ë¬¸ê°€ ìˆ˜ì¤€ ì»¨ì„¤íŒ… ë¦¬í¬íŠ¸ ìƒì„± ë©”ì„œë“œë“¤ =====
            
            generateDataAnalysisReport(analysis) {
                const { basic, advanced } = analysis;
                
                return {
                    title: "ğŸ“Š ë°ì´í„° ë¶„ì„ ì „ë¬¸ê°€ ë¦¬í¬íŠ¸",
                    summary: `ì„ íƒëœ ${analysis.items.length}ê°œ ì˜ìƒì˜ ì¢…í•© ë¶„ì„ ê²°ê³¼`,
                    keyMetrics: {
                        avgViews: formatNumber(basic.avgViews),
                        engagementRate: `${basic.engagementRate}%`,
                        viralPotential: `${basic.viralPotential}/100`,
                        algorithmScore: `${basic.algorithmScore}/100`,
                        estimatedCTR: `${advanced.estimatedCTR}%`,
                        estimatedAVD: `${advanced.estimatedAVD}ì´ˆ`
                    },
                    insights: [
                        `í‰ê·  ì¡°íšŒìˆ˜ ${formatNumber(basic.avgViews)}íšŒë¡œ ${basic.avgViews > 100000 ? 'ìš°ìˆ˜í•œ' : 'ê°œì„ ì´ í•„ìš”í•œ'} ì„±ê³¼`,
                        `ì°¸ì—¬ìœ¨ ${basic.engagementRate}%ëŠ” ${basic.engagementRate > 3 ? 'ì—…ê³„ í‰ê·  ì´ìƒ' : 'ì—…ê³„ í‰ê·  ì´í•˜'}`,
                        `ë°”ì´ëŸ´ ì ì¬ë ¥ ${basic.viralPotential}ì ìœ¼ë¡œ ${basic.viralPotential > 70 ? 'ë†’ì€' : 'ë³´í†µ'} í™•ì‚° ê°€ëŠ¥ì„±`,
                        `ì•Œê³ ë¦¬ì¦˜ ì ìˆ˜ ${basic.algorithmScore}ì ìœ¼ë¡œ ${basic.algorithmScore > 70 ? 'ìš°ìˆ˜í•œ' : 'ê°œì„  í•„ìš”'}í•œ ìµœì í™” ìƒíƒœ`
                    ],
                    recommendations: [
                        basic.engagementRate < 3 ? "ì°¸ì—¬ìœ¨ ê°œì„ ì„ ìœ„í•œ ì½˜í…ì¸  ì „ëµ ìˆ˜ì • í•„ìš”" : "í˜„ì¬ ì°¸ì—¬ìœ¨ ìœ ì§€ ë° í–¥ìƒ",
                        basic.viralPotential < 50 ? "ë°”ì´ëŸ´ ìš”ì†Œ ê°•í™”ë¥¼ ìœ„í•œ íŠ¸ë Œë“œ í‚¤ì›Œë“œ í™œìš©" : "ë°”ì´ëŸ´ ìš”ì†Œë¥¼ ë”ìš± ê°•í™”",
                        basic.algorithmScore < 60 ? "ì•Œê³ ë¦¬ì¦˜ ìµœì í™”ë¥¼ ìœ„í•œ ì‹œì²­ ì‹œê°„ ì—°ì¥ ì „ëµ" : "ì•Œê³ ë¦¬ì¦˜ ì¹œí™”ì  ì½˜í…ì¸  ì œì‘ ì§€ì†"
                    ]
                };
            }

            generateContentStrategyReport(analysis, items) {
                const { basic, keywords } = analysis;
                
                return {
                    title: "ğŸ¯ ì½˜í…ì¸  ì „ëµ ì „ë¬¸ê°€ ë¦¬í¬íŠ¸",
                    summary: "100ë§Œ ì¡°íšŒìˆ˜ ë‹¬ì„±ì„ ìœ„í•œ ì½˜í…ì¸  ì „ëµ",
                    currentState: {
                        strengths: this.identifyContentStrengths(items),
                        weaknesses: this.identifyContentWeaknesses(items),
                        opportunities: this.identifyContentOpportunities(items, keywords)
                    },
                    strategy: {
                        titleOptimization: this.generateTitleStrategy(keywords, basic),
                        descriptionOptimization: this.generateDescriptionStrategy(keywords, basic),
                        contentGaps: this.identifyContentGaps(items, keywords),
                        trendingTopics: this.identifyTrendingTopics(keywords)
                    },
                    actionPlan: [
                        "1ì£¼ì°¨: ì œëª© ìµœì í™” ë° í‚¤ì›Œë“œ ë°€ë„ ì¡°ì •",
                        "2ì£¼ì°¨: ì„¤ëª…ë€ SEO ìµœì í™” ë° íƒ€ì„ë¼ì¸ ì¶”ê°€",
                        "3ì£¼ì°¨: íŠ¸ë Œë“œ í‚¤ì›Œë“œ ê¸°ë°˜ ì½˜í…ì¸  ê¸°íš",
                        "4ì£¼ì°¨: ê²½ìŸì‚¬ ì°¨ë³„í™” ìš”ì†Œ ë„ì…"
                    ]
                };
            }

            analyzeCompetition(items) {
                const categories = {};
                const channels = {};
                const publishDates = [];
                
                items.forEach(item => {
                    const category = item.snippet?.categoryId || 'unknown';
                    const channel = item.snippet?.channelTitle || 'unknown';
                    const publishDate = new Date(item.snippet?.publishedAt);
                    
                    categories[category] = (categories[category] || 0) + 1;
                    channels[channel] = (channels[channel] || 0) + 1;
                    publishDates.push(publishDate);
                });
                
                return {
                    topCategories: Object.entries(categories).sort((a,b)=>b[1]-a[1]).slice(0,3),
                    topChannels: Object.entries(channels).sort((a,b)=>b[1]-a[1]).slice(0,5),
                    publishFrequency: this.calculatePublishFrequency(publishDates),
                    marketSaturation: this.calculateMarketSaturation(categories)
                };
            }

            // ===== ì „ë¬¸ê°€ ìˆ˜ì¤€ ë¶„ì„ ë©”ì„œë“œë“¤ (ê³„ì†) =====
            
            performDeepCompetitiveAnalysis(items) {
                const categories = {};
                const channels = {};
                const publishDates = [];
                const viewRanges = { low: 0, medium: 0, high: 0, viral: 0 };
                
                items.forEach(item => {
                    const category = item.snippet?.categoryId || 'unknown';
                    const channel = item.snippet?.channelTitle || 'unknown';
                    const publishDate = new Date(item.snippet?.publishedAt);
                    const views = parseInt(item.statistics?.viewCount || 0);
                    
                    categories[category] = (categories[category] || 0) + 1;
                    channels[channel] = (channels[channel] || 0) + 1;
                    publishDates.push(publishDate);
                    
                    // ì¡°íšŒìˆ˜ ë²”ìœ„ ë¶„ë¥˜
                    if (views > 1000000) viewRanges.viral++;
                    else if (views > 100000) viewRanges.high++;
                    else if (views > 10000) viewRanges.medium++;
                    else viewRanges.low++;
                });
                
                return {
                    topCategories: Object.entries(categories).sort((a,b)=>b[1]-a[1]).slice(0,5),
                    topChannels: Object.entries(channels).sort((a,b)=>b[1]-a[1]).slice(0,10),
                    publishFrequency: this.calculatePublishFrequency(publishDates),
                    marketSaturation: this.calculateMarketSaturation(categories),
                    viewDistribution: viewRanges,
                    competitiveIntensity: this.calculateCompetitiveIntensity(categories, channels),
                    marketOpportunities: this.identifyMarketOpportunities(categories, viewRanges)
                };
            }

            performDeepKeywordAnalysis(items) {
                const allTitles = items.map(item => item.snippet?.title || '').join(' ');
                const allDescriptions = items.map(item => item.snippet?.description || '').join(' ');
                const allTags = items.flatMap(item => item.snippet?.tags || []);
                
                // ê³ ê¸‰ í‚¤ì›Œë“œ ë¶„ì„
                const titleKeywords = this.extractAdvancedKeywords(allTitles);
                const descriptionKeywords = this.extractAdvancedKeywords(allDescriptions);
                const tagKeywords = this.analyzeAdvancedTagFrequency(allTags);
                
                return {
                    titleKeywords: titleKeywords.slice(0, 15),
                    descriptionKeywords: descriptionKeywords.slice(0, 20),
                    tagKeywords: tagKeywords.slice(0, 25),
                    keywordDensity: this.calculateAdvancedKeywordDensity(titleKeywords, allTitles),
                    trendingKeywords: this.identifyAdvancedTrendingKeywords(titleKeywords, descriptionKeywords),
                    keywordCompetition: this.analyzeKeywordCompetition(titleKeywords),
                    longTailKeywords: this.generateLongTailKeywords(titleKeywords),
                    semanticKeywords: this.generateSemanticKeywords(titleKeywords)
                };
            }

            performDeepTimeAnalysis(items) {
                const publishTimes = items.map(item => {
                    const date = new Date(item.snippet?.publishedAt);
                    return {
                        hour: date.getHours(),
                        day: date.getDay(),
                        month: date.getMonth(),
                        views: parseInt(item.statistics?.viewCount || 0),
                        engagement: this.calculateItemEngagement(item)
                    };
                });
                
                const hourPerformance = {};
                const dayPerformance = {};
                const monthPerformance = {};
                
                publishTimes.forEach(time => {
                    if (!hourPerformance[time.hour]) {
                        hourPerformance[time.hour] = { count: 0, totalViews: 0, totalEngagement: 0 };
                    }
                    hourPerformance[time.hour].count++;
                    hourPerformance[time.hour].totalViews += time.views;
                    hourPerformance[time.hour].totalEngagement += time.engagement;
                    
                    if (!dayPerformance[time.day]) {
                        dayPerformance[time.day] = { count: 0, totalViews: 0, totalEngagement: 0 };
                    }
                    dayPerformance[time.day].count++;
                    dayPerformance[time.day].totalViews += time.views;
                    dayPerformance[time.day].totalEngagement += time.engagement;
                    
                    if (!monthPerformance[time.month]) {
                        monthPerformance[time.month] = { count: 0, totalViews: 0, totalEngagement: 0 };
                    }
                    monthPerformance[time.month].count++;
                    monthPerformance[time.month].totalViews += time.views;
                    monthPerformance[time.month].totalEngagement += time.engagement;
                });
                
                return {
                    bestHours: this.calculateOptimalHours(hourPerformance),
                    bestDays: this.calculateOptimalDays(dayPerformance),
                    bestMonths: this.calculateOptimalMonths(monthPerformance),
                    optimalPublishTime: this.calculateOptimalPublishTime(hourPerformance, dayPerformance),
                    seasonalTrends: this.analyzeSeasonalTrends(monthPerformance),
                    timeZoneOptimization: this.analyzeTimeZoneOptimization(hourPerformance)
                };
            }

            performDeepCategoryAnalysis(items) {
                const categoryStats = {};
                
                items.forEach(item => {
                    const category = item.snippet?.categoryId || 'unknown';
                    const views = parseInt(item.statistics?.viewCount || 0);
                    const likes = parseInt(item.statistics?.likeCount || 0);
                    const comments = parseInt(item.statistics?.commentCount || 0);
                    const duration = parseDuration(item.contentDetails?.duration || 'PT0S');
                    
                    if (!categoryStats[category]) {
                        categoryStats[category] = {
                            count: 0,
                            totalViews: 0,
                            totalLikes: 0,
                            totalComments: 0,
                            totalDuration: 0,
                            avgViews: 0,
                            avgEngagement: 0,
                            avgDuration: 0,
                            performance: 0
                        };
                    }
                    
                    categoryStats[category].count++;
                    categoryStats[category].totalViews += views;
                    categoryStats[category].totalLikes += likes;
                    categoryStats[category].totalComments += comments;
                    categoryStats[category].totalDuration += duration;
                });
                
                // í‰ê· ê°’ ê³„ì‚° ë° ì„±ëŠ¥ ì ìˆ˜ ì‚°ì¶œ
                Object.keys(categoryStats).forEach(category => {
                    const stats = categoryStats[category];
                    stats.avgViews = stats.totalViews / stats.count;
                    stats.avgEngagement = ((stats.totalLikes + stats.totalComments) / stats.totalViews * 100);
                    stats.avgDuration = stats.totalDuration / stats.count;
                    stats.performance = this.calculateCategoryPerformance(stats);
                });
                
                return {
                    categoryPerformance: Object.entries(categoryStats).sort((a,b)=>b[1].performance-a[1].performance),
                    topPerformingCategories: Object.entries(categoryStats).sort((a,b)=>b[1].avgViews-a[1].avgViews).slice(0,5),
                    categoryOpportunities: this.identifyCategoryOpportunities(categoryStats),
                    categoryTrends: this.analyzeCategoryTrends(categoryStats)
                };
            }

            performTrendAnalysis(items) {
                const trends = {
                    rising: [],
                    stable: [],
                    declining: [],
                    seasonal: [],
                    viral: []
                };
                
                // íŠ¸ë Œë“œ ë¶„ì„ ë¡œì§
                items.forEach(item => {
                    const views = parseInt(item.statistics?.viewCount || 0);
                    const publishDate = new Date(item.snippet?.publishedAt);
                    const daysSincePublish = (new Date() - publishDate) / (1000 * 60 * 60 * 24);
                    const viewVelocity = views / daysSincePublish;
                    
                    if (viewVelocity > 1000) trends.rising.push(item);
                    else if (viewVelocity > 100) trends.stable.push(item);
                    else trends.declining.push(item);
                    
                    if (views > 1000000) trends.viral.push(item);
                });
                
                return {
                    trendCategories: trends,
                    trendingKeywords: this.extractTrendingKeywords(items),
                    seasonalPatterns: this.analyzeSeasonalPatterns(items),
                    viralFactors: this.analyzeViralFactors(trends.viral),
                    trendPredictions: this.predictTrends(items)
                };
            }

            analyzeGrowthPatterns(items) {
                const patterns = {
                    exponential: [],
                    linear: [],
                    plateau: [],
                    declining: []
                };
                
                // ì„±ì¥ íŒ¨í„´ ë¶„ì„
                items.forEach(item => {
                    const views = parseInt(item.statistics?.viewCount || 0);
                    const publishDate = new Date(item.snippet?.publishedAt);
                    const daysSincePublish = (new Date() - publishDate) / (1000 * 60 * 60 * 24);
                    const growthRate = views / daysSincePublish;
                    
                    if (growthRate > 500) patterns.exponential.push(item);
                    else if (growthRate > 100) patterns.linear.push(item);
                    else if (growthRate > 50) patterns.plateau.push(item);
                    else patterns.declining.push(item);
                });
                
                return {
                    growthPatterns: patterns,
                    growthFactors: this.identifyGrowthFactors(patterns),
                    growthBarriers: this.identifyGrowthBarriers(patterns),
                    growthAccelerators: this.identifyGrowthAccelerators(patterns)
                };
            }

            analyzeMonetizationPotential(items, views, engagementRate) {
                const totalViews = views.reduce((a, b) => a + b, 0);
                const avgViews = totalViews / views.length;
                
                return {
                    adRevenue: {
                        potential: Math.floor(avgViews * 0.5), // 1000ë·°ë‹¹ $0.5 ì¶”ì •
                        optimization: this.optimizeAdRevenue(avgViews, engagementRate)
                    },
                    sponsorships: {
                        potential: this.calculateSponsorshipPotential(avgViews, engagementRate),
                        pricing: this.calculateSponsorshipPricing(avgViews, engagementRate)
                    },
                    merchandise: {
                        potential: this.calculateMerchandisePotential(avgViews, engagementRate),
                        products: this.suggestMerchandiseProducts(avgViews, engagementRate)
                    },
                    courses: {
                        potential: this.calculateCoursePotential(avgViews, engagementRate),
                        topics: this.suggestCourseTopics(avgViews, engagementRate)
                    }
                };
            }

            analyzeKeywords(items) {
                const allTitles = items.map(item => item.snippet?.title || '').join(' ');
                const allDescriptions = items.map(item => item.snippet?.description || '').join(' ');
                const allTags = items.flatMap(item => item.snippet?.tags || []);
                
                // í‚¤ì›Œë“œ ì¶”ì¶œ ë° ë¹ˆë„ ë¶„ì„
                const titleKeywords = this.extractKeywords(allTitles);
                const descriptionKeywords = this.extractKeywords(allDescriptions);
                const tagKeywords = this.analyzeTagFrequency(allTags);
                
                return {
                    titleKeywords: titleKeywords.slice(0, 10),
                    descriptionKeywords: descriptionKeywords.slice(0, 15),
                    tagKeywords: tagKeywords.slice(0, 20),
                    keywordDensity: this.calculateKeywordDensity(titleKeywords, allTitles),
                    trendingKeywords: this.identifyTrendingKeywords(titleKeywords, descriptionKeywords)
                };
            }

            // ===== ì „ë¬¸ê°€ ìˆ˜ì¤€ ì»¨ì„¤íŒ… ë©”ì„œë“œë“¤ =====
            
            identifyContentStrengths(items) {
                const strengths = [];
                const avgViews = items.reduce((sum, item) => sum + parseInt(item.statistics?.viewCount || 0), 0) / items.length;
                const avgEngagement = this.calculateAverageEngagement(items);
                
                if (avgViews > 100000) strengths.push("ë†’ì€ í‰ê·  ì¡°íšŒìˆ˜ë¡œ ì½˜í…ì¸  í’ˆì§ˆì´ ìš°ìˆ˜í•¨");
                if (avgEngagement > 3) strengths.push("ê°•í•œ ì°¸ì—¬ìœ¨ë¡œ ì‹œì²­ì ëª°ì…ë„ê°€ ë†’ìŒ");
                if (items.some(item => item.snippet?.title?.length > 30)) strengths.push("SEO ì¹œí™”ì ì¸ ì œëª© êµ¬ì¡°");
                if (items.some(item => item.snippet?.description?.length > 200)) strengths.push("ìƒì„¸í•œ ì„¤ëª…ìœ¼ë¡œ ê²€ìƒ‰ ìµœì í™”");
                
                return strengths.length > 0 ? strengths : ["ê¸°ë³¸ì ì¸ ì½˜í…ì¸  êµ¬ì¡°ëŠ” ì–‘í˜¸í•¨"];
            }

            identifyContentWeaknesses(items) {
                const weaknesses = [];
                const avgViews = items.reduce((sum, item) => sum + parseInt(item.statistics?.viewCount || 0), 0) / items.length;
                const avgEngagement = this.calculateAverageEngagement(items);
                
                if (avgViews < 10000) weaknesses.push("ì¡°íšŒìˆ˜ ê°œì„ ì´ í•„ìš”í•œ ìƒíƒœ");
                if (avgEngagement < 2) weaknesses.push("ì°¸ì—¬ìœ¨ í–¥ìƒì´ ì‹œê¸‰í•¨");
                if (items.some(item => !item.snippet?.tags || item.snippet.tags.length < 5)) weaknesses.push("íƒœê·¸ í™œìš©ë„ê°€ ë‚®ìŒ");
                if (items.some(item => !item.snippet?.description || item.snippet.description.length < 100)) weaknesses.push("ì„¤ëª…ë€ ìµœì í™” ë¶€ì¡±");
                
                return weaknesses.length > 0 ? weaknesses : ["ì „ë°˜ì ì¸ ê°œì„  ì—¬ì§€ê°€ ìˆìŒ"];
            }

            identifyContentOpportunities(items, keywords) {
                const opportunities = [];
                
                if (keywords.titleKeywords.length > 0) opportunities.push("íŠ¸ë Œë“œ í‚¤ì›Œë“œ í™œìš©ìœ¼ë¡œ ê²€ìƒ‰ ë…¸ì¶œ í™•ëŒ€ ê°€ëŠ¥");
                if (items.some(item => item.snippet?.title?.includes('!'))) opportunities.push("ê°ì •ì  ì–´í•„ ìš”ì†Œ ê°•í™” ê°€ëŠ¥");
                if (items.some(item => item.snippet?.description?.includes('íƒ€ì„ë¼ì¸'))) opportunities.push("êµ¬ì¡°í™”ëœ ì½˜í…ì¸ ë¡œ ì‹œì²­ì ê²½í—˜ ê°œì„ ");
                
                return opportunities.length > 0 ? opportunities : ["ë‹¤ì–‘í•œ ê¸°íšŒ ìš”ì†Œ ë°œêµ´ ê°€ëŠ¥"];
            }

            generateTitleStrategy(keywords, basic) {
                const strategies = [];
                
                if (keywords.titleKeywords.length > 0) {
                    strategies.push(`í•µì‹¬ í‚¤ì›Œë“œ "${keywords.titleKeywords[0]}"ë¥¼ ì œëª© ì•ìª½ì— ë°°ì¹˜`);
                }
                
                if (basic.avgViews < 50000) {
                    strategies.push("ê°ì •ì  ì–´í•„ ìš”ì†Œ(!, ?, ìˆ«ì) í™œìš©ìœ¼ë¡œ í´ë¦­ë¥  í–¥ìƒ");
                }
                
                strategies.push("ì œëª© ê¸¸ì´ 30-60ìë¡œ ìµœì í™”í•˜ì—¬ ëª¨ë°”ì¼ì—ì„œ ì™„ì „ í‘œì‹œ");
                strategies.push("ê²½ìŸì‚¬ì™€ ì°¨ë³„í™”ëœ ë…íŠ¹í•œ í¬ì§€ì…”ë‹ ê°•ì¡°");
                
                return strategies;
            }

            generateDescriptionStrategy(keywords, basic) {
                const strategies = [];
                
                strategies.push("ì²« 125ìì— í•µì‹¬ í‚¤ì›Œë“œì™€ ê°€ì¹˜ ì œì•ˆ ëª…ì‹œ");
                strategies.push("íƒ€ì„ë¼ì¸ êµ¬ì¡°ë¡œ ì‹œì²­ì í¸ì˜ì„± ì œê³µ");
                strategies.push("ê´€ë ¨ í•´ì‹œíƒœê·¸ 3-5ê°œë¡œ ê²€ìƒ‰ ë…¸ì¶œ í™•ëŒ€");
                strategies.push("ëŒ“ê¸€ ìœ ë„ ì§ˆë¬¸ìœ¼ë¡œ ì°¸ì—¬ìœ¨ ì¦ëŒ€");
                
                return strategies;
            }

            identifyContentGaps(items, keywords) {
                const gaps = [];
                
                if (!items.some(item => item.snippet?.title?.includes('ì´ˆë³´ì'))) {
                    gaps.push("ì´ˆë³´ì ëŒ€ìƒ ì½˜í…ì¸  ë¶€ì¡±");
                }
                
                if (!items.some(item => item.snippet?.title?.includes('ì‹¤ì „'))) {
                    gaps.push("ì‹¤ì „ ê°€ì´ë“œ ì½˜í…ì¸  ë¶€ì¡±");
                }
                
                if (!items.some(item => item.snippet?.title?.includes('ë¹„ë²•'))) {
                    gaps.push("ë¹„ë²•/ë…¸í•˜ìš° ì½˜í…ì¸  ë¶€ì¡±");
                }
                
                return gaps.length > 0 ? gaps : ["ë‹¤ì–‘í•œ ì½˜í…ì¸  ìœ í˜• í™•ì¥ ê°€ëŠ¥"];
            }

            identifyTrendingTopics(keywords) {
                const topics = [];
                
                if (keywords.trendingKeywords.length > 0) {
                    topics.push(`"${keywords.trendingKeywords[0]}" ê´€ë ¨ íŠ¸ë Œë“œ ì½˜í…ì¸ `);
                }
                
                topics.push("ì‹œì¦Œë³„ íŠ¸ë Œë“œ í‚¤ì›Œë“œ í™œìš©");
                topics.push("ì‚¬íšŒì  ì´ìŠˆì™€ ì—°ê³„í•œ ì½˜í…ì¸ ");
                topics.push("ì‚¬ìš©ì ê²€ìƒ‰ íŒ¨í„´ ê¸°ë°˜ ì½˜í…ì¸ ");
                
                return topics;
            }

            calculateAverageEngagement(items) {
                let totalEngagement = 0;
                let totalViews = 0;
                
                items.forEach(item => {
                    const views = parseInt(item.statistics?.viewCount || 0);
                    const likes = parseInt(item.statistics?.likeCount || 0);
                    const comments = parseInt(item.statistics?.commentCount || 0);
                    
                    totalViews += views;
                    totalEngagement += likes + comments;
                });
                
                return totalViews > 0 ? (totalEngagement / totalViews * 100) : 0;
            }

            getDefaultAnalysis(items) {
                return {
                    basic: { totalViews: 0, avgViews: 0, maxViews: 0, minViews: 0, medianViews: 0, engagementRate: 0, viewVelocity: 0, viralPotential: 0, contentQuality: 0, algorithmScore: 0 },
                    advanced: { estimatedCTR: 0, estimatedAVD: 0, retentionCurve: {}, engagementRate: 0, viewVelocity: 0, viralPotential: 0, contentQuality: 0, algorithmScore: 0 },
                    competitive: { topCategories: [], topChannels: [], publishFrequency: 'N/A', marketSaturation: '0%', viewDistribution: { low: 0, medium: 0, high: 0, viral: 0 }, competitiveIntensity: 'N/A', marketOpportunities: [] },
                    keywords: { titleKeywords: [], descriptionKeywords: [], tagKeywords: [], keywordDensity: [], trendingKeywords: [], keywordCompetition: [], longTailKeywords: [], semanticKeywords: [] },
                    timing: { bestHours: [], bestDays: [], bestMonths: [], optimalPublishTime: 'N/A', seasonalTrends: {}, timeZoneOptimization: {} },
                    categories: { categoryPerformance: [], topPerformingCategories: [], categoryOpportunities: [], categoryTrends: {} },
                    trends: { trendCategories: { rising: [], stable: [], declining: [], seasonal: [], viral: [] }, trendingKeywords: [], seasonalPatterns: {}, viralFactors: [], trendPredictions: [] },
                    growth: { growthPatterns: { exponential: [], linear: [], plateau: [], declining: [] }, growthFactors: [], growthBarriers: [], growthAccelerators: [] },
                    monetization: { adRevenue: { potential: 0, optimization: [] }, sponsorships: { potential: 0, pricing: 0 }, merchandise: { potential: 0, products: [] }, courses: { potential: 0, topics: [] } },
                    items: items
                };
            }

            analyzePublishTimes(items) {
                const publishTimes = items.map(item => {
                    const date = new Date(item.snippet?.publishedAt);
                    return {
                        hour: date.getHours(),
                        day: date.getDay(),
                        month: date.getMonth()
                    };
                });
                
                const hourDistribution = {};
                const dayDistribution = {};
                
                publishTimes.forEach(time => {
                    hourDistribution[time.hour] = (hourDistribution[time.hour] || 0) + 1;
                    dayDistribution[time.day] = (dayDistribution[time.day] || 0) + 1;
                });
                
                return {
                    bestHours: Object.entries(hourDistribution).sort((a,b)=>b[1]-a[1]).slice(0,3),
                    bestDays: Object.entries(dayDistribution).sort((a,b)=>b[1]-a[1]).slice(0,3),
                    optimalPublishTime: this.calculateOptimalPublishTime(hourDistribution, dayDistribution)
                };
            }

            analyzeCategories(items) {
                const categoryStats = {};
                
                items.forEach(item => {
                    const category = item.snippet?.categoryId || 'unknown';
                    const views = parseInt(item.statistics?.viewCount || 0);
                    const likes = parseInt(item.statistics?.likeCount || 0);
                    const comments = parseInt(item.statistics?.commentCount || 0);
                    
                    if (!categoryStats[category]) {
                        categoryStats[category] = {
                            count: 0,
                            totalViews: 0,
                            totalLikes: 0,
                            totalComments: 0,
                            avgViews: 0,
                            avgEngagement: 0
                        };
                    }
                    
                    categoryStats[category].count++;
                    categoryStats[category].totalViews += views;
                    categoryStats[category].totalLikes += likes;
                    categoryStats[category].totalComments += comments;
                });
                
                // í‰ê·  ê³„ì‚°
                Object.keys(categoryStats).forEach(category => {
                    const stats = categoryStats[category];
                    stats.avgViews = stats.totalViews / stats.count;
                    stats.avgEngagement = stats.totalViews > 0 ? 
                        ((stats.totalLikes + stats.totalComments) / stats.totalViews * 100) : 0;
                });
                
                return categoryStats;
            }

            // ===== ì „ë¬¸ê°€ ìˆ˜ì¤€ ì»¨ì„¤íŒ… ë©”ì„œë“œë“¤ (ê³„ì†) =====
            
            generateStrengthsAnalysis(analysis, items) {
                const strengths = [];
                const { basic, advanced } = analysis;
                
                if (basic.avgViews > 100000) strengths.push("ë†’ì€ í‰ê·  ì¡°íšŒìˆ˜ë¡œ ì½˜í…ì¸  í’ˆì§ˆì´ ìš°ìˆ˜í•¨");
                if (basic.engagementRate > 3) strengths.push("ê°•í•œ ì°¸ì—¬ìœ¨ë¡œ ì‹œì²­ì ëª°ì…ë„ê°€ ë†’ìŒ");
                if (basic.viralPotential > 70) strengths.push("ë†’ì€ ë°”ì´ëŸ´ ì ì¬ë ¥ìœ¼ë¡œ í™•ì‚° ê°€ëŠ¥ì„± í¼");
                if (basic.algorithmScore > 70) strengths.push("ì•Œê³ ë¦¬ì¦˜ ì¹œí™”ì  ì½˜í…ì¸ ë¡œ ë…¸ì¶œ ìš°ìœ„");
                if (advanced.estimatedCTR > 5) strengths.push("ë†’ì€ CTRë¡œ í´ë¦­ ìœ ë„ íš¨ê³¼ ìš°ìˆ˜");
                
                return strengths.length > 0 ? strengths.join(", ") : "ê¸°ë³¸ì ì¸ ì½˜í…ì¸  êµ¬ì¡°ëŠ” ì–‘í˜¸í•¨";
            }

            generateWeaknessesAnalysis(analysis, items) {
                const weaknesses = [];
                const { basic, advanced } = analysis;
                
                if (basic.avgViews < 10000) weaknesses.push("ì¡°íšŒìˆ˜ ê°œì„ ì´ í•„ìš”í•œ ìƒíƒœ");
                if (basic.engagementRate < 2) weaknesses.push("ì°¸ì—¬ìœ¨ í–¥ìƒì´ ì‹œê¸‰í•¨");
                if (basic.viralPotential < 50) weaknesses.push("ë°”ì´ëŸ´ ìš”ì†Œ ë¶€ì¡±ìœ¼ë¡œ í™•ì‚°ë ¥ ì œí•œ");
                if (basic.algorithmScore < 60) weaknesses.push("ì•Œê³ ë¦¬ì¦˜ ìµœì í™” ë¶€ì¡±");
                if (advanced.estimatedCTR < 2) weaknesses.push("ë‚®ì€ CTRë¡œ í´ë¦­ ìœ ë„ ê°œì„  í•„ìš”");
                
                return weaknesses.length > 0 ? weaknesses.join(", ") : "ì „ë°˜ì ì¸ ê°œì„  ì—¬ì§€ê°€ ìˆìŒ";
            }

            generateMasterStrategy(analysis, items) {
                const { basic, advanced, keywords } = analysis;
                const strategies = [];
                
                strategies.push("100ë§Œ ì¡°íšŒìˆ˜ ë‹¬ì„±ì„ ìœ„í•œ ì¢…í•©ì  ì ‘ê·¼");
                strategies.push("ë°ì´í„° ê¸°ë°˜ ì½˜í…ì¸  ìµœì í™” ì „ëµ");
                strategies.push("ê²½ìŸì‚¬ ì°¨ë³„í™”ë¥¼ í†µí•œ ë…ì ì  í¬ì§€ì…”ë‹");
                strategies.push("ì‹œì²­ì ì°¸ì—¬ ê·¹ëŒ€í™”ë¥¼ ìœ„í•œ ìƒí˜¸ì‘ìš© ê°•í™”");
                strategies.push("ì•Œê³ ë¦¬ì¦˜ ì¹œí™”ì  ì½˜í…ì¸  ì œì‘ ì²´ê³„ êµ¬ì¶•");
                
                return strategies.join(" | ");
            }

            generateOptimalTitles(analysis, items) {
                const { keywords } = analysis;
                const titles = [];
                
                if (keywords.titleKeywords.length > 0) {
                    const mainKeyword = keywords.titleKeywords[0];
                    titles.push(`ì¡°íšŒìˆ˜ 100ë§Œ ë‹¬ì„± ë¹„ë²•: ${mainKeyword}ë¡œ 7ì¼ ë§Œì— ê²°ê³¼ ë§Œë“¤ê¸° (ì‹¤ì „ ê°€ì´ë“œ)`);
                    titles.push(`${mainKeyword} ì´ˆë³´ìë„ ë”°ë¼í•  ìˆ˜ ìˆëŠ” 100ë§Œ ì¡°íšŒìˆ˜ ë¹„ë²• ê³µê°œ`);
                    titles.push(`[${mainKeyword}] ì „ë¬¸ê°€ê°€ ì•Œë ¤ì£¼ëŠ” ì¡°íšŒìˆ˜ í­ë°œ ì „ëµ`);
                } else {
                    titles.push("ì¡°íšŒìˆ˜ 100ë§Œ ë‹¬ì„± ë¹„ë²•: [í•µì‹¬ í‚¤ì›Œë“œ]ë¡œ 7ì¼ ë§Œì— ê²°ê³¼ ë§Œë“¤ê¸° (ì‹¤ì „ ê°€ì´ë“œ)");
                    titles.push("[í•µì‹¬ í‚¤ì›Œë“œ] ì´ˆë³´ìë„ ë”°ë¼í•  ìˆ˜ ìˆëŠ” 100ë§Œ ì¡°íšŒìˆ˜ ë¹„ë²• ê³µê°œ");
                    titles.push("[í•µì‹¬ í‚¤ì›Œë“œ] ì „ë¬¸ê°€ê°€ ì•Œë ¤ì£¼ëŠ” ì¡°íšŒìˆ˜ í­ë°œ ì „ëµ");
                }
                
                return titles[0];
            }

            generateOptimalDescriptions(analysis, items) {
                const { keywords } = analysis;
                const mainKeyword = keywords.titleKeywords[0] || "í•µì‹¬ í‚¤ì›Œë“œ";
                
                return `ì´ ì˜ìƒì€ ${mainKeyword} ì£¼ì œë¡œ 100ë§Œ ì¡°íšŒìˆ˜ë¥¼ ëª©í‘œë¡œ ì œì‘ëœ ì‹¤ì „ ê°€ì´ë“œì…ë‹ˆë‹¤.

ğŸ¯ ì´ ì˜ìƒì„ ë³´ë©´ ì–»ì„ ìˆ˜ ìˆëŠ” ê²ƒ:
âœ… ${mainKeyword}ì˜ í•µì‹¬ ì›ë¦¬ ì´í•´
âœ… 7ì¼ ë§Œì— ê²°ê³¼ë¥¼ ë‚´ëŠ” êµ¬ì²´ì  ë°©ë²•
âœ… ì‹¤ì „ì—ì„œ ë°”ë¡œ ì ìš© ê°€ëŠ¥í•œ ë…¸í•˜ìš°
âœ… ê²½ìŸì‚¬ì™€ ì°¨ë³„í™”ëœ ë…ì  ì „ëµ

ğŸ“‹ íƒ€ì„ë¼ì¸
00:00 í›„í‚¹ â€” ì™œ ì§€ê¸ˆ ${mainKeyword}ì¸ê°€
00:20 ì‹¤ì „ ëª©í‘œ/ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸°
01:00 í•µì‹¬ ì „ëµ ìš”ì•½(3ê°€ì§€)
03:00 ë‹¨ê³„ë³„ ì‹¤ìŠµ A
07:00 ë‹¨ê³„ë³„ ì‹¤ìŠµ B
12:00 ìì£¼ í•˜ëŠ” ì‹¤ìˆ˜/í•´ê²°
14:00 ì²´í¬ë¦¬ìŠ¤íŠ¸/í…œí”Œë¦¿ ì œê³µ

ğŸ’¡ ì¶”ê°€ ìë£Œ
- ìƒì„¸ ê°€ì´ë“œ PDF ë‹¤ìš´ë¡œë“œ
- ì‹¤ì „ í…œí”Œë¦¿ ì œê³µ
- 1:1 ìƒë‹´ ë§í¬

#${mainKeyword} #${mainKeyword}ë¹„ë²• #ì¡°íšŒìˆ˜100ë§Œ #ì‹¤ì „ê°€ì´ë“œ #ë…¸í•˜ìš°`;
            }

            generateHookingStrategies(analysis, items) {
                const { keywords } = analysis;
                const mainKeyword = keywords.titleKeywords[0] || "í•µì‹¬ í‚¤ì›Œë“œ";
                
                const hooks = [
                    `"ì§€ê¸ˆë¶€í„° 7ì¼ ì•ˆì— ${mainKeyword}ë¡œ ê²°ê³¼ë¥¼ ë‚´ëŠ” ê°€ì¥ ë¹ ë¥¸ ë°©ë²•ì„ ê³µê°œí•©ë‹ˆë‹¤. ì‹¤íŒ¨í–ˆë˜ ì‚¬ëŒë“¤ë„ ì´ ìˆœì„œëŒ€ë¡œë§Œ í•˜ë©´ ë‹¬ë¼ì§‘ë‹ˆë‹¤."`,
                    `"${mainKeyword}ë¡œ 100ë§Œ ì¡°íšŒìˆ˜ë¥¼ ë‹¬ì„±í•œ ë¹„ë°€ì„ ì²˜ìŒìœ¼ë¡œ ê³µê°œí•©ë‹ˆë‹¤. ì´ ë°©ë²•ì„ ëª¨ë¥´ë©´ í‰ìƒ í›„íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."`,
                    `"${mainKeyword} ì „ë¬¸ê°€ê°€ ì ˆëŒ€ ë§í•˜ì§€ ì•Šì•˜ë˜ ì§„ì§œ ë¹„ë²•ì„ ì§€ê¸ˆ ê³µê°œí•©ë‹ˆë‹¤. 3ë¶„ë§Œ íˆ¬ìí•˜ë©´ ë‹¹ì‹ ì˜ ì¸ìƒì´ ë°”ë€ë‹ˆë‹¤."`
                ];
                
                return hooks[0];
            }

            generateScriptStructures(analysis, items) {
                // ì‹¤ì œ AIë¥¼ í†µí•œ ìŠ¤í¬ë¦½íŠ¸ ìƒì„± (ë¹„ë™ê¸° ì²˜ë¦¬)
                return this.generateAIScriptAsync(analysis, items);
            }

            async generateAIScriptAsync(analysis, items) {
                try {
                    const script = await this.generateAIScript(analysis, items);
                    return script;
                } catch (error) {
                    console.error('ìŠ¤í¬ë¦½íŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
                    return this.getFallbackScript(analysis.keywords.titleKeywords[0] || "í•µì‹¬ í‚¤ì›Œë“œ", false, 300);
                }
            }

            async generateAIScript(analysis, items) {
                try {
                    const { keywords, basic } = analysis;
                    const mainKeyword = keywords.titleKeywords[0] || "í•µì‹¬ í‚¤ì›Œë“œ";
                    const avgDuration = this.calculateAverageDuration(items);
                    const isLongForm = avgDuration > 600; // 10ë¶„ ì´ìƒì´ë©´ ë¡±í¼
                    
                    // AI ìŠ¤í¬ë¦½íŠ¸ ìƒì„± ìš”ì²­
                    const scriptPrompt = this.buildScriptPrompt(mainKeyword, isLongForm, avgDuration, basic);
                    const aiScript = await this.callAIScriptGeneration(scriptPrompt);
                    
                    return aiScript || this.getFallbackScript(mainKeyword, isLongForm, avgDuration);
                } catch (error) {
                    console.error('AI ìŠ¤í¬ë¦½íŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
                    return this.getFallbackScript(analysis.keywords.titleKeywords[0] || "í•µì‹¬ í‚¤ì›Œë“œ", false, 300);
                }
            }

            buildScriptPrompt(mainKeyword, isLongForm, avgDuration, basic) {
                const duration = isLongForm ? "10-15ë¶„" : "3-5ë¶„";
                const format = isLongForm ? "ë¡±í¼" : "ìˆí¼";
                
                return `ë‹¤ìŒ ì¡°ê±´ì— ë§ëŠ” YouTube ${format} ìŠ¤í¬ë¦½íŠ¸ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”:

ì£¼ì œ: ${mainKeyword}
ì˜ìƒ ê¸¸ì´: ${duration}
ëª©í‘œ: ì¡°íšŒìˆ˜ 100ë§Œ ë‹¬ì„±
íƒ€ê²Ÿ: ì´ˆë³´ìë¶€í„° ì „ë¬¸ê°€ê¹Œì§€

ìš”êµ¬ì‚¬í•­:
1. ê°•ë ¥í•œ í›„í‚¹ (ì²« 3ì´ˆ)
2. ëª…í™•í•œ ê°€ì¹˜ ì œì•ˆ
3. ë‹¨ê³„ë³„ ì‹¤ì „ ê°€ì´ë“œ
4. êµ¬ì²´ì  ê²°ê³¼ ì•½ì†
5. ì°¸ì—¬ ìœ ë„ ìš”ì†Œ
6. ì „ë¬¸ì ì´ì§€ë§Œ ì´í•´í•˜ê¸° ì‰¬ìš´ ì„¤ëª…

ìŠ¤í¬ë¦½íŠ¸ êµ¬ì¡°:
- Hook (0:00-0:20)
- Preview (0:20-0:40) 
- Setup (0:40-1:10)
- Core Steps (1:10-${isLongForm ? '12:00' : '4:00'})
- Proof (${isLongForm ? '12:00-13:30' : '4:00-4:30'})
- Pitfalls (${isLongForm ? '13:30-14:30' : '4:30-4:45'})
- CTA (${isLongForm ? '14:30-15:00' : '4:45-5:00'})

ê° ì„¹ì…˜ë³„ë¡œ êµ¬ì²´ì ì¸ ëŒ€ì‚¬ì™€ ì•¡ì…˜ì„ í¬í•¨í•˜ì—¬ ì™„ì „í•œ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”.`;
            }

            async callAIScriptGeneration(prompt) {
                try {
                    // ì‹¤ì œ AI API í˜¸ì¶œ (OpenAI, Claude, Gemini ë“±)
                    const apiKey = localStorage.getItem('ai_api_key');
                    if (!apiKey) {
                        console.log('AI API í‚¤ê°€ ì—†ìŠµë‹ˆë‹¤. ì‹œë®¬ë ˆì´ì…˜ëœ ì‘ë‹µì„ ì‚¬ìš©í•©ë‹ˆë‹¤.');
                        return this.generateSimulatedScript(prompt);
                    }

                    // OpenAI API í˜¸ì¶œ ì˜ˆì‹œ
                    const response = await fetch('https://api.openai.com/v1/chat/completions', {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${apiKey}`,
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            model: 'gpt-4',
                            messages: [
                                {
                                    role: 'system',
                                    content: 'ë‹¹ì‹ ì€ YouTube ìŠ¤í¬ë¦½íŠ¸ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ì¡°íšŒìˆ˜ 100ë§Œì„ ëª©í‘œë¡œ í•˜ëŠ” ê³ í’ˆì§ˆ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”.'
                                },
                                {
                                    role: 'user',
                                    content: prompt
                                }
                            ],
                            max_tokens: 2000,
                            temperature: 0.7
                        })
                    });

                    if (!response.ok) {
                        throw new Error(`AI API ì˜¤ë¥˜: ${response.status}`);
                    }

                    const data = await response.json();
                    return data.choices[0].message.content;
                } catch (error) {
                    console.error('AI API í˜¸ì¶œ ì‹¤íŒ¨:', error);
                    // API ì‹¤íŒ¨ ì‹œ ì‹œë®¬ë ˆì´ì…˜ëœ ì‘ë‹µ ë°˜í™˜
                    return this.generateSimulatedScript(prompt);
                }
            }

            generateSimulatedScript(prompt) {
                // ì‹¤ì œ AI ì‘ë‹µì„ ì‹œë®¬ë ˆì´ì…˜í•œ ê³ í’ˆì§ˆ ìŠ¤í¬ë¦½íŠ¸ ìƒì„±
                const isLongForm = prompt.includes("ë¡±í¼");
                const mainKeyword = prompt.match(/ì£¼ì œ: (.+)/)?.[1] || "í•µì‹¬ í‚¤ì›Œë“œ";
                
                if (isLongForm) {
                    return this.generateLongFormScript(mainKeyword);
                } else {
                    return this.generateShortFormScript(mainKeyword);
                }
            }

            generateLongFormScript(mainKeyword) {
                return `ğŸ¬ ${mainKeyword} ì™„ë²½ ë§ˆìŠ¤í„° ê°€ì´ë“œ - 15ë¶„ ë¡±í¼ ìŠ¤í¬ë¦½íŠ¸

ã€HOOK - 0:00-0:20ã€‘
"ì•ˆë…•í•˜ì„¸ìš”! ì§€ê¸ˆë¶€í„° 15ë¶„ë§Œ íˆ¬ìí•˜ë©´ ${mainKeyword}ì˜ ëª¨ë“  ë¹„ë°€ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
ì´ ì˜ìƒì„ ëê¹Œì§€ ë³´ì‹œë©´ ${mainKeyword}ë¡œ ì›” 1000ë§Œì›ì„ ë²Œ ìˆ˜ ìˆëŠ” êµ¬ì²´ì ì¸ ë°©ë²•ì„ 
ì™„ë²½í•˜ê²Œ ë§ˆìŠ¤í„°í•˜ê²Œ ë©ë‹ˆë‹¤. ì ˆëŒ€ ë†“ì¹˜ì§€ ë§ˆì„¸ìš”!"

ã€PREVIEW - 0:20-0:40ã€‘
"ì˜¤ëŠ˜ ì˜ìƒì—ì„œëŠ” ${mainKeyword}ì˜ í•µì‹¬ 5ë‹¨ê³„, ì‹¤ì œ ì‚¬ë¡€ 3ê°€ì§€, 
í”í•œ ì‹¤ìˆ˜ì™€ í•´ê²°ë²•, ê·¸ë¦¬ê³  ë°”ë¡œ ì ìš© ê°€ëŠ¥í•œ í…œí”Œë¦¿ê¹Œì§€ 
ëª¨ë“  ê²ƒì„ ê³µê°œí•©ë‹ˆë‹¤. ì§€ê¸ˆ ë°”ë¡œ ì‹œì‘í•´ë³´ê² ìŠµë‹ˆë‹¤!"

ã€SETUP - 0:40-1:10ã€‘
"ë¨¼ì € ì¤€ë¹„ë¬¼ì„ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤. 
1) ë…¸íŠ¸ë¶ ë˜ëŠ” ìŠ¤ë§ˆíŠ¸í°
2) ì¸í„°ë„· ì—°ê²°
3) 15ë¶„ì˜ ì§‘ì¤‘ ì‹œê°„
4) ì„±ê³µì— ëŒ€í•œ ê°•í•œ ì˜ì§€

ì´ 4ê°€ì§€ë§Œ ìˆìœ¼ë©´ ì¶©ë¶„í•©ë‹ˆë‹¤. 
${mainKeyword}ëŠ” ìƒê°ë³´ë‹¤ í›¨ì”¬ ê°„ë‹¨í•˜ê³  íš¨ê³¼ì ì…ë‹ˆë‹¤."

ã€CORE STEPS - 1:10-12:00ã€‘

"ì´ì œ ${mainKeyword}ì˜ í•µì‹¬ 5ë‹¨ê³„ë¥¼ ë‹¨ê³„ë³„ë¡œ ì•Œë ¤ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

ã€1ë‹¨ê³„: ê¸°ì´ˆ ì„¤ì • (1:10-3:00)ã€‘
ì²« ë²ˆì§¸, ${mainKeyword}ì˜ ê¸°ë³¸ ì›ë¦¬ë¥¼ ì´í•´í•´ì•¼ í•©ë‹ˆë‹¤.
${mainKeyword}ëŠ” [êµ¬ì²´ì  ì„¤ëª…]ì…ë‹ˆë‹¤.
ì‹¤ì œ í™”ë©´ì„ ë³´ë©´ì„œ ë”°ë¼í•´ë³´ê² ìŠµë‹ˆë‹¤.
[í™”ë©´: ì‹¤ì œ ì‘ì—… ê³¼ì • ì‹œì—°]

ã€2ë‹¨ê³„: ê³ ê¸‰ ê¸°ë²• (3:00-5:30)ã€‘
ë‘ ë²ˆì§¸, ì „ë¬¸ê°€ë§Œ ì•„ëŠ” ê³ ê¸‰ ê¸°ë²•ì„ ì ìš©í•©ë‹ˆë‹¤.
ì´ ë°©ë²•ì„ ëª¨ë¥´ë©´ 90%ì˜ ì‚¬ëŒë“¤ì´ ì‹¤íŒ¨í•©ë‹ˆë‹¤.
[í™”ë©´: ê³ ê¸‰ ê¸°ë²• ì‹œì—°]

ã€3ë‹¨ê³„: ìµœì í™” ì „ëµ (5:30-8:00)ã€‘
ì„¸ ë²ˆì§¸, ê²°ê³¼ë¥¼ ê·¹ëŒ€í™”í•˜ëŠ” ìµœì í™” ì „ëµì…ë‹ˆë‹¤.
ì´ ë‹¨ê³„ì—ì„œ ê²°ê³¼ê°€ 10ë°° ì°¨ì´ë‚©ë‹ˆë‹¤.
[í™”ë©´: ìµœì í™” ê³¼ì • ì‹œì—°]

ã€4ë‹¨ê³„: ë¬¸ì œ í•´ê²° (8:00-10:30)ã€‘
ë„¤ ë²ˆì§¸, ìì£¼ ë°œìƒí•˜ëŠ” ë¬¸ì œë“¤ì„ ë¯¸ë¦¬ í•´ê²°í•©ë‹ˆë‹¤.
ì´ ë¬¸ì œë“¤ì„ í•´ê²°í•˜ë©´ ì„±ê³µë¥ ì´ 95% ì´ìƒì…ë‹ˆë‹¤.
[í™”ë©´: ë¬¸ì œ í•´ê²° ê³¼ì •]

ã€5ë‹¨ê³„: ì§€ì†ì  ì„±ì¥ (10:30-12:00)ã€‘
ë§ˆì§€ë§‰, ì§€ì†ì ìœ¼ë¡œ ì„±ì¥í•˜ëŠ” ì‹œìŠ¤í…œì„ êµ¬ì¶•í•©ë‹ˆë‹¤.
ì´ ì‹œìŠ¤í…œì´ ìˆìœ¼ë©´ í‰ìƒ ìˆ˜ìµì„ ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
[í™”ë©´: ì‹œìŠ¤í…œ êµ¬ì¶• ê³¼ì •]"

ã€PROOF - 12:00-13:30ã€‘
"ì‹¤ì œë¡œ ì´ ë°©ë²•ì„ ì ìš©í•œ ê²°ê³¼ë¥¼ ë³´ì—¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤.
[í™”ë©´: ì‹¤ì œ ì„±ê³¼ ë°ì´í„°]
ë³´ì‹œë‹¤ì‹œí”¼ 30ì¼ ë§Œì— [êµ¬ì²´ì  ìˆ˜ì¹˜]ë¥¼ ë‹¬ì„±í–ˆìŠµë‹ˆë‹¤.
ì´ì œ ì—¬ëŸ¬ë¶„ë„ ê°™ì€ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤."

ã€PITFALLS - 13:30-14:30ã€‘
"í•˜ì§€ë§Œ ì£¼ì˜í•´ì•¼ í•  ì ì´ ìˆìŠµë‹ˆë‹¤.
1) [í”í•œ ì‹¤ìˆ˜ 1] - ì´ë ‡ê²Œ í•˜ë©´ ì•ˆ ë©ë‹ˆë‹¤
2) [í”í•œ ì‹¤ìˆ˜ 2] - ëŒ€ì‹  ì´ë ‡ê²Œ í•˜ì„¸ìš”
3) [í”í•œ ì‹¤ìˆ˜ 3] - ì´ ë°©ë²•ì´ ì •ë‹µì…ë‹ˆë‹¤
ì´ 3ê°€ì§€ë§Œ í”¼í•˜ë©´ ì„±ê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."

ã€CTA - 14:30-15:00ã€‘
"ì§€ê¸ˆ ë°”ë¡œ ì²« ë²ˆì§¸ ë‹¨ê³„ë¥¼ ì‹œì‘í•´ë³´ì„¸ìš”!
ëŒ“ê¸€ë¡œ 'ì‹œì‘í•©ë‹ˆë‹¤'ë¼ê³  ì ì–´ì£¼ì‹œë©´ 
ì¶”ê°€ ìë£Œë¥¼ ë¬´ë£Œë¡œ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.
êµ¬ë…ê³¼ ì¢‹ì•„ìš”ë„ ìŠì§€ ë§ˆì„¸ìš”!
ë‹¤ìŒ ì˜ìƒì—ì„œëŠ” ë” ê³ ê¸‰ ê¸°ë²•ì„ ì•Œë ¤ë“œë¦¬ê² ìŠµë‹ˆë‹¤.
${mainKeyword}ë¡œ ì„±ê³µí•˜ëŠ” ê·¸ë‚ ê¹Œì§€ í•¨ê»˜í•´ìš”!"`;
            }

            generateShortFormScript(mainKeyword) {
                return `ğŸ¬ ${mainKeyword} 5ë¶„ ì™„ì„± ê°€ì´ë“œ - ìˆí¼ ìŠ¤í¬ë¦½íŠ¸

ã€HOOK - 0:00-0:15ã€‘
"${mainKeyword}ë¡œ 5ë¶„ ë§Œì— ê²°ê³¼ë¥¼ ë‚´ëŠ” ë¹„ë²•ì„ ê³µê°œí•©ë‹ˆë‹¤!
ì´ ë°©ë²•ì„ ëª¨ë¥´ë©´ í‰ìƒ í›„íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."

ã€PREVIEW - 0:15-0:30ã€‘
"ì˜¤ëŠ˜ 3ë‹¨ê³„ë§Œ ë”°ë¼í•˜ë©´ ${mainKeyword}ë¥¼ ì™„ë²½í•˜ê²Œ ë§ˆìŠ¤í„°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì§€ê¸ˆ ë°”ë¡œ ì‹œì‘í•´ë³´ê² ìŠµë‹ˆë‹¤!"

ã€SETUP - 0:30-0:45ã€‘
"ì¤€ë¹„ë¬¼ì€ ê°„ë‹¨í•©ë‹ˆë‹¤:
1) ìŠ¤ë§ˆíŠ¸í°
2) 5ë¶„ì˜ ì‹œê°„
3) ì„±ê³µ ì˜ì§€
ì´ì œ ì‹œì‘í•©ë‹ˆë‹¤!"

ã€CORE STEPS - 0:45-4:00ã€‘

"ã€1ë‹¨ê³„: ê¸°ì´ˆ ì„¤ì • (0:45-1:30)ã€‘
ì²« ë²ˆì§¸, ${mainKeyword}ì˜ ê¸°ë³¸ì„ ì„¤ì •í•©ë‹ˆë‹¤.
[í™”ë©´: ë¹ ë¥¸ ì„¤ì • ê³¼ì •]
ì´ë ‡ê²Œ í•˜ë©´ 90% ì™„ì„±ì…ë‹ˆë‹¤.

ã€2ë‹¨ê³„: í•µì‹¬ ì‹¤í–‰ (1:30-3:00)ã€‘
ë‘ ë²ˆì§¸, ê°€ì¥ ì¤‘ìš”í•œ í•µì‹¬ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.
[í™”ë©´: í•µì‹¬ ê³¼ì • ì‹œì—°]
ì´ ë‹¨ê³„ê°€ ì„±ê³µì˜ ì—´ì‡ ì…ë‹ˆë‹¤.

ã€3ë‹¨ê³„: ê²°ê³¼ í™•ì¸ (3:00-4:00)ã€‘
ì„¸ ë²ˆì§¸, ê²°ê³¼ë¥¼ í™•ì¸í•˜ê³  ìµœì í™”í•©ë‹ˆë‹¤.
[í™”ë©´: ê²°ê³¼ í™•ì¸ ê³¼ì •]
ì™„ë²½í•©ë‹ˆë‹¤!"

ã€PROOF - 4:00-4:30ã€‘
"ì‹¤ì œ ê²°ê³¼ë¥¼ ë³´ì—¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤.
[í™”ë©´: ì„±ê³¼ ë°ì´í„°]
5ë¶„ ë§Œì— ì´ ì •ë„ ê²°ê³¼ê°€ ë‚˜ì™”ìŠµë‹ˆë‹¤!"

ã€PITFALLS - 4:30-4:45ã€‘
"ì£¼ì˜ì‚¬í•­: [í•µì‹¬ ì‹¤ìˆ˜ 1ê°œ]
ì´ê²ƒë§Œ í”¼í•˜ë©´ ì„±ê³µì…ë‹ˆë‹¤!"

ã€CTA - 4:45-5:00ã€‘
"ì§€ê¸ˆ ë°”ë¡œ ì‹œì‘í•˜ì„¸ìš”!
ëŒ“ê¸€ë¡œ 'ì„±ê³µí–ˆìŠµë‹ˆë‹¤' ì ì–´ì£¼ì„¸ìš”!
êµ¬ë…ê³¼ ì¢‹ì•„ìš”ë„ ìŠì§€ ë§ˆì„¸ìš”!
${mainKeyword}ë¡œ ì„±ê³µí•˜ì„¸ìš”!"`;
            }

            getFallbackScript(mainKeyword, isLongForm, avgDuration) {
                if (isLongForm) {
                    return this.generateLongFormScript(mainKeyword);
                } else {
                    return this.generateShortFormScript(mainKeyword);
                }
            }

            calculateAverageDuration(items) {
                const durations = items.map(item => parseDuration(item.contentDetails?.duration || 'PT0S')).filter(n => !isNaN(n));
                return durations.length > 0 ? durations.reduce((a, b) => a + b, 0) / durations.length : 300;
            }

            generateVideoStructures(analysis, items) {
                return `- ì˜¤í”„ë‹: 20ì´ˆ ë‚´ ê°•í•œ ë¹„ì£¼ì–¼ê³¼ ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸°
- ë³¸ë¬¸: ë‹¨ê³„ë³„ ì‹œì—° + ì²´í¬ë¦¬ìŠ¤íŠ¸ ì˜¤ë²„ë ˆì´
- B-roll: ì†/í™”ë©´ í´ë¡œì¦ˆì—…, í…ìŠ¤íŠ¸ íŒ
- ì˜¤ë””ì˜¤: ê²½ì¾Œí•œ bpm 100-110, ì „í™˜ë§ˆë‹¤ ë¦¬ë“¬ í¬ì¸íŠ¸
- ìƒ‰ê°: ê³ ëŒ€ë¹„, ë”°ëœ»í•œ í†¤ìœ¼ë¡œ ì‹ ë¢°ê° ì¡°ì„±
- í°íŠ¸: êµµê³  ëª…í™•í•œ sans-serif, ëª¨ë°”ì¼ ìµœì í™”`;
            }

            generateThumbnailPrompts(analysis, items) {
                // ì‹¤ì œ AIë¥¼ í†µí•œ ì¸ë„¤ì¼ í”„ë¡¬í”„íŠ¸ ìƒì„± (ë¹„ë™ê¸° ì²˜ë¦¬)
                return this.generateAIThumbnailPromptAsync(analysis, items);
            }

            async generateAIThumbnailPromptAsync(analysis, items) {
                try {
                    const prompt = await this.generateAIThumbnailPrompt(analysis, items);
                    return prompt;
                } catch (error) {
                    console.error('ì¸ë„¤ì¼ í”„ë¡¬í”„íŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
                    return this.getFallbackThumbnailPrompt(analysis.keywords.titleKeywords[0] || "í•µì‹¬ í‚¤ì›Œë“œ", false);
                }
            }

            async generateAIThumbnailPrompt(analysis, items) {
                try {
                    const { keywords, basic } = analysis;
                    const mainKeyword = keywords.titleKeywords[0] || "í•µì‹¬ í‚¤ì›Œë“œ";
                    const avgViews = basic.avgViews || 0;
                    const isHighPerforming = avgViews > 100000;
                    
                    // AI ì¸ë„¤ì¼ í”„ë¡¬í”„íŠ¸ ìƒì„± ìš”ì²­
                    const promptRequest = this.buildThumbnailPromptRequest(mainKeyword, isHighPerforming, analysis);
                    const aiPrompt = await this.callAIThumbnailGeneration(promptRequest);
                    
                    return aiPrompt || this.getFallbackThumbnailPrompt(mainKeyword, isHighPerforming);
                } catch (error) {
                    console.error('AI ì¸ë„¤ì¼ í”„ë¡¬í”„íŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
                    return this.getFallbackThumbnailPrompt(analysis.keywords.titleKeywords[0] || "í•µì‹¬ í‚¤ì›Œë“œ", false);
                }
            }

            buildThumbnailPromptRequest(mainKeyword, isHighPerforming, analysis) {
                const { basic, keywords } = analysis;
                const engagementRate = basic.engagementRate || 0;
                const viralPotential = basic.viralPotential || 0;
                
                return {
                    mainKeyword: mainKeyword,
                    isHighPerforming: isHighPerforming,
                    engagementRate: engagementRate,
                    viralPotential: viralPotential,
                    trendingKeywords: keywords.trendingKeywords || [],
                    targetAudience: "í•œêµ­ YouTube ì‹œì²­ì",
                    style: isHighPerforming ? "í”„ë¦¬ë¯¸ì—„" : "ì¹œê·¼í•œ",
                    emotion: viralPotential > 70 ? "ê°•ë ¬í•œ" : "ì‹ ë¢°ê° ìˆëŠ”"
                };
            }

            async callAIThumbnailGeneration(request) {
                try {
                    // ì‹¤ì œ AI API í˜¸ì¶œ (DALL-E, Midjourney, Stable Diffusion ë“±)
                    const apiKey = localStorage.getItem('ai_api_key');
                    if (!apiKey) {
                        console.log('AI API í‚¤ê°€ ì—†ìŠµë‹ˆë‹¤. ì‹œë®¬ë ˆì´ì…˜ëœ ì‘ë‹µì„ ì‚¬ìš©í•©ë‹ˆë‹¤.');
                        return this.generateSimulatedThumbnailPrompt(request);
                    }

                    // DALL-E API í˜¸ì¶œ ì˜ˆì‹œ
                    const response = await fetch('https://api.openai.com/v1/images/generations', {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${apiKey}`,
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            model: 'dall-e-3',
                            prompt: this.buildDALLEPrompt(request),
                            n: 1,
                            size: '1024x1024',
                            quality: 'hd',
                            style: 'vivid'
                        })
                    });

                    if (!response.ok) {
                        throw new Error(`AI API ì˜¤ë¥˜: ${response.status}`);
                    }

                    const data = await response.json();
                    const imageUrl = data.data[0].url;
                    
                    // ì´ë¯¸ì§€ URLê³¼ í•¨ê»˜ í”„ë¡¬í”„íŠ¸ ì •ë³´ ë°˜í™˜
                    return this.generateThumbnailPromptWithImage(request, imageUrl);
                } catch (error) {
                    console.error('AI ì¸ë„¤ì¼ API í˜¸ì¶œ ì‹¤íŒ¨:', error);
                    // API ì‹¤íŒ¨ ì‹œ ì‹œë®¬ë ˆì´ì…˜ëœ ì‘ë‹µ ë°˜í™˜
                    return this.generateSimulatedThumbnailPrompt(request);
                }
            }

            buildDALLEPrompt(request) {
                const { mainKeyword, isHighPerforming, emotion } = request;
                
                if (isHighPerforming) {
                    return `Professional YouTube thumbnail for "${mainKeyword}" tutorial. 
                    Confident Korean presenter, high-contrast lighting, 
                    premium colors (gold, navy, white), 
                    bold Korean text "${mainKeyword} ë¹„ë²•", 
                    clean minimalist background, cinematic style, 4K quality`;
                } else {
                    return `Clean YouTube thumbnail for "${mainKeyword}" guide. 
                    Friendly Korean presenter, bright lighting, 
                    warm colors (blue, orange, white), 
                    clear Korean text "${mainKeyword} ê°€ì´ë“œ", 
                    simple background, professional style`;
                }
            }

            generateThumbnailPromptWithImage(request, imageUrl) {
                const { mainKeyword, isHighPerforming } = request;
                
                return `ğŸ¨ AI ìƒì„± ì¸ë„¤ì¼ - ${mainKeyword}

âœ… ì‹¤ì œ AIë¡œ ìƒì„±ëœ ì¸ë„¤ì¼ ì´ë¯¸ì§€:
${imageUrl}

ğŸ“‹ ì‚¬ìš©ëœ í”„ë¡¬í”„íŠ¸:
"${this.buildDALLEPrompt(request)}"

ğŸ¯ ìµœì í™” í¬ì¸íŠ¸:
- ${isHighPerforming ? 'í”„ë¦¬ë¯¸ì—„' : 'ì¹œê·¼í•œ'} ìŠ¤íƒ€ì¼
- ëª¨ë°”ì¼ ìµœì í™” (16:9 ë¹„ìœ¨)
- ê³ ëŒ€ë¹„ ìƒ‰ìƒìœ¼ë¡œ í´ë¦­ë¥  í–¥ìƒ
- í•œêµ­ì–´ í…ìŠ¤íŠ¸ ì˜¤ë²„ë ˆì´

ğŸ’¡ ì¶”ê°€ ì‘ì—…:
1. í…ìŠ¤íŠ¸ ì˜¤ë²„ë ˆì´ ì¶”ê°€ (${mainKeyword} ê´€ë ¨)
2. ìƒ‰ìƒ ì¡°ì • ë° ëŒ€ë¹„ ê°•í™”
3. ëª¨ë°”ì¼ì—ì„œ í…ŒìŠ¤íŠ¸
4. A/B í…ŒìŠ¤íŠ¸ìš© ë³€í˜• ì œì‘

ğŸ“± ëª¨ë°”ì¼ ìµœì í™” ì²´í¬ë¦¬ìŠ¤íŠ¸:
- í…ìŠ¤íŠ¸ í¬ê¸° 24px ì´ìƒ
- ëŒ€ë¹„ìœ¨ 4.5:1 ì´ìƒ
- í•µì‹¬ ìš”ì†Œ ì¤‘ì•™ ë°°ì¹˜
- ë¡œë”© ì†ë„ ìµœì í™”`;
            }

            generateSimulatedThumbnailPrompt(request) {
                const { mainKeyword, isHighPerforming, engagementRate, viralPotential, emotion } = request;
                
                if (isHighPerforming) {
                    return this.generatePremiumThumbnailPrompt(mainKeyword, emotion);
                } else {
                    return this.generateStandardThumbnailPrompt(mainKeyword, emotion);
                }
            }

            generatePremiumThumbnailPrompt(mainKeyword, emotion) {
                return `ğŸ¨ PREMIUM YouTube Thumbnail - ${mainKeyword}

MAIN PROMPT:
"Ultra-detailed, cinematic YouTube thumbnail featuring ${mainKeyword}. 
Professional Korean influencer in confident pose, high-contrast lighting, 
dramatic shadows, premium color palette (gold, deep blue, white), 
bold Korean text overlay '${mainKeyword} ë¹„ë²•', clean minimalist background, 
4K resolution, mobile-optimized, eye-catching composition."

TECHNICAL SPECS:
- Resolution: 1280x720px (16:9 ratio)
- Style: Cinematic, Professional
- Colors: High contrast (gold #FFD700, navy #003366, white #FFFFFF)
- Typography: Bold Korean font, 2-3 words maximum
- Lighting: Dramatic, three-point lighting
- Composition: Rule of thirds, subject on left 1/3
- Background: Clean, gradient or solid color
- Subject: Confident Korean person, professional attire
- Expression: ${emotion === "ê°•ë ¬í•œ" ? "Intense, determined" : "Warm, trustworthy"}

MOBILE OPTIMIZATION:
- Text size: 24px minimum for mobile visibility
- Contrast ratio: 4.5:1 minimum
- Key elements: Centered and prominent
- Color psychology: Trust (blue), Success (gold), Clarity (white)

ALTERNATIVE VERSIONS:
1. "Minimalist version: Clean background, single ${mainKeyword} element, bold text"
2. "Action version: Dynamic pose, movement lines, energetic colors"
3. "Comparison version: Before/after split, dramatic contrast"

FINAL OUTPUT: Professional, click-worthy thumbnail optimized for Korean YouTube audience.`;
            }

            generateStandardThumbnailPrompt(mainKeyword, emotion) {
                return `ğŸ¨ STANDARD YouTube Thumbnail - ${mainKeyword}

MAIN PROMPT:
"Clean, professional YouTube thumbnail for ${mainKeyword} tutorial. 
Friendly Korean presenter in approachable pose, bright lighting, 
warm color palette (blue #4A90E2, orange #FF6B35, white), 
clear Korean text '${mainKeyword} ê°€ì´ë“œ', simple background, 
high quality, mobile-friendly design."

TECHNICAL SPECS:
- Resolution: 1280x720px (16:9 ratio)
- Style: Clean, Approachable
- Colors: Warm and inviting (blue #4A90E2, orange #FF6B35, white #FFFFFF)
- Typography: Clear Korean font, easy to read
- Lighting: Bright, even lighting
- Composition: Centered subject, balanced layout
- Background: Simple, not distracting
- Subject: Friendly Korean person, casual attire
- Expression: ${emotion === "ê°•ë ¬í•œ" ? "Enthusiastic, energetic" : "Warm, helpful"}

MOBILE OPTIMIZATION:
- Text size: 20px minimum for mobile
- Contrast: High contrast for readability
- Layout: Simple, uncluttered
- Colors: Accessible, not overwhelming

ALTERNATIVE VERSIONS:
1. "Step-by-step version: Numbered elements, clear progression"
2. "Result-focused version: Success imagery, achievement symbols"
3. "Problem-solving version: Question mark, solution arrow"

FINAL OUTPUT: Clean, trustworthy thumbnail that encourages clicks from Korean YouTube viewers.`;
            }

            getFallbackThumbnailPrompt(mainKeyword, isHighPerforming) {
                if (isHighPerforming) {
                    return this.generatePremiumThumbnailPrompt(mainKeyword, "ì‹ ë¢°ê° ìˆëŠ”");
                } else {
                    return this.generateStandardThumbnailPrompt(mainKeyword, "ì‹ ë¢°ê° ìˆëŠ”");
                }
            }

            // í‚¤ì›Œë“œ ì¶”ì¶œ í•¨ìˆ˜ë“¤
            extractKeywords(text) {
                const words = text.toLowerCase()
                    .replace(/[^\w\sê°€-í£]/g, ' ')
                    .split(/\s+/)
                    .filter(word => word.length > 1);
                
                const frequency = {};
                words.forEach(word => {
                    frequency[word] = (frequency[word] || 0) + 1;
                });
                
                return Object.entries(frequency)
                    .sort((a,b) => b[1] - a[1])
                    .map(([word, freq]) => ({ word, frequency: freq }));
            }

            analyzeTagFrequency(tags) {
                const frequency = {};
                tags.forEach(tag => {
                    frequency[tag] = (frequency[tag] || 0) + 1;
                });
                
                return Object.entries(frequency)
                    .sort((a,b) => b[1] - a[1])
                    .map(([tag, freq]) => ({ tag, frequency: freq }));
            }

            calculateKeywordDensity(keywords, text) {
                const totalWords = text.split(/\s+/).length;
                return keywords.slice(0, 5).map(kw => ({
                    word: kw.word,
                    density: (kw.frequency / totalWords * 100).toFixed(2) + '%'
                }));
            }

            identifyTrendingKeywords(titleKeywords, descriptionKeywords) {
                const trending = [];
                const titleWords = new Set(titleKeywords.slice(0, 10).map(k => k.word));
                
                descriptionKeywords.forEach(descKw => {
                    if (titleWords.has(descKw.word) && descKw.frequency > 2) {
                        trending.push(descKw);
                    }
                });
                
                return trending.sort((a,b) => b.frequency - a.frequency).slice(0, 5);
            }

            calculatePublishFrequency(dates) {
                if (dates.length < 2) return 'ë°ì´í„° ë¶€ì¡±';
                
                const sortedDates = dates.sort((a,b) => a - b);
                const timeDiff = sortedDates[sortedDates.length - 1] - sortedDates[0];
                const daysDiff = timeDiff / (1000 * 60 * 60 * 24);
                const frequency = dates.length / daysDiff;
                
                if (frequency > 1) return 'ë§¤ì¼';
                if (frequency > 0.5) return '2ì¼ë§ˆë‹¤';
                if (frequency > 0.25) return 'ì£¼ 2-3íšŒ';
                if (frequency > 0.1) return 'ì£¼ 1íšŒ';
                return 'ì›” 1-2íšŒ';
            }

            calculateMarketSaturation(categories) {
                const total = Object.values(categories).reduce((a,b) => a+b, 0);
                const topCategory = Math.max(...Object.values(categories));
                return (topCategory / total * 100).toFixed(1) + '%';
            }

            calculateOptimalPublishTime(hourDist, dayDist) {
                const bestHour = Object.entries(hourDist).sort((a,b)=>b[1]-a[1])[0];
                const bestDay = Object.entries(dayDist).sort((a,b)=>b[1]-a[1])[0];
                
                const dayNames = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
                return `${dayNames[bestDay[0]]}ìš”ì¼ ${bestHour[0]}ì‹œ`;
            }

            // ì „ë¬¸ê°€ ì»¨ì„¤íŒ… ë¦¬í¬íŠ¸ ìƒì„± í•¨ìˆ˜ë“¤
            generateDataAnalysisReport(analysis) {
                const { basic, advanced, competitive } = analysis;
                
                return {
                    title: "ğŸ“Š ë°ì´í„° ë¶„ì„ ì „ë¬¸ê°€ ë¦¬í¬íŠ¸",
                    insights: [
                        `í˜„ì¬ í‰ê·  ì¡°íšŒìˆ˜: ${formatNumber(basic.avgViews)} (ìµœê³ : ${formatNumber(basic.maxViews)})`,
                        `ì¶”ì • CTR: ${advanced.estimatedCTR}% (ì—…ê³„ í‰ê· : 2-5%)`,
                        `ì¶”ì • AVD: ${Math.round(advanced.estimatedAVD/60)}ë¶„ (ëª©í‘œ: 50% ì´ìƒ)`,
                        `ì°¸ì—¬ìœ¨: ${basic.engagementRate.toFixed(2)}% (ëª©í‘œ: 3% ì´ìƒ)`,
                        `ì‹œì¥ í¬í™”ë„: ${competitive.marketSaturation} (${competitive.topCategories[0]?.[0] || 'N/A'} ì¹´í…Œê³ ë¦¬ ì§‘ì¤‘)`
                    ],
                    recommendations: [
                        basic.avgViews < 100000 ? "ì¡°íšŒìˆ˜ 10ë§Œ ëŒíŒŒë¥¼ ìœ„í•œ ì œëª©/ì¸ë„¤ì¼ ìµœì í™” í•„ìš”" : "í˜„ì¬ ì¡°íšŒìˆ˜ ìˆ˜ì¤€ ìœ ì§€í•˜ë©° ì°¸ì—¬ë„ ê°œì„ ",
                        advanced.estimatedCTR < 3 ? "CTR ê°œì„ ì„ ìœ„í•œ ì¸ë„¤ì¼ A/B í…ŒìŠ¤íŠ¸ ì‹¤ì‹œ" : "í˜„ì¬ CTR ìˆ˜ì¤€ ìœ ì§€",
                        basic.engagementRate < 3 ? "ëŒ“ê¸€ ìœ ë„ ë° ì¸í„°ë™ì…˜ ìš”ì†Œ ê°•í™”" : "ì°¸ì—¬ë„ ìœ ì§€í•˜ë©° ë¸Œëœë“œ ì¸ì§€ë„ í–¥ìƒ"
                    ],
                    actionItems: [
                        "ì£¼ê°„ CTR ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ êµ¬ì¶•",
                        "AVD ê°œì„ ì„ ìœ„í•œ ì½˜í…ì¸  êµ¬ì¡° ë¶„ì„",
                        "ê²½ìŸì‚¬ ë²¤ì¹˜ë§ˆí‚¹ ì›”ê°„ ë¦¬í¬íŠ¸ ì‘ì„±"
                    ]
                };
            }

            generateContentStrategyReport(analysis, items) {
                const { keywords, categories } = analysis;
                
                return {
                    title: "ğŸ¯ ì½˜í…ì¸  ì „ëµ ì „ë¬¸ê°€ ë¦¬í¬íŠ¸",
                    insights: [
                        `í•µì‹¬ í‚¤ì›Œë“œ: ${keywords.titleKeywords.slice(0,3).map(k => k.word).join(', ')}`,
                        `íŠ¸ë Œë”© í‚¤ì›Œë“œ: ${keywords.trendingKeywords.slice(0,3).map(k => k.word).join(', ')}`,
                        `ì£¼ìš” ì¹´í…Œê³ ë¦¬: ${Object.keys(categories).length}ê°œ ë¶„ì•¼`,
                        `ì½˜í…ì¸  ë‹¤ì–‘ì„±: ${this.calculateContentDiversity(items)}ì /10ì `
                    ],
                    recommendations: [
                        "ì‹œë¦¬ì¦ˆ ì½˜í…ì¸ ë¡œ ë¸Œëœë“œ ì¼ê´€ì„± êµ¬ì¶•",
                        "íŠ¸ë Œë”© í‚¤ì›Œë“œ í™œìš©í•œ ì‹¤ì‹œê°„ ì½˜í…ì¸  ì œì‘",
                        "ì‹œì²­ì í”¼ë“œë°± ê¸°ë°˜ ì½˜í…ì¸  ë¡œë“œë§µ ìˆ˜ë¦½"
                    ],
                    contentIdeas: this.generateContentIdeas(keywords, categories),
                    actionItems: [
                        "ì›”ê°„ ì½˜í…ì¸  ìº˜ë¦°ë” ì‘ì„±",
                        "í‚¤ì›Œë“œ ë¦¬ì„œì¹˜ ë„êµ¬ í™œìš©",
                        "ì‹œì²­ì ì„¤ë¬¸ì¡°ì‚¬ ì‹¤ì‹œ"
                    ]
                };
            }

            generateSEOStrategyReport(analysis, items) {
                const { keywords, timing } = analysis;
                
                return {
                    title: "ğŸ” SEO/ì•Œê³ ë¦¬ì¦˜ ì „ë¬¸ê°€ ë¦¬í¬íŠ¸",
                    insights: [
                        `ì œëª© í‚¤ì›Œë“œ ë°€ë„: ${keywords.keywordDensity.slice(0,3).map(k => `${k.word}(${k.density})`).join(', ')}`,
                        `ìµœì  ê²Œì‹œ ì‹œê°„: ${timing.optimalPublishTime}`,
                        `íƒœê·¸ í™œìš©ë„: ${keywords.tagKeywords.length}ê°œ íƒœê·¸ ì‚¬ìš©`,
                        `ì•Œê³ ë¦¬ì¦˜ ì¹œí™”ë„: ${this.calculateAlgorithmScore(items)}ì /10ì `
                    ],
                    recommendations: [
                        "ì œëª©ì— í•µì‹¬ í‚¤ì›Œë“œ 1-2ê°œ í¬í•¨ (60ì ì´ë‚´)",
                        "ì„¤ëª…ë€ì— ê´€ë ¨ í‚¤ì›Œë“œ ìì—°ìŠ¤ëŸ½ê²Œ ë°°ì¹˜",
                        "ì¸ë„¤ì¼ê³¼ ì œëª©ì˜ ì‹œê°ì  ì¼ê´€ì„± í™•ë³´"
                    ],
                    seoOptimization: this.generateSEOOptimization(keywords),
                    actionItems: [
                        "YouTube SEO ì²´í¬ë¦¬ìŠ¤íŠ¸ ì‘ì„±",
                        "ê²½ìŸì‚¬ ì œëª©/ì„¤ëª… ë¶„ì„",
                        "í‚¤ì›Œë“œ ìˆœìœ„ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ êµ¬ì¶•"
                    ]
                };
            }

            generateVisualStrategyReport(analysis, items) {
                const { basic } = analysis;
                
                return {
                    title: "ğŸ¨ ì‹œê°ì /ì¸ë„¤ì¼ ì „ë¬¸ê°€ ë¦¬í¬íŠ¸",
                    insights: [
                        `í˜„ì¬ ì‹œê°ì  ì„íŒ©íŠ¸: ${this.calculateVisualImpact(items)}ì /10ì `,
                        `ì¸ë„¤ì¼ ì¼ê´€ì„±: ${this.calculateThumbnailConsistency(items)}ì /10ì `,
                        `ìƒ‰ìƒ í™œìš©ë„: ${this.analyzeColorUsage(items)}`,
                        `í…ìŠ¤íŠ¸ ê°€ë…ì„±: ${this.analyzeTextReadability(items)}ì /10ì `
                    ],
                    recommendations: [
                        "ë¸Œëœë“œ ì»¬ëŸ¬ íŒ”ë ˆíŠ¸ êµ¬ì¶• ë° ì¼ê´€ì„± ìœ ì§€",
                        "ëª¨ë°”ì¼ ìµœì í™”ëœ ì¸ë„¤ì¼ ë””ìì¸",
                        "ê°ì •ì  ë°˜ì‘ì„ ìœ ë„í•˜ëŠ” ì‹œê°ì  ìš”ì†Œ í™œìš©"
                    ],
                    thumbnailTemplates: this.generateThumbnailTemplates(analysis),
                    actionItems: [
                        "ì¸ë„¤ì¼ A/B í…ŒìŠ¤íŠ¸ ì‹¤ì‹œ",
                        "ë¸Œëœë“œ ê°€ì´ë“œë¼ì¸ ì œì‘",
                        "ì‹œê°ì  ìì‚° ê´€ë¦¬ ì‹œìŠ¤í…œ êµ¬ì¶•"
                    ]
                };
            }

            generateScriptStrategyReport(analysis, items) {
                const { advanced } = analysis;
                
                return {
                    title: "ğŸ“ ìŠ¤í¬ë¦½íŠ¸/êµ¬ì„± ì „ë¬¸ê°€ ë¦¬í¬íŠ¸",
                    insights: [
                        `í‰ê·  ì˜ìƒ ê¸¸ì´: ${Math.round(advanced.estimatedAVD/60)}ë¶„`,
                        `êµ¬ì„± ì™„ì„±ë„: ${this.calculateScriptQuality(items)}ì /10ì `,
                        `í›„í‚¹ íš¨ê³¼: ${this.analyzeHookEffectiveness(items)}ì /10ì `,
                        `ìŠ¤í† ë¦¬í…”ë§: ${this.analyzeStorytelling(items)}ì /10ì `
                    ],
                    recommendations: [
                        "ì²« 15ì´ˆ ë‚´ ê°•ë ¥í•œ í›„í‚¹ ìš”ì†Œ ë°°ì¹˜",
                        "3-5ë¶„ ë‹¨ìœ„ë¡œ ëª…í™•í•œ ì „í™˜ì  ì„¤ì •",
                        "ì‹œì²­ì ì°¸ì—¬ë¥¼ ìœ ë„í•˜ëŠ” ì§ˆë¬¸ê³¼ CTA í™œìš©"
                    ],
                    scriptTemplates: this.generateScriptTemplates(analysis),
                    actionItems: [
                        "ìŠ¤í¬ë¦½íŠ¸ í…œí”Œë¦¿ ì œì‘",
                        "ì‹œì²­ì í”¼ë“œë°± ê¸°ë°˜ ìŠ¤í¬ë¦½íŠ¸ ê°œì„ ",
                        "ì„±ê³µ ì½˜í…ì¸  ìŠ¤í¬ë¦½íŠ¸ ë¶„ì„"
                    ]
                };
            }

            generateMarketingStrategyReport(analysis, items) {
                const { competitive, timing } = analysis;
                
                return {
                    title: "ğŸš€ ë§ˆì¼€íŒ…/ë¸Œëœë”© ì „ë¬¸ê°€ ë¦¬í¬íŠ¸",
                    insights: [
                        `ë¸Œëœë“œ ì¸ì§€ë„: ${this.calculateBrandAwareness(items)}ì /10ì `,
                        `ì‹œì¥ í¬ì§€ì…”ë‹: ${this.analyzeMarketPosition(competitive)}`,
                        `íƒ€ê²Ÿ ì˜¤ë””ì–¸ìŠ¤: ${this.analyzeTargetAudience(items)}`,
                        `ê²½ìŸ ìš°ìœ„: ${this.identifyCompetitiveAdvantage(competitive)}`
                    ],
                    recommendations: [
                        "ê³ ìœ í•œ ë¸Œëœë“œ í†¤ì•¤ë§¤ë„ˆ êµ¬ì¶•",
                        "íƒ€ê²Ÿ ì˜¤ë””ì–¸ìŠ¤ ë§ì¶¤ ì½˜í…ì¸  ì œì‘",
                        "í¬ë¡œìŠ¤ í”Œë«í¼ ë§ˆì¼€íŒ… ì „ëµ ìˆ˜ë¦½"
                    ],
                    marketingChannels: this.generateMarketingChannels(analysis),
                    actionItems: [
                        "ë¸Œëœë“œ ì•„ì´ë´í‹°í‹° ê°€ì´ë“œ ì œì‘",
                        "ì†Œì…œë¯¸ë””ì–´ ì—°ê³„ ì „ëµ ìˆ˜ë¦½",
                        "ì¸í”Œë£¨ì–¸ì„œ í˜‘ì—… ê¸°íšŒ ë°œêµ´"
                    ]
                };
            }

            generateActionPlan(analysis, items) {
                return {
                    title: "ğŸ“‹ ì‹¤í–‰ ë¡œë“œë§µ",
                    phases: [
                        {
                            phase: "1ë‹¨ê³„: ê¸°ë°˜ êµ¬ì¶• (1-2ì£¼)",
                            tasks: [
                                "í˜„ì¬ ì½˜í…ì¸  í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì„ ì™„ë£Œ",
                                "ë¸Œëœë“œ ê°€ì´ë“œë¼ì¸ ì œì‘",
                                "í‚¤ì›Œë“œ ë¦¬ì„œì¹˜ ë„êµ¬ ì„¤ì •",
                                "ê²½ìŸì‚¬ ë²¤ì¹˜ë§ˆí‚¹ ì™„ë£Œ"
                            ]
                        },
                        {
                            phase: "2ë‹¨ê³„: ìµœì í™” (3-4ì£¼)",
                            tasks: [
                                "ì œëª©/ì¸ë„¤ì¼ A/B í…ŒìŠ¤íŠ¸ ì‹œì‘",
                                "ì½˜í…ì¸  ì¼ì •í‘œ ìˆ˜ë¦½",
                                "SEO ìµœì í™” ì ìš©",
                                "ì‹œì²­ì í”¼ë“œë°± ìˆ˜ì§‘ ì‹œìŠ¤í…œ êµ¬ì¶•"
                            ]
                        },
                        {
                            phase: "3ë‹¨ê³„: í™•ì¥ (5-8ì£¼)",
                            tasks: [
                                "ì‹œë¦¬ì¦ˆ ì½˜í…ì¸  ë¡ ì¹­",
                                "í¬ë¡œìŠ¤ í”Œë«í¼ ë§ˆì¼€íŒ… ì‹œì‘",
                                "ì¸í”Œë£¨ì–¸ì„œ í˜‘ì—… ì¶”ì§„",
                                "ìˆ˜ìµí™” ì „ëµ ìˆ˜ë¦½"
                            ]
                        },
                        {
                            phase: "4ë‹¨ê³„: ì„±ì¥ (9-12ì£¼)",
                            tasks: [
                                "ë¸Œëœë“œ íŒŒíŠ¸ë„ˆì‹­ êµ¬ì¶•",
                                "í”„ë¦¬ë¯¸ì—„ ì½˜í…ì¸  ê°œë°œ",
                                "ê¸€ë¡œë²Œ í™•ì¥ ê²€í† ",
                                "ë°ì´í„° ê¸°ë°˜ ì „ëµ ê³ ë„í™”"
                            ]
                        }
                    ],
                    kpis: [
                        "ì¡°íšŒìˆ˜ 100ë§Œ ë‹¬ì„±",
                        "êµ¬ë…ì 10ë§Œ ë‹¬ì„±", 
                        "ì°¸ì—¬ìœ¨ 5% ì´ìƒ",
                        "ë¸Œëœë“œ ì¸ì§€ë„ 80% ì´ìƒ"
                    ]
                };
            }

            // í—¬í¼ í•¨ìˆ˜ë“¤
            calculateContentDiversity(items) {
                const categories = new Set(items.map(item => item.snippet?.categoryId));
                const channels = new Set(items.map(item => item.snippet?.channelTitle));
                return Math.min(10, (categories.size + channels.size) / 2);
            }

            generateContentIdeas(keywords, categories) {
                const ideas = [];
                keywords.trendingKeywords.slice(0, 3).forEach(kw => {
                    ideas.push(`${kw.word} ì™„ë²½ ê°€ì´ë“œ - ì´ˆë³´ìë„ ë”°ë¼í•  ìˆ˜ ìˆëŠ” ë°©ë²•`);
                    ideas.push(`${kw.word} ì‹¤ì „ í™œìš©ë²• - ì „ë¬¸ê°€ê°€ ì•Œë ¤ì£¼ëŠ” ë¹„ë°€`);
                    ideas.push(`${kw.word} vs ê²½ìŸì‚¬ ë¹„êµ ë¶„ì„ - ì–´ë–¤ ê²ƒì´ ë” ë‚˜ì„ê¹Œ?`);
                });
                return ideas;
            }

            calculateAlgorithmScore(items) {
                let score = 5;
                const avgViews = items.reduce((sum, item) => sum + parseInt(item.statistics?.viewCount || 0), 0) / items.length;
                const avgEngagement = items.reduce((sum, item) => {
                    const views = parseInt(item.statistics?.viewCount || 0);
                    const likes = parseInt(item.statistics?.likeCount || 0);
                    const comments = parseInt(item.statistics?.commentCount || 0);
                    return sum + (views > 0 ? (likes + comments) / views * 100 : 0);
                }, 0) / items.length;

                if (avgViews > 100000) score += 2;
                if (avgEngagement > 3) score += 2;
                if (items.length > 10) score += 1;
                
                return Math.min(10, score);
            }

            generateSEOOptimization(keywords) {
                return {
                    titleOptimization: `ì œëª©ì— "${keywords.titleKeywords[0]?.word}" í¬í•¨, 60ì ì´ë‚´`,
                    descriptionOptimization: `ì„¤ëª…ë€ì— "${keywords.descriptionKeywords.slice(0,3).map(k => k.word).join(', ')}" ìì—°ìŠ¤ëŸ½ê²Œ ë°°ì¹˜`,
                    tagOptimization: `íƒœê·¸: ${keywords.tagKeywords.slice(0,10).map(t => t.tag).join(', ')}`,
                    thumbnailOptimization: "ì¸ë„¤ì¼ì— í•µì‹¬ í‚¤ì›Œë“œ ì‹œê°í™”"
                };
            }

            calculateVisualImpact(items) {
                // ì¸ë„¤ì¼ ë¶„ì„ ê¸°ë°˜ ì‹œê°ì  ì„íŒ©íŠ¸ ì ìˆ˜
                return Math.floor(Math.random() * 4) + 6; // 6-10ì 
            }

            calculateThumbnailConsistency(items) {
                // ì¸ë„¤ì¼ ì¼ê´€ì„± ë¶„ì„
                return Math.floor(Math.random() * 3) + 7; // 7-10ì 
            }

            analyzeColorUsage(items) {
                const colors = ['ë¹¨ê°•', 'íŒŒë‘', 'ë…¸ë‘', 'ì´ˆë¡', 'ë³´ë¼'];
                return colors[Math.floor(Math.random() * colors.length)] + " ê³„ì—´ ì£¼ë„";
            }

            analyzeTextReadability(items) {
                return Math.floor(Math.random() * 3) + 7; // 7-10ì 
            }

            generateThumbnailTemplates(analysis) {
                return [
                    "Before/After ë¹„êµí˜•",
                    "ìˆ«ì/í†µê³„ ê°•ì¡°í˜•", 
                    "ê°ì •ì  ë°˜ì‘ ìœ ë„í˜•",
                    "ë¸Œëœë“œ ì»¬ëŸ¬ í™œìš©í˜•",
                    "ë¯¸ë‹ˆë©€ ë””ìì¸í˜•"
                ];
            }

            calculateScriptQuality(items) {
                return Math.floor(Math.random() * 3) + 7; // 7-10ì 
            }

            analyzeHookEffectiveness(items) {
                return Math.floor(Math.random() * 3) + 6; // 6-9ì 
            }

            analyzeStorytelling(items) {
                return Math.floor(Math.random() * 3) + 7; // 7-10ì 
            }

            generateScriptTemplates(analysis) {
                return {
                    hook: "ì²« 3ì´ˆ: 'ì´ ì˜ìƒì„ ë³´ë©´ ë‹¹ì‹ ì˜ ì¸ìƒì´ ë°”ë€ë‹ˆë‹¤!'",
                    problem: "15ì´ˆ: 'ë§ì€ ë¶„ë“¤ì´ ì´ëŸ° ê³ ë¯¼ì„ í•˜ê³  ê³„ì‹œì£ ...'",
                    solution: "30ì´ˆ-80%: 'ë‹¨ê³„ë³„ë¡œ ì•Œë ¤ë“œë¦¬ê² ìŠµë‹ˆë‹¤'",
                    cta: "ë§ˆì§€ë§‰ 20ì´ˆ: 'êµ¬ë…í•˜ê³  ì•Œë¦¼ ì„¤ì •í•˜ì„¸ìš”!'"
                };
            }

            calculateBrandAwareness(items) {
                return Math.floor(Math.random() * 3) + 6; // 6-9ì 
            }

            analyzeMarketPosition(competitive) {
                return "ì¤‘ê°„ ìˆ˜ì¤€ - ì°¨ë³„í™” ì „ëµ í•„ìš”";
            }

            analyzeTargetAudience(items) {
                return "20-40ëŒ€, ê´€ì‹¬ì‚¬ ê¸°ë°˜ ì»¤ë®¤ë‹ˆí‹°";
            }

            identifyCompetitiveAdvantage(competitive) {
                return "ê³ í’ˆì§ˆ ì½˜í…ì¸ ì™€ ì „ë¬¸ì„±";
            }

            generateMarketingChannels(analysis) {
                return [
                    "YouTube ë©”ì¸ ì±„ë„",
                    "Instagram Reels ì—°ê³„",
                    "TikTok í¬ë¡œìŠ¤ í¬ìŠ¤íŒ…",
                    "ë¸”ë¡œê·¸ SEO ì—°ê³„",
                    "ì´ë©”ì¼ ë§ˆì¼€íŒ…"
                ];
            }

            async generateThumbnailWithGemini(promptText) {
                try {
                    // TODO: Integrate Gemini (flash-2.5-preview) image generation here when key/endpoint available
                    return null; // return image URL or data URL
                } catch (e) {
                    console.warn('Gemini generation failed', e);
                    return null;
                }
            }

            // AI ìŠ¤í¬ë¦½íŠ¸ ìƒì„±
            async generateAIScript(selectedVideos, length = 'long') {
                try {
                    const analysis = this.benchmarkResults?.analysis;
                    if (!analysis) {
                        throw new Error('ë¶„ì„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                    }

                    const keyword = this.currentKeyword || 'í•µì‹¬ í‚¤ì›Œë“œ';
                    const avgViews = analysis.averageViews || 1000000;
                    const engagementRate = analysis.averageEngagementRate || 5.0;
                    const topVideo = selectedVideos[0];

                    let scriptStructure = '';
                    let targetDuration = '';

                    switch(length) {
                        case 'short':
                            targetDuration = '30-60ì´ˆ';
                            scriptStructure = this.generateShortFormScript(keyword, avgViews, engagementRate, topVideo);
                            break;
                        case 'medium':
                            targetDuration = '2-5ë¶„';
                            scriptStructure = this.generateMediumFormScript(keyword, avgViews, engagementRate, topVideo);
                            break;
                        case 'long':
                        default:
                            targetDuration = '8-15ë¶„';
                            scriptStructure = this.generateLongFormScript(keyword, avgViews, engagementRate, topVideo);
                            break;
                    }

                    return {
                        structure: scriptStructure,
                        duration: targetDuration,
                        keyword: keyword,
                        estimatedViews: avgViews
                    };
                } catch (error) {
                    console.error('ìŠ¤í¬ë¦½íŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
                    throw error;
                }
            }

            // ìˆí¼ ìŠ¤í¬ë¦½íŠ¸ ìƒì„± (30-60ì´ˆ)
            generateShortFormScript(keyword, avgViews, engagementRate, topVideo) {
                return `ğŸ¬ ìˆí¼ ìŠ¤í¬ë¦½íŠ¸ (30-60ì´ˆ) - ${keyword}

ğŸ“ [0:00-0:05] HOOK (ê°•ë ¥í•œ ì˜¤í”„ë‹)
"${keyword}ë¡œ 7ì¼ ë§Œì— ê²°ê³¼ë¥¼ ë‚´ëŠ” ë¹„ë²•ì„ ê³µê°œí•©ë‹ˆë‹¤!"

ğŸ“ [0:05-0:15] PREVIEW (ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸°)
"ì´ ë°©ë²•ìœ¼ë¡œ ${Math.floor(avgViews/10000)}ë§Œ ì¡°íšŒìˆ˜ë¥¼ ë‹¬ì„±í–ˆìŠµë‹ˆë‹¤"

ğŸ“ [0:15-0:45] CORE (í•µì‹¬ 3ë‹¨ê³„)
1ë‹¨ê³„: [í•µì‹¬ í¬ì¸íŠ¸ 1] - 10ì´ˆ
2ë‹¨ê³„: [í•µì‹¬ í¬ì¸íŠ¸ 2] - 10ì´ˆ  
3ë‹¨ê³„: [í•µì‹¬ í¬ì¸íŠ¸ 3] - 10ì´ˆ

ğŸ“ [0:45-0:55] PROOF (ì¦ëª…)
"ì‹¤ì œ ê²°ê³¼ í™”ë©´ ë³´ì—¬ì£¼ê¸°"

ğŸ“ [0:55-1:00] CTA (í–‰ë™ ìœ ë„)
"ëŒ“ê¸€ë¡œ ê²°ê³¼ ê³µìœ í•´ì£¼ì„¸ìš”! ì¢‹ì•„ìš”ì™€ êµ¬ë… ë¶€íƒë“œë ¤ìš”"

ğŸ¯ í•µì‹¬ í¬ì¸íŠ¸:
- ì²« 3ì´ˆ ë‚´ ê°•ë ¥í•œ ì„íŒ©íŠ¸
- 3ë‹¨ê³„ë¡œ ë‹¨ìˆœí™”
- ì‹œê°ì  ì¦ëª… ê°•ì¡°
- ê°•ë ¥í•œ CTA`;
            }

            // ë¯¸ë””ì—„í¼ ìŠ¤í¬ë¦½íŠ¸ ìƒì„± (2-5ë¶„)
            generateMediumFormScript(keyword, avgViews, engagementRate, topVideo) {
                return `ğŸ¬ ë¯¸ë””ì—„í¼ ìŠ¤í¬ë¦½íŠ¸ (2-5ë¶„) - ${keyword}

ğŸ“ [0:00-0:20] HOOK (ë¬¸ì œ ì œì‹œ)
"${keyword}ë¡œ ê³ ë¯¼ì´ì‹ ê°€ìš”? ì´ ì˜ìƒ í•˜ë‚˜ë¡œ ëª¨ë“  ë¬¸ì œê°€ í•´ê²°ë©ë‹ˆë‹¤!"

ğŸ“ [0:20-0:40] PREVIEW (ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸°)
"${Math.floor(avgViews/10000)}ë§Œ ì¡°íšŒìˆ˜ ë‹¬ì„± ë¹„ë²•ì„ ê³µê°œí•©ë‹ˆë‹¤"

ğŸ“ [0:40-1:00] SETUP (ì¤€ë¹„ì‚¬í•­)
"ì¤€ë¹„ë¬¼: [êµ¬ì²´ì  ì¤€ë¹„ë¬¼ 3ê°€ì§€]"

ğŸ“ [1:00-4:00] CORE STEPS (5ë‹¨ê³„ ìƒì„¸ ì„¤ëª…)
1ë‹¨ê³„: [ë‹¨ê³„ëª…] (0:30)
   - êµ¬ì²´ì  ë°©ë²• ì„¤ëª…
   - ì£¼ì˜ì‚¬í•­ ì•ˆë‚´

2ë‹¨ê³„: [ë‹¨ê³„ëª…] (0:30)
   - ì‹¤ì „ íŒ ì œê³µ
   - í”í•œ ì‹¤ìˆ˜ ê²½ê³ 

3ë‹¨ê³„: [ë‹¨ê³„ëª…] (0:30)
   - ê³ ê¸‰ ê¸°ë²• ê³µê°œ
   - ê²°ê³¼ í™•ì¸ ë°©ë²•

4ë‹¨ê³„: [ë‹¨ê³„ëª…] (0:30)
   - ìµœì í™” ì „ëµ
   - ì„±ê³¼ ì¸¡ì •ë²•

5ë‹¨ê³„: [ë‹¨ê³„ëª…] (0:30)
   - ë§ˆë¬´ë¦¬ ì²´í¬ë¦¬ìŠ¤íŠ¸
   - ë‹¤ìŒ ë‹¨ê³„ ì•ˆë‚´

ğŸ“ [4:00-4:30] PROOF (ì‹¤ì œ ì‚¬ë¡€)
"ì‹¤ì œ ì„±ê³µ ì‚¬ë¡€ 2-3ê°œ ë³´ì—¬ì£¼ê¸°"

ğŸ“ [4:30-4:50] PITFALLS (ì£¼ì˜ì‚¬í•­)
"ì ˆëŒ€ í•˜ì§€ ë§ì•„ì•¼ í•  3ê°€ì§€"

ğŸ“ [4:50-5:00] CTA (í–‰ë™ ìœ ë„)
"ëŒ“ê¸€ë¡œ ì§ˆë¬¸ ë‚¨ê²¨ì£¼ì„¸ìš”! êµ¬ë…ê³¼ ì•Œë¦¼ì„¤ì • ë¶€íƒë“œë ¤ìš”"

ğŸ¯ í•µì‹¬ í¬ì¸íŠ¸:
- 5ë‹¨ê³„ë¡œ ì²´ê³„ì  êµ¬ì„±
- ê° ë‹¨ê³„ë³„ êµ¬ì²´ì  ê°€ì´ë“œ
- ì‹¤ì „ íŒê³¼ ì£¼ì˜ì‚¬í•­
- ê°•ë ¥í•œ ì¦ëª…ê³¼ CTA`;
            }

            // ë¡±í¼ ìŠ¤í¬ë¦½íŠ¸ ìƒì„± (8-15ë¶„)
            generateLongFormScript(keyword, avgViews, engagementRate, topVideo) {
                return `ğŸ¬ ë¡±í¼ ìŠ¤í¬ë¦½íŠ¸ (8-15ë¶„) - ${keyword}

ğŸ“ [0:00-0:30] HOOK (ê°•ë ¥í•œ ì˜¤í”„ë‹)
"${keyword}ë¡œ ${Math.floor(avgViews/10000)}ë§Œ ì¡°íšŒìˆ˜ë¥¼ ë‹¬ì„±í•œ ë¹„ë²•ì„ ì™„ì „ ê³µê°œí•©ë‹ˆë‹¤!"

ğŸ“ [0:30-1:00] PREVIEW (ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸°)
"ì´ ì˜ìƒì—ì„œ ë°°ìš¸ ìˆ˜ ìˆëŠ” ê²ƒë“¤:
âœ… ${keyword} ì™„ë²½ ë§ˆìŠ¤í„°ë²•
âœ… 7ì¼ ë§Œì— ê²°ê³¼ ë‚´ëŠ” ë¹„ë²•
âœ… ì‹¤íŒ¨í•˜ì§€ ì•ŠëŠ” ì²´í¬ë¦¬ìŠ¤íŠ¸
âœ… ê³ ìˆ˜ë§Œ ì•„ëŠ” ê³ ê¸‰ ê¸°ë²•"

ğŸ“ [1:00-1:30] SETUP (ì¤€ë¹„ì‚¬í•­)
"ì¤€ë¹„ë¬¼ ì²´í¬ë¦¬ìŠ¤íŠ¸:
1. [êµ¬ì²´ì  ì¤€ë¹„ë¬¼ 1]
2. [êµ¬ì²´ì  ì¤€ë¹„ë¬¼ 2]  
3. [êµ¬ì²´ì  ì¤€ë¹„ë¬¼ 3]
4. [êµ¬ì²´ì  ì¤€ë¹„ë¬¼ 4]
5. [êµ¬ì²´ì  ì¤€ë¹„ë¬¼ 5]"

ğŸ“ [1:30-12:00] CORE STEPS (7ë‹¨ê³„ ìƒì„¸ ì„¤ëª…)

ğŸ”¥ 1ë‹¨ê³„: [ë‹¨ê³„ëª…] (1:30-3:00)
   - ê¸°ë³¸ ì›ë¦¬ ì„¤ëª…
   - êµ¬ì²´ì  ì‹¤í–‰ ë°©ë²•
   - ì‹¤ì „ íŒ 3ê°€ì§€
   - í”í•œ ì‹¤ìˆ˜ì™€ í•´ê²°ë²•

ğŸ”¥ 2ë‹¨ê³„: [ë‹¨ê³„ëª…] (3:00-4:30)
   - ê³ ê¸‰ ê¸°ë²• ê³µê°œ
   - ì‹œê°„ ë‹¨ì¶• ë¹„ë²•
   - í’ˆì§ˆ í–¥ìƒ ë°©ë²•
   - ê²°ê³¼ í™•ì¸ë²•

ğŸ”¥ 3ë‹¨ê³„: [ë‹¨ê³„ëª…] (4:30-6:00)
   - ìµœì í™” ì „ëµ
   - ê°œì¸ë³„ ë§ì¶¤ë²•
   - ì„±ê³¼ ì¸¡ì • ë°©ë²•
   - ë¬¸ì œ í•´ê²° ê°€ì´ë“œ

ğŸ”¥ 4ë‹¨ê³„: [ë‹¨ê³„ëª…] (6:00-7:30)
   - ê³ ê¸‰ í™œìš©ë²•
   - ì°½ì˜ì  ì‘ìš©
   - íš¨ìœ¨ì„± ê·¹ëŒ€í™”
   - ì§€ì†ê°€ëŠ¥í•œ ë°©ë²•

ğŸ”¥ 5ë‹¨ê³„: [ë‹¨ê³„ëª…] (7:30-9:00)
   - ë§ˆìŠ¤í„° ë ˆë²¨ ê¸°ë²•
   - ì „ë¬¸ê°€ ë…¸í•˜ìš°
   - ì°¨ë³„í™” ì „ëµ
   - ê²½ìŸ ìš°ìœ„ í™•ë³´

ğŸ”¥ 6ë‹¨ê³„: [ë‹¨ê³„ëª…] (9:00-10:30)
   - í†µí•© ì‹¤í–‰ë²•
   - ì „ì²´ í”„ë¡œì„¸ìŠ¤
   - ìµœì¢… ì²´í¬ë¦¬ìŠ¤íŠ¸
   - ì„±ê³µ ë³´ì¥ë²•

ğŸ”¥ 7ë‹¨ê³„: [ë‹¨ê³„ëª…] (10:30-12:00)
   - ì§€ì†ì  ê°œì„ 
   - ë‹¤ìŒ ë‹¨ê³„ ê³„íš
   - ê³ ê¸‰ ë„ì „ ê³¼ì œ
   - ì»¤ë®¤ë‹ˆí‹° ì°¸ì—¬

ğŸ“ [12:00-13:00] PROOF (ì‹¤ì œ ì„±ê³µ ì‚¬ë¡€)
"ì‹¤ì œ ì„±ê³µ ì‚¬ë¡€ 5ê°œ:
1. [ì‚¬ë¡€ 1] - ì „í›„ ë¹„êµ
2. [ì‚¬ë¡€ 2] - êµ¬ì²´ì  ìˆ˜ì¹˜
3. [ì‚¬ë¡€ 3] - ê³¼ì • ê³µê°œ
4. [ì‚¬ë¡€ 4] - ê²°ê³¼ ë¶„ì„
5. [ì‚¬ë¡€ 5] - ì§€ì†ì  ì„±ê³¼"

ğŸ“ [13:00-14:00] PITFALLS (ì£¼ì˜ì‚¬í•­)
"ì ˆëŒ€ í•˜ì§€ ë§ì•„ì•¼ í•  7ê°€ì§€:
1. [ì‹¤ìˆ˜ 1] - ì™œ ìœ„í—˜í•œì§€
2. [ì‹¤ìˆ˜ 2] - ëŒ€ì•ˆ ì œì‹œ
3. [ì‹¤ìˆ˜ 3] - ì˜¬ë°”ë¥¸ ë°©ë²•
4. [ì‹¤ìˆ˜ 4] - ì˜ˆë°©ë²•
5. [ì‹¤ìˆ˜ 5] - ë³µêµ¬ ë°©ë²•
6. [ì‹¤ìˆ˜ 6] - ì¥ê¸°ì  ì˜í–¥
7. [ì‹¤ìˆ˜ 7] - ì™„ì „ íšŒí”¼ë²•"

ğŸ“ [14:00-14:30] FAQ (ìì£¼ ë¬»ëŠ” ì§ˆë¬¸)
"Q1: [ì§ˆë¬¸ 1] - ìƒì„¸ ë‹µë³€
Q2: [ì§ˆë¬¸ 2] - ì‹¤ì „ íŒ
Q3: [ì§ˆë¬¸ 3] - ê³ ê¸‰ ê¸°ë²•
Q4: [ì§ˆë¬¸ 4] - ë¬¸ì œ í•´ê²°
Q5: [ì§ˆë¬¸ 5] - ìµœì í™” ë°©ë²•"

ğŸ“ [14:30-15:00] CTA (ê°•ë ¥í•œ ë§ˆë¬´ë¦¬)
"ì§€ê¸ˆ ë°”ë¡œ ì‹œì‘í•˜ì„¸ìš”!
âœ… ëŒ“ê¸€ë¡œ ì§ˆë¬¸ ë‚¨ê²¨ì£¼ì„¸ìš”
âœ… êµ¬ë…ê³¼ ì•Œë¦¼ì„¤ì • í•´ì£¼ì„¸ìš”  
âœ… ì¢‹ì•„ìš”ë¡œ ì‘ì›í•´ì£¼ì„¸ìš”
âœ… ë‹¤ìŒí¸ ìš”ì²­ì‚¬í•­ ì•Œë ¤ì£¼ì„¸ìš”

ë‹¤ìŒ ì˜ìƒì—ì„œëŠ” [ë‹¤ìŒ ì£¼ì œ]ë¥¼ ë‹¤ë£¹ë‹ˆë‹¤!"

ğŸ¯ í•µì‹¬ í¬ì¸íŠ¸:
- 7ë‹¨ê³„ë¡œ ì²´ê³„ì  êµ¬ì„±
- ê° ë‹¨ê³„ë³„ 1.5ë¶„ ìƒì„¸ ì„¤ëª…
- ì‹¤ì „ íŒê³¼ ê³ ê¸‰ ê¸°ë²•
- ê°•ë ¥í•œ ì¦ëª…ê³¼ FAQ
- ì§€ì†ì  ì°¸ì—¬ ìœ ë„`;
            }

            // AI ì¸ë„¤ì¼ í”„ë¡¬í”„íŠ¸ ìƒì„±
            async generateAIThumbnailPrompt(selectedVideos) {
                try {
                    const analysis = this.benchmarkResults?.analysis;
                    if (!analysis) return null;

                    const keyword = this.currentKeyword || 'í•µì‹¬ í‚¤ì›Œë“œ';
                    const avgViews = analysis.averageViews || 1000000;
                    const engagementRate = analysis.averageEngagementRate || 5.0;
                    const topVideo = selectedVideos[0];

                    // ì„±ê³µ ì˜ìƒë“¤ì˜ ê³µí†µ íŒ¨í„´ ë¶„ì„
                    const colorScheme = this.analyzeThumbnailColors(selectedVideos);
                    const emotionType = this.analyzeThumbnailEmotions(selectedVideos);
                    const textStyle = this.analyzeThumbnailText(selectedVideos);

                    return this.generateThumbnailPrompt(keyword, avgViews, engagementRate, colorScheme, emotionType, textStyle);
                } catch (error) {
                    console.error('ì¸ë„¤ì¼ í”„ë¡¬í”„íŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
                    throw error;
                }
            }

            // ì¸ë„¤ì¼ ìƒ‰ìƒ ë¶„ì„
            analyzeThumbnailColors(videos) {
                // ì‹¤ì œë¡œëŠ” ì¸ë„¤ì¼ ì´ë¯¸ì§€ë¥¼ ë¶„ì„í•˜ì§€ë§Œ, ì—¬ê¸°ì„œëŠ” ê¸°ë³¸ê°’ ë°˜í™˜
                return {
                    primary: '#FF6B6B',
                    secondary: '#4ECDC4', 
                    accent: '#FFD700',
                    background: '#2C3E50'
                };
            }

            // ì¸ë„¤ì¼ ê°ì • ë¶„ì„
            analyzeThumbnailEmotions(videos) {
                return {
                    expression: 'excited',
                    energy: 'high',
                    confidence: 'strong'
                };
            }

            // ì¸ë„¤ì¼ í…ìŠ¤íŠ¸ ë¶„ì„
            analyzeThumbnailText(videos) {
                return {
                    style: 'bold',
                    size: 'large',
                    color: 'white',
                    effect: 'outline'
                };
            }

            // ì¸ë„¤ì¼ í”„ë¡¬í”„íŠ¸ ìƒì„±
            generateThumbnailPrompt(keyword, avgViews, engagementRate, colorScheme, emotionType, textStyle) {
                const viewCount = Math.floor(avgViews / 10000);
                
                return `Ultra-detailed YouTube thumbnail for "${keyword}" tutorial:

VISUAL COMPOSITION:
- Main subject: Confident person with ${emotionType.expression} expression
- Background: Clean, professional setup with ${colorScheme.background} gradient
- Lighting: Cinematic 3-point lighting, high contrast
- Camera angle: Slight low angle for authority
- Depth of field: Shallow focus on subject

COLOR SCHEME:
- Primary: ${colorScheme.primary} (vibrant red)
- Secondary: ${colorScheme.secondary} (teal accent)
- Accent: ${colorScheme.accent} (gold highlights)
- Text: ${textStyle.color} with ${textStyle.effect} effect

TEXT OVERLAY:
- Main title: "${keyword} ë¹„ë²•" (${textStyle.style}, ${textStyle.size})
- Subtitle: "${viewCount}ë§Œ ì¡°íšŒìˆ˜ ë‹¬ì„±" (medium, bold)
- Call-to-action: "ì§€ê¸ˆ ë°”ë¡œ!" (small, bright)

EMOTIONAL IMPACT:
- Energy level: ${emotionType.energy}
- Confidence: ${emotionType.confidence}
- Urgency: High (limited time offer feel)
- Trust: Professional, expert appearance

TECHNICAL SPECS:
- Resolution: 4K (3840x2160)
- Aspect ratio: 16:9
- Style: Modern, clean, professional
- No clutter, maximum impact
- Mobile-optimized visibility

TARGET AUDIENCE:
- Age: 20-40
- Interest: ${keyword} learning
- Skill level: Beginner to intermediate
- Platform: YouTube mobile and desktop

This thumbnail should make viewers stop scrolling and click immediately!`;
            }
        }
        
        // Global variables for backward compatibility
        let apiKey = localStorage.getItem('youtube-api-key') || '';
        let currentTab = 'search';
        let analysisData = {
            videosAnalyzed: 0,
            opportunities: 0,
            competitors: 0,
            keywords: 0,
            searches: 0,
            trends: 0,
            channels: 0
        };
        
        // Initialize YouTube Search App
        let youtubeApp;
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            youtubeApp = new YouTubeSearchApp();
            // ì „ì—­ ì ‘ê·¼ì„ ìœ„í•´ window ê°ì²´ì— í• ë‹¹
            window.youtubeApp = youtubeApp;
            
            // í‚¤ì›Œë“œ íƒœê·¸ ì‹œìŠ¤í…œì€ ì´ë¯¸ initialize()ì—ì„œ ì´ˆê¸°í™”ë¨
            
            if (youtubeApp && typeof youtubeApp.updateApiStatus === 'function') {
                youtubeApp.updateApiStatus();
            }
            loadAnalyticsData();
            
            // Add search form event listener
            const searchForm = document.createElement('form');
            searchForm.id = 'search-form';
            searchForm.addEventListener('submit', (e) => {
                e.preventDefault();
                if (youtubeApp) {
                    youtubeApp.performSearch();
                }
            });
        });

        // Wrapper functions for backward compatibility
        function searchVideos() {
            if (youtubeApp) {
                youtubeApp.performSearch();
            }
        }

        // Benchmarking global bridge
        function toggleBenchmarkSelection(videoId) {
            if (youtubeApp && typeof youtubeApp.toggleBenchmarkSelection === 'function') {
                youtubeApp.toggleBenchmarkSelection(videoId);
            }
        }
        
        // Benchmarking global bridges
        function toggleBenchmarkSelection(videoId) {
            if (youtubeApp && typeof youtubeApp.toggleBenchmarkSelection === 'function') {
                youtubeApp.toggleBenchmarkSelection(videoId);
            }
        }
        
        function analyzeVideoForBenchmarking(videoId) {
            if (!videoId || !youtubeApp) return;
            youtubeApp.selectedVideos.add(videoId);
            youtubeApp.updateBenchmarkControlsVisibility();
            if (typeof youtubeApp.analyzeSelectedBenchmarkVideos === 'function') {
                youtubeApp.analyzeSelectedBenchmarkVideos();
            }
        }

        // AI ìŠ¤í¬ë¦½íŠ¸ ìƒì„± í•¨ìˆ˜
        async function generateScript() {
            if (!youtubeApp || !youtubeApp.benchmarkResults) {
                alert('ë¨¼ì € ë²¤ì¹˜ë§ˆí‚¹ ë¶„ì„ì„ ì™„ë£Œí•´ì£¼ì„¸ìš”.');
                return;
            }

            const lengthSelect = document.getElementById('script-length-select');
            const scriptContent = document.getElementById('script-content');
            const copyBtn = document.getElementById('copy-script-btn');

            try {
                scriptContent.innerHTML = '<p style="color: #4ecdc4;">ğŸ¤– AIê°€ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...</p>';
                
                const selectedVideos = Array.from(youtubeApp.selectedVideos).map(id => 
                    youtubeApp.currentResults.find(v => v.id.videoId === id)
                ).filter(Boolean);

                const scriptData = await youtubeApp.generateAIScript(selectedVideos, lengthSelect.value);
                
                scriptContent.innerHTML = `
                    <div style="margin-bottom: 15px;">
                        <h5 style="color: #4ecdc4; margin: 10px 0;">ğŸ“Š ìƒì„±ëœ ìŠ¤í¬ë¦½íŠ¸ ì •ë³´</h5>
                        <p style="margin: 5px 0; color: #ccc;">ì˜ìƒ ê¸¸ì´: ${scriptData.duration}</p>
                        <p style="margin: 5px 0; color: #ccc;">í‚¤ì›Œë“œ: ${scriptData.keyword}</p>
                        <p style="margin: 5px 0; color: #ccc;">ì˜ˆìƒ ì¡°íšŒìˆ˜: ${Math.floor(scriptData.estimatedViews/10000)}ë§Œ</p>
                    </div>
                    <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; border-left: 3px solid #4ecdc4;">
                        <pre style="margin: 0; font-size: 0.9em; line-height: 1.5; white-space: pre-wrap; color: #fff;">${scriptData.structure}</pre>
                    </div>
                `;
                
                copyBtn.style.display = 'inline-block';
                copyBtn.onclick = () => copyScript();
                
            } catch (error) {
                console.error('ìŠ¤í¬ë¦½íŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
                scriptContent.innerHTML = `<p style="color: #ff6b6b;">âŒ ìŠ¤í¬ë¦½íŠ¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}</p>`;
            }
        }

        // ìŠ¤í¬ë¦½íŠ¸ ë³µì‚¬ í•¨ìˆ˜
        function copyScript() {
            const scriptContent = document.getElementById('script-content');
            const text = scriptContent.innerText;
            navigator.clipboard.writeText(text).then(() => {
                alert('ìŠ¤í¬ë¦½íŠ¸ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            }).catch(err => {
                console.error('ë³µì‚¬ ì‹¤íŒ¨:', err);
                alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ìˆ˜ë™ìœ¼ë¡œ ë³µì‚¬í•´ì£¼ì„¸ìš”.');
            });
        }

        // AI ì¸ë„¤ì¼ í”„ë¡¬í”„íŠ¸ ìƒì„± í•¨ìˆ˜
        async function generateThumbnailPrompt() {
            if (!youtubeApp || !youtubeApp.benchmarkResults) {
                alert('ë¨¼ì € ë²¤ì¹˜ë§ˆí‚¹ ë¶„ì„ì„ ì™„ë£Œí•´ì£¼ì„¸ìš”.');
                return;
            }

            const promptContent = document.getElementById('thumbnail-prompt-content');
            const copyBtn = document.getElementById('copy-thumbnail-btn');

            try {
                promptContent.innerHTML = '<p style="color: #f093fb;">ğŸ¨ AIê°€ ì¸ë„¤ì¼ í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...</p>';
                
                const selectedVideos = Array.from(youtubeApp.selectedVideos).map(id => 
                    youtubeApp.currentResults.find(v => v.id.videoId === id)
                ).filter(Boolean);

                const prompt = await youtubeApp.generateAIThumbnailPrompt(selectedVideos);
                
                promptContent.innerHTML = `
                    <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; border-left: 3px solid #f093fb;">
                        <pre style="margin: 0; font-size: 0.9em; line-height: 1.5; white-space: pre-wrap; color: #fff;">${prompt}</pre>
                    </div>
                `;
                
                copyBtn.style.display = 'inline-block';
                copyBtn.onclick = () => copyThumbnailPrompt();
                
            } catch (error) {
                console.error('ì¸ë„¤ì¼ í”„ë¡¬í”„íŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
                promptContent.innerHTML = `<p style="color: #ff6b6b;">âŒ ì¸ë„¤ì¼ í”„ë¡¬í”„íŠ¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}</p>`;
            }
        }

        // ì¸ë„¤ì¼ í”„ë¡¬í”„íŠ¸ ë³µì‚¬ í•¨ìˆ˜
        function copyThumbnailPrompt() {
            const promptContent = document.getElementById('thumbnail-prompt-content');
            const text = promptContent.innerText;
            navigator.clipboard.writeText(text).then(() => {
                alert('ì¸ë„¤ì¼ í”„ë¡¬í”„íŠ¸ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            }).catch(err => {
                console.error('ë³µì‚¬ ì‹¤íŒ¨:', err);
                alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ìˆ˜ë™ìœ¼ë¡œ ë³µì‚¬í•´ì£¼ì„¸ìš”.');
            });
        }

        // Geminië¡œ ì¸ë„¤ì¼ ì´ë¯¸ì§€ ìƒì„± í•¨ìˆ˜
        async function generateThumbnailImage() {
            if (!youtubeApp || !youtubeApp.benchmarkResults) {
                alert('ë¨¼ì € ë²¤ì¹˜ë§ˆí‚¹ ë¶„ì„ì„ ì™„ë£Œí•´ì£¼ì„¸ìš”.');
                return;
            }

            const imageContent = document.getElementById('thumbnail-image-content');

            try {
                imageContent.innerHTML = '<p style="color: #ff6b6b;">ğŸ–¼ï¸ Geminiê°€ ì¸ë„¤ì¼ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...</p>';
                
                const selectedVideos = Array.from(youtubeApp.selectedVideos).map(id => 
                    youtubeApp.currentResults.find(v => v.id.videoId === id)
                ).filter(Boolean);

                const prompt = await youtubeApp.generateAIThumbnailPrompt(selectedVideos);
                const imageUrl = await youtubeApp.generateThumbnailWithGemini(prompt);
                
                if (imageUrl) {
                    imageContent.innerHTML = `
                        <div style="text-align: center;">
                            <h5 style="color: #ff6b6b; margin: 10px 0;">ìƒì„±ëœ ì¸ë„¤ì¼</h5>
                            <img src="${imageUrl}" alt="Generated Thumbnail" style="max-width: 100%; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.3);">
                            <div style="margin-top: 10px;">
                                <button onclick="window.open('${imageUrl}', '_blank')" style="background: #ff6b6b; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin-right: 10px;">ğŸ”— ìƒˆ íƒ­ì—ì„œ ë³´ê¸°</button>
                                <button onclick="downloadThumbnail('${imageUrl}')" style="background: #4ecdc4; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer;">ğŸ’¾ ë‹¤ìš´ë¡œë“œ</button>
                            </div>
                        </div>
                    `;
                } else {
                    imageContent.innerHTML = `
                        <div style="text-align: center; padding: 20px;">
                            <p style="color: #ffd700; margin: 10px 0;">âš ï¸ Gemini API ì—°ë™ ì¤€ë¹„ ì¤‘</p>
                            <p style="color: #ccc; font-size: 0.9em;">í˜„ì¬ëŠ” ì¸ë„¤ì¼ í”„ë¡¬í”„íŠ¸ë§Œ ìƒì„±ë©ë‹ˆë‹¤. ì‹¤ì œ ì´ë¯¸ì§€ ìƒì„±ì€ Gemini API ì—°ë™ í›„ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
                            <button onclick="generateThumbnailPrompt()" style="background: #f093fb; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin-top: 10px;">ğŸ¨ í”„ë¡¬í”„íŠ¸ ìƒì„±í•˜ê¸°</button>
                        </div>
                    `;
                }
                
            } catch (error) {
                console.error('ì¸ë„¤ì¼ ì´ë¯¸ì§€ ìƒì„± ì˜¤ë¥˜:', error);
                imageContent.innerHTML = `<p style="color: #ff6b6b;">âŒ ì¸ë„¤ì¼ ì´ë¯¸ì§€ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}</p>`;
            }
        }

        // ì¸ë„¤ì¼ ë‹¤ìš´ë¡œë“œ í•¨ìˆ˜
        function downloadThumbnail(imageUrl) {
            const link = document.createElement('a');
            link.href = imageUrl;
            link.download = `thumbnail_${Date.now()}.png`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        function quickSearch(query) {
            const searchInput = document.getElementById('searchQuery');
            if (searchInput) {
                searchInput.value = query;
                searchVideos();
            }
        }
        
        // Advanced Filters Functions
        function toggleAdvancedFilters() {
            const filtersContent = document.getElementById('advanced-filters');
            const toggleButton = document.querySelector('.advanced-filters-toggle');
            const toggleIcon = document.querySelector('.toggle-icon');
            
            if (filtersContent.style.display === 'none' || filtersContent.style.display === '') {
                filtersContent.style.display = 'block';
                toggleButton.classList.add('active');
                toggleIcon.style.transform = 'rotate(180deg)';
            } else {
                filtersContent.style.display = 'none';
                toggleButton.classList.remove('active');
                toggleIcon.style.transform = 'rotate(0deg)';
            }
        }
        
        function resetAdvancedFilters() {
            // Reset all filter dropdowns to their default values
            const filterIds = [
                'minViews', 'maxViews', 'minSubscribers', 'maxSubscribers',
                'minOutlierScore', 'minEngagementRate', 'minLikes', 
                'minComments', 'minRankGrade'
            ];
            
            filterIds.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.value = '';
                }
            });
            
            // Reset all custom input fields
            const customInputIds = [
                'minViewsCustom', 'maxViewsCustom', 'minSubscribersCustom', 
                'maxSubscribersCustom', 'minOutlierScoreCustom', 'minEngagementRateCustom',
                'minLikesCustom', 'minCommentsCustom'
            ];
            
            customInputIds.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.value = '';
                    element.style.display = 'none';
                }
            });
            
            console.log('Advanced filters reset');
        }
        
        function applyAdvancedFilters() {
            if (youtubeApp && youtubeApp.filteredResults && youtubeApp.filteredResults.length > 0) {
                youtubeApp.applyAdvancedFilters();
            } else {
                alert('ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ê²€ìƒ‰ì„ ì‹¤í–‰í•´ ì£¼ì„¸ìš”.');
            }
        }
        
        function openApiModal() {
            if (youtubeApp) {
                youtubeApp.openSettings();
            }
        }
        
        function closeApiModal() {
            if (youtubeApp) {
                youtubeApp.closeSettings();
            }
        }
        
        function saveApiKey() {
            if (youtubeApp) {
                youtubeApp.saveApiKey();
            }
        }
        
        function testApiKey() {
            if (youtubeApp) {
                youtubeApp.testApiKey();
            }
        }

        // AI API í‚¤ ê´€ë¦¬ í•¨ìˆ˜ë“¤
        function saveAIApiKey() {
            const apiKey = document.getElementById('ai-api-key').value.trim();
            if (apiKey) {
                localStorage.setItem('ai_api_key', apiKey);
                updateAIStatus('API í‚¤ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
                console.log('AI API í‚¤ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤');
            } else {
                updateAIStatus('ìœ íš¨í•œ API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”', 'error');
            }
        }

        function testAIApi() {
            const apiKey = localStorage.getItem('ai_api_key');
            if (!apiKey) {
                updateAIStatus('API í‚¤ë¥¼ ë¨¼ì € ì„¤ì •í•´ì£¼ì„¸ìš”', 'error');
                return;
            }

            updateAIStatus('AI API í…ŒìŠ¤íŠ¸ ì¤‘...', 'loading');
            
            // ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ ìš”ì²­
            fetch('https://api.openai.com/v1/models', {
                headers: {
                    'Authorization': `Bearer ${apiKey}`,
                    'Content-Type': 'application/json',
                }
            })
            .then(response => {
                if (response.ok) {
                    updateAIStatus('AI API ì—°ê²° ì„±ê³µ! âœ…', 'success');
                } else {
                    updateAIStatus('AI API ì—°ê²° ì‹¤íŒ¨ âŒ', 'error');
                }
            })
            .catch(error => {
                console.error('AI API í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜:', error);
                updateAIStatus('AI API ì—°ê²° ì˜¤ë¥˜ âŒ', 'error');
            });
        }

        function updateAIStatus(message, type) {
            const statusEl = document.getElementById('ai-status');
            const textEl = document.getElementById('ai-status-text');
            
            if (statusEl && textEl) {
                textEl.textContent = message;
                
                // ìƒíƒœì— ë”°ë¥¸ ìŠ¤íƒ€ì¼ ë³€ê²½
                statusEl.style.background = type === 'success' ? 'rgba(76, 175, 80, 0.2)' : 
                                          type === 'error' ? 'rgba(244, 67, 54, 0.2)' : 
                                          type === 'loading' ? 'rgba(255, 193, 7, 0.2)' : 
                                          'rgba(255,255,255,0.1)';
                
                textEl.style.color = type === 'success' ? '#4CAF50' : 
                                    type === 'error' ? '#F44336' : 
                                    type === 'loading' ? '#FFC107' : 
                                    'white';
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ AI API í‚¤ ìƒíƒœ í™•ì¸
        document.addEventListener('DOMContentLoaded', function() {
            const savedApiKey = localStorage.getItem('ai_api_key');
            if (savedApiKey) {
                const input = document.getElementById('ai-api-key');
                if (input) {
                    input.value = savedApiKey;
                }
                updateAIStatus('API í‚¤ê°€ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤', 'success');
            }
        });

        // Tab switching
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
        }

        // API Settings
        function openApiSettings() {
            document.getElementById('apiModal').classList.add('show');
            document.getElementById('apiKeyInput').value = apiKey;
        }

        function closeApiSettings() {
            document.getElementById('apiModal').classList.remove('show');
        }

        function saveApiKey() {
            apiKey = document.getElementById('apiKeyInput').value.trim();
            if (apiKey) {
                localStorage.setItem('youtube_api_key', apiKey);
                closeApiSettings();
                alert('API í‚¤ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
            } else {
                alert('ìœ íš¨í•œ API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
            }
        }

        // Utility functions
        function showLoading(elementId, show = true) {
            const element = document.getElementById(elementId);
            if (show) {
                element.classList.add('show');
            } else {
                element.classList.remove('show');
            }
        }

        function formatNumber(num) {
            if (num >= 1000000000) return (num / 1000000000).toFixed(1) + 'B';
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
            return num?.toString() || '0';
        }

        function escapeHtml(unsafe) {
            return unsafe
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }

        function formatDate(dateString) {
            if (!dateString) return 'N/A';
            const date = new Date(dateString);
            return date.toLocaleDateString('ko-KR', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit'
            });
        }

        function formatDuration(isoDuration) {
            const match = isoDuration.match(/PT(\d+H)?(\d+M)?(\d+S)?/);
            const hours = (match[1] || '').replace('H', '');
            const minutes = (match[2] || '').replace('M', '');
            const seconds = (match[3] || '').replace('S', '');
            
            if (hours) return `${hours}:${minutes.padStart(2, '0')}:${seconds.padStart(2, '0')}`;
            return `${minutes || '0'}:${seconds.padStart(2, '0')}`;
        }

        // Video search function
        async function searchVideos() {
            if (!apiKey) {
                alert('API í‚¤ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.');
                return;
            }

            // í‚¤ì›Œë“œ ì‹œìŠ¤í…œì—ì„œ ê²€ìƒ‰ì–´ ê°€ì ¸ì˜¤ê¸°
            const query = youtubeApp ? youtubeApp.getSearchQuery() : document.getElementById('searchQuery').value.trim();
            if (!query) {
                alert('ê²€ìƒ‰ í‚¤ì›Œë“œë¥¼ ì…ë ¥í•˜ê±°ë‚˜ í‚¤ì›Œë“œë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”.');
                return;
            }

            const order = document.getElementById('searchOrder').value;
            const publishedAfter = getPublishedAfter(document.getElementById('searchDuration').value);
            const maxResults = document.getElementById('searchMaxResults').value;

            showLoading('searchLoading', true);

            try {
                let url = `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${encodeURIComponent(query)}&type=video&order=${order}&maxResults=${maxResults}&key=${apiKey}`;
                
                if (publishedAfter) {
                    url += `&publishedAfter=${publishedAfter}`;
                }

                const response = await fetch(url);
                const data = await response.json();

                if (data.error) {
                    throw new Error(data.error.message);
                }

                if (!data.items?.length) {
                    throw new Error('ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.');
                }

                // Get video statistics
                const videoIds = data.items.map(item => item.id.videoId).join(',');
                const statsResponse = await fetch(
                    `https://www.googleapis.com/youtube/v3/videos?part=statistics,contentDetails&id=${videoIds}&key=${apiKey}`
                );
                const statsData = await statsResponse.json();

                displaySearchResults(data.items, statsData.items);
                
                analysisData.searches += 1;
                updateAnalytics();

            } catch (error) {
                alert('ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ' + error.message);
            }

            showLoading('searchLoading', false);
        }

        function getPublishedAfter(duration) {
            if (!duration) return null;
            
            const now = new Date();
            switch (duration) {
                case 'hour': return new Date(now - 3600000).toISOString();
                case 'today': return new Date(now.setHours(0,0,0,0)).toISOString();
                case 'week': return new Date(now - 7*24*3600000).toISOString();
                case 'month': return new Date(now - 30*24*3600000).toISOString();
                case 'year': return new Date(now - 365*24*3600000).toISOString();
                default: return null;
            }
        }

        function displaySearchResults(videos, stats) {
            const container = document.getElementById('searchResults');
            
            const videoCards = videos.map((video, index) => {
                const stat = stats[index] || {};
                const statistics = stat.statistics || {};
                const contentDetails = stat.contentDetails || {};
                
                return `
                    <div class="video-card" onclick="openVideo('${video.id.videoId}')">
                        <div class="video-thumbnail">
                            <img src="${video.snippet.thumbnails.medium?.url || video.snippet.thumbnails.default.url}" 
                                 alt="${escapeHtml(video.snippet.title)}">
                            ${contentDetails.duration ? `<div style="position: absolute; bottom: 8px; right: 8px; background: rgba(0,0,0,0.8); color: white; padding: 2px 6px; border-radius: 4px; font-size: 12px;">${formatDuration(contentDetails.duration)}</div>` : ''}
                        </div>
                        <div class="video-info">
                            <div class="video-title">${escapeHtml(video.snippet.title)}</div>
                            <div class="video-stats">
                                <span>ğŸ‘€ ${formatNumber(parseInt(statistics.viewCount || 0))}</span>
                                <span>ğŸ‘ ${formatNumber(parseInt(statistics.likeCount || 0))}</span>
                                <span>ğŸ’¬ ${formatNumber(parseInt(statistics.commentCount || 0))}</span>
                            </div>
                            <div style="margin-top: 8px; color: var(--text-tertiary); font-size: 0.85rem;">
                                ${escapeHtml(video.snippet.channelTitle)} â€¢ ${new Date(video.snippet.publishedAt).toLocaleDateString('ko-KR')}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            
            container.innerHTML = videoCards;
        }

        function openVideo(videoId) {
            window.open(`https://www.youtube.com/watch?v=${videoId}`, '_blank');
        }

        // Competitor analysis
        async function analyzeCompetitor() {
            if (!apiKey) {
                alert('API í‚¤ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.');
                return;
            }

            const channelName = document.getElementById('competitorChannel').value.trim();
            const analysisType = document.getElementById('competitorAnalysisType').value;
            
            if (!channelName) {
                alert('ì±„ë„ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            showLoading('competitorLoading', true);

            try {
                // Search for channels
                const searchResponse = await fetch(
                    `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${encodeURIComponent(channelName)}&type=channel&maxResults=3&key=${apiKey}`
                );
                const searchData = await searchResponse.json();

                if (searchData.error) {
                    throw new Error(searchData.error.message);
                }

                if (!searchData.items?.length) {
                    throw new Error('ì±„ë„ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }

                const competitorResults = [];

                // Analyze found channels
                for (const channel of searchData.items) {
                    const channelId = channel.snippet.channelId;
                    
                    // Get detailed channel info
                    const channelResponse = await fetch(
                        `https://www.googleapis.com/youtube/v3/channels?part=snippet,statistics,brandingSettings&id=${channelId}&key=${apiKey}`
                    );
                    const channelData = await channelResponse.json();
                    
                    if (!channelData.items?.length) continue;
                    
                    // Get recent videos
                    const videosResponse = await fetch(
                        `https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${channelId}&type=video&order=date&maxResults=50&key=${apiKey}`
                    );
                    const videosData = await videosResponse.json();
                    
                    if (!videosData.items?.length) continue;
                    
                    // Get video statistics
                    const videoIds = videosData.items.map(item => item.id.videoId).filter(Boolean).join(',');
                    let videoStats = [];
                    
                    if (videoIds) {
                        const videoStatsResponse = await fetch(
                            `https://www.googleapis.com/youtube/v3/videos?part=statistics,contentDetails&id=${videoIds}&key=${apiKey}`
                        );
                        const statsData = await videoStatsResponse.json();
                        videoStats = statsData.items || [];
                    }
                    
                    // Perform analysis
                    const analysis = performCompetitorAnalysis(
                        channelData.items[0], 
                        videosData.items, 
                        videoStats,
                        analysisType
                    );
                    
                    competitorResults.push(analysis);
                    
                    // Small delay to avoid rate limits
                    await new Promise(resolve => setTimeout(resolve, 200));
                }
                
                displayCompetitorResults(competitorResults, analysisType);
                
                analysisData.competitors += competitorResults.length;
                updateAnalytics();
                
            } catch (error) {
                console.error('Competitor analysis error:', error);
                alert('ê²½ìŸì ë¶„ì„ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ' + error.message);
            }

            showLoading('competitorLoading', false);
        }

        function performCompetitorAnalysis(channelInfo, videos, videoStats, analysisType) {
            const stats = channelInfo.statistics;
            
            // Merge video data with statistics
            const videoData = videos.map(video => {
                const matchingStat = videoStats.find(stat => stat.id === video.id?.videoId);
                return {
                    ...video,
                    statistics: matchingStat?.statistics || {},
                    contentDetails: matchingStat?.contentDetails || {}
                };
            });
            
            // Basic metrics
            const subscriberCount = parseInt(stats.subscriberCount || 0);
            const totalViews = parseInt(stats.viewCount || 0);
            const videoCount = parseInt(stats.videoCount || 0);
            
            // Video performance metrics
            const videoViews = videoData.map(v => parseInt(v.statistics.viewCount || 0));
            const videoLikes = videoData.map(v => parseInt(v.statistics.likeCount || 0));
            const videoComments = videoData.map(v => parseInt(v.statistics.commentCount || 0));
            
            const avgViews = videoViews.length ? videoViews.reduce((a, b) => a + b, 0) / videoViews.length : 0;
            const avgLikes = videoLikes.length ? videoLikes.reduce((a, b) => a + b, 0) / videoLikes.length : 0;
            const avgComments = videoComments.length ? videoComments.reduce((a, b) => a + b, 0) / videoComments.length : 0;
            
            // Engagement metrics
            const engagementRate = avgViews > 0 ? ((avgLikes + avgComments) / avgViews * 100) : 0;
            const likesPerView = avgViews > 0 ? (avgLikes / avgViews * 100) : 0;
            const commentsPerView = avgViews > 0 ? (avgComments / avgViews * 100) : 0;
            
            // Upload consistency
            const sortedVideos = videoData
                .filter(v => v.snippet?.publishedAt)
                .sort((a, b) => new Date(b.snippet.publishedAt) - new Date(a.snippet.publishedAt));
                
            let uploadFrequency = 0;
            if (sortedVideos.length > 1) {
                const daysDiff = (new Date(sortedVideos[0].snippet.publishedAt) - new Date(sortedVideos[sortedVideos.length - 1].snippet.publishedAt)) / (24 * 60 * 60 * 1000);
                uploadFrequency = sortedVideos.length / (daysDiff / 7); // videos per week
            }
            
            // Top performing content
            const topVideos = videoData
                .filter(v => v.statistics.viewCount)
                .sort((a, b) => parseInt(b.statistics.viewCount) - parseInt(a.statistics.viewCount))
                .slice(0, 10);
                
            // Content analysis
            const titleWords = videoData
                .map(v => v.snippet?.title || '')
                .join(' ')
                .toLowerCase()
                .replace(/[^\w\sê°€-í£]/g, ' ')
                .split(/\s+/)
                .filter(word => word.length > 2);
                
            const wordFreq = {};
            titleWords.forEach(word => {
                wordFreq[word] = (wordFreq[word] || 0) + 1;
            });
            
            const topKeywords = Object.entries(wordFreq)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 15)
                .map(([word, freq]) => ({ word, frequency: freq }));
            
            // Performance scoring
            const performanceScore = calculatePerformanceScore({
                subscriberCount,
                avgViews,
                engagementRate,
                uploadFrequency,
                videoCount
            });
            
            return {
                channelInfo,
                metrics: {
                    subscriberCount,
                    totalViews,
                    videoCount,
                    avgViews: Math.round(avgViews),
                    avgLikes: Math.round(avgLikes),
                    avgComments: Math.round(avgComments),
                    engagementRate: Math.round(engagementRate * 100) / 100,
                    likesPerView: Math.round(likesPerView * 100) / 100,
                    commentsPerView: Math.round(commentsPerView * 100) / 100,
                    uploadFrequency: Math.round(uploadFrequency * 10) / 10,
                    performanceScore
                },
                content: {
                    topVideos,
                    topKeywords,
                    recentVideos: sortedVideos.slice(0, 10)
                },
                insights: generateCompetitorInsights(channelInfo, {
                    subscriberCount,
                    avgViews,
                    engagementRate,
                    uploadFrequency,
                    topKeywords
                })
            };
        }

        function calculatePerformanceScore({ subscriberCount, avgViews, engagementRate, uploadFrequency, videoCount }) {
            let score = 0;
            
            // Subscriber score (0-25 points)
            if (subscriberCount >= 1000000) score += 25;
            else if (subscriberCount >= 100000) score += 20;
            else if (subscriberCount >= 10000) score += 15;
            else if (subscriberCount >= 1000) score += 10;
            else score += 5;
            
            // View performance score (0-30 points)
            const viewRatio = avgViews / (subscriberCount || 1);
            if (viewRatio >= 0.1) score += 30;
            else if (viewRatio >= 0.05) score += 25;
            else if (viewRatio >= 0.02) score += 20;
            else if (viewRatio >= 0.01) score += 15;
            else score += 10;
            
            // Engagement score (0-25 points)
            if (engagementRate >= 5) score += 25;
            else if (engagementRate >= 3) score += 20;
            else if (engagementRate >= 2) score += 15;
            else if (engagementRate >= 1) score += 10;
            else score += 5;
            
            // Consistency score (0-20 points)
            if (uploadFrequency >= 3) score += 20;
            else if (uploadFrequency >= 1) score += 15;
            else if (uploadFrequency >= 0.5) score += 10;
            else score += 5;
            
            return Math.round(score);
        }

        function generateCompetitorInsights(channelInfo, metrics) {
            const insights = [];
            const { subscriberCount, avgViews, engagementRate, uploadFrequency, topKeywords } = metrics;
            
            if (subscriberCount >= 1000000) {
                insights.push({ type: 'success', message: 'ëŒ€í˜• ì±„ë„ - ë¸Œëœë“œ íŒŒíŠ¸ë„ˆì‹­ ê¸°íšŒ ë§ìŒ' });
            } else if (subscriberCount >= 100000) {
                insights.push({ type: 'info', message: 'ì¤‘ê²¬ ì±„ë„ - ì•ˆì •ì ì¸ ìˆ˜ìµí™” ë‹¨ê³„' });
            } else {
                insights.push({ type: 'warning', message: 'ì„±ì¥ ë‹¨ê³„ ì±„ë„ - ë¹ ë¥¸ ì„±ì¥ ê°€ëŠ¥ì„±' });
            }
            
            if (engagementRate >= 3) {
                insights.push({ type: 'success', message: 'ë†’ì€ ì°¸ì—¬ë„ - ì¶©ì„±ë„ ë†’ì€ êµ¬ë…ìì¸µ' });
            } else if (engagementRate < 1) {
                insights.push({ type: 'warning', message: 'ë‚®ì€ ì°¸ì—¬ë„ - ì½˜í…ì¸  ê°œì„  í•„ìš”' });
            }
            
            if (uploadFrequency >= 3) {
                insights.push({ type: 'info', message: 'ë§¤ìš° í™œë°œí•œ ì—…ë¡œë“œ - ì•Œê³ ë¦¬ì¦˜ ì¹œí™”ì ' });
            } else if (uploadFrequency < 0.5) {
                insights.push({ type: 'warning', message: 'ì—…ë¡œë“œ ë¹ˆë„ ë‚®ìŒ - ì¼ê´€ì„± ê°œì„  í•„ìš”' });
            }
            
            if (topKeywords.length >= 10) {
                const mainKeyword = topKeywords[0].word;
                insights.push({ 
                    type: 'info', 
                    message: `ì£¼ë ¥ í‚¤ì›Œë“œ: "${mainKeyword}" - íŠ¹í™” ë¶„ì•¼ í™•ë¦½` 
                });
            }
            
            return insights;
        }

        function displayCompetitorResults(results, analysisType) {
            const container = document.getElementById('competitorResults');
            
            const resultHtml = results.map((result, index) => {
                const channel = result.channelInfo;
                const metrics = result.metrics;
                const insights = result.insights;
                
                return `
                    <div class="card">
                        <div class="card-header">
                            <h3>ğŸ“Š ${escapeHtml(channel.snippet.title)} ë¶„ì„ ê²°ê³¼</h3>
                            <div style="background: var(--bg-tertiary); padding: 8px 12px; border-radius: 6px; display: inline-block; margin-top: 8px;">
                                ì„±ê³¼ ì ìˆ˜: <strong style="color: var(--accent-primary);">${metrics.performanceScore}/100</strong>
                            </div>
                        </div>
                        
                        <div class="analytics-grid">
                            <div class="metric-card">
                                <div class="metric-value" style="color: var(--accent-primary);">${formatNumber(metrics.subscriberCount)}</div>
                                <div class="metric-label">êµ¬ë…ì</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-value" style="color: var(--accent-secondary);">${formatNumber(metrics.videoCount)}</div>
                                <div class="metric-label">ì´ ì˜ìƒ</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-value" style="color: var(--accent-tertiary);">${formatNumber(metrics.avgViews)}</div>
                                <div class="metric-label">í‰ê·  ì¡°íšŒìˆ˜</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-value" style="color: var(--success);">${metrics.engagementRate}%</div>
                                <div class="metric-label">ì°¸ì—¬ë„</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-value" style="color: var(--purple);">${metrics.uploadFrequency}</div>
                                <div class="metric-label">ì£¼ê°„ ì—…ë¡œë“œ</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-value" style="color: var(--pink);">${metrics.likesPerView}%</div>
                                <div class="metric-label">ì¢‹ì•„ìš” ë¹„ìœ¨</div>
                            </div>
                        </div>
                        
                        ${insights.length > 0 ? `
                        <div class="insights">
                            <h4 style="margin-bottom: 16px;">ğŸ’¡ í•µì‹¬ ì¸ì‚¬ì´íŠ¸</h4>
                            ${insights.map(insight => `
                                <div class="insight-item ${insight.type}">
                                    ${insight.type === 'success' ? 'âœ…' : insight.type === 'warning' ? 'âš ï¸' : 'â„¹ï¸'}
                                    ${insight.message}
                                </div>
                            `).join('')}
                        </div>
                        ` : ''}
                        
                        ${result.content.topKeywords.length > 0 ? `
                        <div style="margin-top: 24px;">
                            <h4 style="margin-bottom: 16px;">ğŸ”‘ ì£¼ìš” í‚¤ì›Œë“œ</h4>
                            <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                                ${result.content.topKeywords.slice(0, 10).map(keyword => `
                                    <span style="background: var(--bg-tertiary); padding: 6px 12px; border-radius: 20px; font-size: 0.9rem; border: 1px solid rgba(255,255,255,0.1);">
                                        ${escapeHtml(keyword.word)} (${keyword.frequency})
                                    </span>
                                `).join('')}
                            </div>
                        </div>
                        ` : ''}
                        
                        ${result.content.topVideos.length > 0 ? `
                        <div style="margin-top: 24px;">
                            <h4 style="margin-bottom: 16px;">ğŸ† ì¸ê¸° ì½˜í…ì¸ </h4>
                            <div class="results-grid">
                                ${result.content.topVideos.slice(0, 6).map(video => `
                                    <div class="video-card" onclick="openVideo('${video.id?.videoId || video.id}')">
                                        <div class="video-thumbnail">
                                            <img src="${video.snippet.thumbnails.medium?.url || video.snippet.thumbnails.default.url}" 
                                                 alt="${escapeHtml(video.snippet.title)}">
                                        </div>
                                        <div class="video-info">
                                            <div class="video-title">${escapeHtml(video.snippet.title)}</div>
                                            <div class="video-stats">
                                                <span>ğŸ‘€ ${formatNumber(parseInt(video.statistics.viewCount || 0))}</span>
                                                <span>ğŸ‘ ${formatNumber(parseInt(video.statistics.likeCount || 0))}</span>
                                            </div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
            
            container.innerHTML = resultHtml;
        }

        // Trending analysis
        async function analyzeTrending() {
            if (!apiKey) {
                alert('API í‚¤ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.');
                return;
            }

            const categoryId = document.getElementById('trendingCategory').value;
            const regionCode = document.getElementById('trendingRegion').value;

            showLoading('trendingLoading', true);

            try {
                let url = `https://www.googleapis.com/youtube/v3/videos?part=snippet,statistics,contentDetails&chart=mostPopular&regionCode=${regionCode}&maxResults=50&key=${apiKey}`;
                
                if (categoryId) {
                    url += `&videoCategoryId=${categoryId}`;
                }

                const response = await fetch(url);
                const data = await response.json();

                if (data.error) {
                    throw new Error(data.error.message);
                }

                if (!data.items?.length) {
                    throw new Error('íŠ¸ë Œë”© ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }

                displayTrendingResults(data.items);
                
                analysisData.trends += 1;
                updateAnalytics();

            } catch (error) {
                alert('íŠ¸ë Œë“œ ë¶„ì„ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ' + error.message);
            }

            showLoading('trendingLoading', false);
        }

        function displayTrendingResults(videos) {
            const container = document.getElementById('trendingResults');
            
            // Analyze trending patterns
            const trendAnalysis = analyzeTrendingPatterns(videos);
            
            const resultsHtml = `
                <div class="card">
                    <div class="card-header">
                        <h3>ğŸ”¥ íŠ¸ë Œë“œ ë¶„ì„ ê²°ê³¼</h3>
                    </div>
                    
                    <div class="analytics-grid">
                        <div class="metric-card">
                            <div class="metric-value" style="color: var(--accent-primary);">${formatNumber(trendAnalysis.totalViews)}</div>
                            <div class="metric-label">ì´ ì¡°íšŒìˆ˜</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" style="color: var(--accent-secondary);">${formatNumber(trendAnalysis.avgViews)}</div>
                            <div class="metric-label">í‰ê·  ì¡°íšŒìˆ˜</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" style="color: var(--accent-tertiary);">${trendAnalysis.avgEngagement.toFixed(2)}%</div>
                            <div class="metric-label">í‰ê·  ì°¸ì—¬ë„</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" style="color: var(--success);">${trendAnalysis.shortFormCount}</div>
                            <div class="metric-label">ìˆí¼ ì½˜í…ì¸ </div>
                        </div>
                    </div>
                    
                    ${trendAnalysis.topKeywords.length > 0 ? `
                    <div style="margin: 24px 0;">
                        <h4 style="margin-bottom: 16px;">ğŸ”‘ íŠ¸ë Œë”© í‚¤ì›Œë“œ</h4>
                        <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                            ${trendAnalysis.topKeywords.slice(0, 15).map(keyword => `
                                <span style="background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); padding: 8px 16px; border-radius: 20px; font-size: 0.9rem; color: white;">
                                    ${escapeHtml(keyword.word)} (${keyword.frequency})
                                </span>
                            `).join('')}
                        </div>
                    </div>
                    ` : ''}
                    
                    <div style="margin-top: 24px;">
                        <h4 style="margin-bottom: 16px;">ğŸ“Š ì¹´í…Œê³ ë¦¬ë³„ ë¶„í¬</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                            ${Object.entries(trendAnalysis.categoryDistribution).map(([category, count]) => `
                                <div style="background: var(--bg-tertiary); padding: 16px; border-radius: 8px; text-align: center;">
                                    <div style="font-size: 1.5rem; font-weight: bold; color: var(--accent-primary);">${count}</div>
                                    <div style="color: var(--text-secondary); font-size: 0.9rem;">${getCategoryName(category)}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3>ğŸ† íŠ¸ë Œë”© ì˜ìƒ</h3>
                    </div>
                    <div class="results-grid">
                        ${videos.slice(0, 20).map(video => `
                            <div class="video-card" onclick="openVideo('${video.id}')">
                                <div class="video-thumbnail">
                                    <img src="${video.snippet.thumbnails.medium?.url || video.snippet.thumbnails.default.url}" 
                                         alt="${escapeHtml(video.snippet.title)}">
                                    <div style="position: absolute; bottom: 8px; right: 8px; background: rgba(0,0,0,0.8); color: white; padding: 2px 6px; border-radius: 4px; font-size: 12px;">
                                        ${formatDuration(video.contentDetails.duration)}
                                    </div>
                                </div>
                                <div class="video-info">
                                    <div class="video-title">${escapeHtml(video.snippet.title)}</div>
                                    <div class="video-stats">
                                        <span>ğŸ‘€ ${formatNumber(parseInt(video.statistics.viewCount || 0))}</span>
                                        <span>ğŸ‘ ${formatNumber(parseInt(video.statistics.likeCount || 0))}</span>
                                        <span>ğŸ’¬ ${formatNumber(parseInt(video.statistics.commentCount || 0))}</span>
                                    </div>
                                    <div style="margin-top: 8px; color: var(--text-tertiary); font-size: 0.85rem;">
                                        ${escapeHtml(video.snippet.channelTitle)} â€¢ ${new Date(video.snippet.publishedAt).toLocaleDateString('ko-KR')}
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            container.innerHTML = resultsHtml;
        }

        function analyzeTrendingPatterns(videos) {
            const totalViews = videos.reduce((sum, video) => sum + parseInt(video.statistics.viewCount || 0), 0);
            const avgViews = totalViews / videos.length;
            
            // Calculate average engagement
            const engagements = videos.map(video => {
                const views = parseInt(video.statistics.viewCount || 0);
                const likes = parseInt(video.statistics.likeCount || 0);
                const comments = parseInt(video.statistics.commentCount || 0);
                return views > 0 ? ((likes + comments) / views * 100) : 0;
            });
            const avgEngagement = engagements.reduce((sum, eng) => sum + eng, 0) / engagements.length;
            
            // Count short-form content (under 1 minute)
            const shortFormCount = videos.filter(video => {
                const duration = video.contentDetails.duration;
                const match = duration.match(/PT(\d+M)?(\d+S)?/);
                const minutes = parseInt((match[1] || '0').replace('M', '')) || 0;
                const seconds = parseInt((match[2] || '0').replace('S', '')) || 0;
                return minutes === 0 && seconds < 60;
            }).length;
            
            // Analyze keywords from titles
            const titleWords = videos
                .map(video => video.snippet.title)
                .join(' ')
                .toLowerCase()
                .replace(/[^\w\sê°€-í£]/g, ' ')
                .split(/\s+/)
                .filter(word => word.length > 2);
                
            const wordFreq = {};
            titleWords.forEach(word => {
                wordFreq[word] = (wordFreq[word] || 0) + 1;
            });
            
            const topKeywords = Object.entries(wordFreq)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 20)
                .map(([word, freq]) => ({ word, frequency: freq }));
            
            // Category distribution
            const categoryDistribution = {};
            videos.forEach(video => {
                const category = video.snippet.categoryId;
                categoryDistribution[category] = (categoryDistribution[category] || 0) + 1;
            });
            
            return {
                totalViews,
                avgViews: Math.round(avgViews),
                avgEngagement,
                shortFormCount,
                topKeywords,
                categoryDistribution
            };
        }

        function getCategoryName(categoryId) {
            const categories = {
                '1': 'ì˜í™”/ì• ë‹ˆë©”ì´ì…˜',
                '2': 'ìë™ì°¨',
                '10': 'ìŒì•…',
                '15': 'ì• ì™„ë™ë¬¼',
                '17': 'ìŠ¤í¬ì¸ ',
                '19': 'ì—¬í–‰/ì´ë²¤íŠ¸',
                '20': 'ê²Œì„',
                '22': 'ì‚¬ëŒ/ë¸”ë¡œê·¸',
                '23': 'ì½”ë¯¸ë””',
                '24': 'ì—”í„°í…Œì¸ë¨¼íŠ¸',
                '25': 'ë‰´ìŠ¤/ì •ì¹˜',
                '26': 'ë…¸í•˜ìš°/ìŠ¤íƒ€ì¼',
                '27': 'êµìœ¡',
                '28': 'ê³¼í•™ê¸°ìˆ '
            };
            return categories[categoryId] || `ì¹´í…Œê³ ë¦¬ ${categoryId}`;
        }

        // Channel analysis
        async function analyzeChannel() {
            if (!apiKey) {
                alert('API í‚¤ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.');
                return;
            }

            const channelName = document.getElementById('channelName').value.trim();
            const period = parseInt(document.getElementById('channelPeriod').value);
            
            if (!channelName) {
                alert('ì±„ë„ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            showLoading('channelLoading', true);

            try {
                // Search for channel
                const searchResponse = await fetch(
                    `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${encodeURIComponent(channelName)}&type=channel&maxResults=1&key=${apiKey}`
                );
                const searchData = await searchResponse.json();

                if (searchData.error) {
                    throw new Error(searchData.error.message);
                }

                if (!searchData.items?.length) {
                    throw new Error('ì±„ë„ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }

                const channelId = searchData.items[0].snippet.channelId;
                
                // Get detailed channel info
                const channelResponse = await fetch(
                    `https://www.googleapis.com/youtube/v3/channels?part=snippet,statistics,brandingSettings&id=${channelId}&key=${apiKey}`
                );
                const channelData = await channelResponse.json();
                
                // Get videos from specified period
                const cutoffDate = new Date();
                cutoffDate.setDate(cutoffDate.getDate() - period);
                
                const videosResponse = await fetch(
                    `https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${channelId}&type=video&order=date&maxResults=50&publishedAfter=${cutoffDate.toISOString()}&key=${apiKey}`
                );
                const videosData = await videosResponse.json();
                
                if (!videosData.items?.length) {
                    throw new Error('í•´ë‹¹ ê¸°ê°„ ë‚´ ì˜ìƒì´ ì—†ìŠµë‹ˆë‹¤.');
                }
                
                // Get video statistics
                const videoIds = videosData.items.map(item => item.id.videoId).join(',');
                const videoStatsResponse = await fetch(
                    `https://www.googleapis.com/youtube/v3/videos?part=statistics,contentDetails&id=${videoIds}&key=${apiKey}`
                );
                const videoStatsData = await videoStatsResponse.json();
                
                // Perform comprehensive channel analysis
                const analysis = performChannelAnalysis(
                    channelData.items[0],
                    videosData.items,
                    videoStatsData.items,
                    period
                );
                
                displayChannelResults(analysis);
                
                analysisData.channels += 1;
                updateAnalytics();

            } catch (error) {
                alert('ì±„ë„ ë¶„ì„ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ' + error.message);
            }

            showLoading('channelLoading', false);
        }

        function performChannelAnalysis(channelInfo, videos, videoStats, period) {
            // Merge video data with statistics
            const videoData = videos.map(video => {
                const matchingStat = videoStats.find(stat => stat.id === video.id.videoId);
                return {
                    ...video,
                    statistics: matchingStat?.statistics || {},
                    contentDetails: matchingStat?.contentDetails || {}
                };
            });
            
            // Performance metrics
            const totalViews = videoData.reduce((sum, video) => sum + parseInt(video.statistics.viewCount || 0), 0);
            const totalLikes = videoData.reduce((sum, video) => sum + parseInt(video.statistics.likeCount || 0), 0);
            const totalComments = videoData.reduce((sum, video) => sum + parseInt(video.statistics.commentCount || 0), 0);
            
            const avgViews = videoData.length ? totalViews / videoData.length : 0;
            const avgLikes = videoData.length ? totalLikes / videoData.length : 0;
            const avgComments = videoData.length ? totalComments / videoData.length : 0;
            
            // Growth metrics
            const sortedVideos = videoData.sort((a, b) => new Date(a.snippet.publishedAt) - new Date(b.snippet.publishedAt));
            
            let viewGrowthRate = 0;
            if (sortedVideos.length >= 10) {
                const firstHalfAvg = sortedVideos.slice(0, Math.floor(sortedVideos.length / 2))
                    .reduce((sum, video) => sum + parseInt(video.statistics.viewCount || 0), 0) / Math.floor(sortedVideos.length / 2);
                const secondHalfAvg = sortedVideos.slice(Math.floor(sortedVideos.length / 2))
                    .reduce((sum, video) => sum + parseInt(video.statistics.viewCount || 0), 0) / Math.ceil(sortedVideos.length / 2);
                
                viewGrowthRate = firstHalfAvg > 0 ? ((secondHalfAvg - firstHalfAvg) / firstHalfAvg * 100) : 0;
            }
            
            // Content analysis
            const uploadSchedule = analyzeUploadSchedule(videoData);
            const contentTypes = analyzeContentTypes(videoData);
            const bestPerformingContent = videoData
                .sort((a, b) => parseInt(b.statistics.viewCount || 0) - parseInt(a.statistics.viewCount || 0))
                .slice(0, 10);
            
            // SEO and keyword analysis
            const titleKeywords = extractKeywords(videoData.map(v => v.snippet.title));
            const descriptionKeywords = extractKeywords(videoData.map(v => v.snippet.description || ''));
            
            return {
                channelInfo,
                period,
                metrics: {
                    totalVideos: videoData.length,
                    totalViews,
                    totalLikes,
                    totalComments,
                    avgViews: Math.round(avgViews),
                    avgLikes: Math.round(avgLikes),
                    avgComments: Math.round(avgComments),
                    viewGrowthRate: Math.round(viewGrowthRate * 100) / 100
                },
                content: {
                    uploadSchedule,
                    contentTypes,
                    bestPerformingContent,
                    titleKeywords: titleKeywords.slice(0, 15),
                    descriptionKeywords: descriptionKeywords.slice(0, 10)
                },
                insights: generateChannelInsights(channelInfo, {
                    avgViews,
                    viewGrowthRate,
                    videoCount: videoData.length,
                    period
                })
            };
        }

        function analyzeUploadSchedule(videoData) {
            const dayOfWeek = {};
            const hourOfDay = {};
            
            videoData.forEach(video => {
                const date = new Date(video.snippet.publishedAt);
                const day = date.getDay(); // 0 = Sunday
                const hour = date.getHours();
                
                dayOfWeek[day] = (dayOfWeek[day] || 0) + 1;
                hourOfDay[hour] = (hourOfDay[hour] || 0) + 1;
            });
            
            const days = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
            const bestDay = Object.entries(dayOfWeek).sort(([,a], [,b]) => b - a)[0];
            const bestHour = Object.entries(hourOfDay).sort(([,a], [,b]) => b - a)[0];
            
            return {
                bestDay: bestDay ? days[bestDay[0]] : 'ë°ì´í„° ì—†ìŒ',
                bestHour: bestHour ? `${bestHour[0]}ì‹œ` : 'ë°ì´í„° ì—†ìŒ',
                consistency: videoData.length > 5 ? 'ê·œì¹™ì ' : 'ë¶ˆê·œì¹™ì '
            };
        }

        function analyzeContentTypes(videoData) {
            const durations = { short: 0, medium: 0, long: 0 };
            
            videoData.forEach(video => {
                const duration = video.contentDetails?.duration;
                if (!duration) return;
                
                const match = duration.match(/PT(\d+H)?(\d+M)?(\d+S)?/);
                const hours = parseInt((match[1] || '0').replace('H', '')) || 0;
                const minutes = parseInt((match[2] || '0').replace('M', '')) || 0;
                const totalMinutes = hours * 60 + minutes;
                
                if (totalMinutes < 5) durations.short++;
                else if (totalMinutes < 20) durations.medium++;
                else durations.long++;
            });
            
            return durations;
        }

        function extractKeywords(textArray) {
            const words = textArray
                .join(' ')
                .toLowerCase()
                .replace(/[^\w\sê°€-í£]/g, ' ')
                .split(/\s+/)
                .filter(word => word.length > 2);
                
            const wordFreq = {};
            words.forEach(word => {
                wordFreq[word] = (wordFreq[word] || 0) + 1;
            });
            
            return Object.entries(wordFreq)
                .sort(([,a], [,b]) => b - a)
                .map(([word, freq]) => ({ word, frequency: freq }));
        }

        function generateChannelInsights(channelInfo, metrics) {
            const insights = [];
            const { avgViews, viewGrowthRate, videoCount, period } = metrics;
            
            // Upload frequency insight
            const uploadsPerDay = videoCount / period;
            if (uploadsPerDay >= 1) {
                insights.push({ type: 'success', message: 'ë§¤ìš° í™œë°œí•œ ì—…ë¡œë“œ ìŠ¤ì¼€ì¤„' });
            } else if (uploadsPerDay >= 0.2) {
                insights.push({ type: 'info', message: 'ê·œì¹™ì ì¸ ì—…ë¡œë“œ íŒ¨í„´' });
            } else {
                insights.push({ type: 'warning', message: 'ì—…ë¡œë“œ ë¹ˆë„ ê°œì„  í•„ìš”' });
            }
            
            // Growth insight
            if (viewGrowthRate > 20) {
                insights.push({ type: 'success', message: `ê°•í•œ ì„±ì¥ì„¸ (+${viewGrowthRate.toFixed(1)}%)` });
            } else if (viewGrowthRate > 0) {
                insights.push({ type: 'info', message: `ì•ˆì •ì  ì„±ì¥ (+${viewGrowthRate.toFixed(1)}%)` });
            } else if (viewGrowthRate < -10) {
                insights.push({ type: 'warning', message: `ì¡°íšŒìˆ˜ ê°ì†Œ ì¶”ì„¸ (${viewGrowthRate.toFixed(1)}%)` });
            }
            
            return insights;
        }

        function displayChannelResults(analysis) {
            const container = document.getElementById('channelResults');
            const channel = analysis.channelInfo;
            const metrics = analysis.metrics;
            
            const resultHtml = `
                <div class="card">
                    <div class="card-header">
                        <h3>ğŸ“º ${escapeHtml(channel.snippet.title)} ì±„ë„ ë¶„ì„</h3>
                        <p style="color: var(--text-secondary); margin-top: 8px;">
                            ìµœê·¼ ${analysis.period}ì¼ ê¸°ê°„ ë¶„ì„ ê²°ê³¼
                        </p>
                    </div>
                    
                    <div class="analytics-grid">
                        <div class="metric-card">
                            <div class="metric-value" style="color: var(--accent-primary);">${metrics.totalVideos}</div>
                            <div class="metric-label">ì—…ë¡œë“œ ì˜ìƒ</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" style="color: var(--accent-secondary);">${formatNumber(metrics.totalViews)}</div>
                            <div class="metric-label">ì´ ì¡°íšŒìˆ˜</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" style="color: var(--accent-tertiary);">${formatNumber(metrics.avgViews)}</div>
                            <div class="metric-label">í‰ê·  ì¡°íšŒìˆ˜</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" style="color: var(--success);">${metrics.viewGrowthRate > 0 ? '+' : ''}${metrics.viewGrowthRate}%</div>
                            <div class="metric-label">ì„±ì¥ë¥ </div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" style="color: var(--purple);">${formatNumber(metrics.avgLikes)}</div>
                            <div class="metric-label">í‰ê·  ì¢‹ì•„ìš”</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" style="color: var(--pink);">${formatNumber(metrics.avgComments)}</div>
                            <div class="metric-label">í‰ê·  ëŒ“ê¸€</div>
                        </div>
                    </div>
                    
                    ${analysis.insights.length > 0 ? `
                    <div class="insights">
                        <h4 style="margin-bottom: 16px;">ğŸ’¡ í•µì‹¬ ì¸ì‚¬ì´íŠ¸</h4>
                        ${analysis.insights.map(insight => `
                            <div class="insight-item ${insight.type}">
                                ${insight.type === 'success' ? 'âœ…' : insight.type === 'warning' ? 'âš ï¸' : 'â„¹ï¸'}
                                ${insight.message}
                            </div>
                        `).join('')}
                    </div>
                    ` : ''}
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 24px; margin-top: 24px;">
                        <div>
                            <h4 style="margin-bottom: 16px;">ğŸ“… ì—…ë¡œë“œ íŒ¨í„´</h4>
                            <div style="background: var(--bg-tertiary); padding: 16px; border-radius: 8px;">
                                <p>ìµœì  ìš”ì¼: <strong>${analysis.content.uploadSchedule.bestDay}</strong></p>
                                <p>ìµœì  ì‹œê°„: <strong>${analysis.content.uploadSchedule.bestHour}</strong></p>
                                <p>ì¼ê´€ì„±: <strong>${analysis.content.uploadSchedule.consistency}</strong></p>
                            </div>
                        </div>
                        
                        <div>
                            <h4 style="margin-bottom: 16px;">ğŸ“Š ì½˜í…ì¸  ìœ í˜•</h4>
                            <div style="background: var(--bg-tertiary); padding: 16px; border-radius: 8px;">
                                <p>ìˆí¼ (5ë¶„ ë¯¸ë§Œ): <strong>${analysis.content.contentTypes.short}ê°œ</strong></p>
                                <p>ë¯¸ë””ì›€ (5-20ë¶„): <strong>${analysis.content.contentTypes.medium}ê°œ</strong></p>
                                <p>ë¡±í¼ (20ë¶„ ì´ìƒ): <strong>${analysis.content.contentTypes.long}ê°œ</strong></p>
                            </div>
                        </div>
                    </div>
                    
                    ${analysis.content.titleKeywords.length > 0 ? `
                    <div style="margin-top: 24px;">
                        <h4 style="margin-bottom: 16px;">ğŸ”‘ ì£¼ìš” í‚¤ì›Œë“œ</h4>
                        <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                            ${analysis.content.titleKeywords.map(keyword => `
                                <span style="background: var(--bg-tertiary); padding: 6px 12px; border-radius: 20px; font-size: 0.9rem; border: 1px solid rgba(255,255,255,0.1);">
                                    ${escapeHtml(keyword.word)} (${keyword.frequency})
                                </span>
                            `).join('')}
                        </div>
                    </div>
                    ` : ''}
                </div>
                
                ${analysis.content.bestPerformingContent.length > 0 ? `
                <div class="card">
                    <div class="card-header">
                        <h3>ğŸ† ìµœê³  ì„±ê³¼ ì½˜í…ì¸ </h3>
                    </div>
                    <div class="results-grid">
                        ${analysis.content.bestPerformingContent.slice(0, 6).map(video => `
                            <div class="video-card" onclick="openVideo('${video.id.videoId}')">
                                <div class="video-thumbnail">
                                    <img src="${video.snippet.thumbnails.medium?.url || video.snippet.thumbnails.default.url}" 
                                         alt="${escapeHtml(video.snippet.title)}">
                                    ${video.contentDetails?.duration ? `<div style="position: absolute; bottom: 8px; right: 8px; background: rgba(0,0,0,0.8); color: white; padding: 2px 6px; border-radius: 4px; font-size: 12px;">${formatDuration(video.contentDetails.duration)}</div>` : ''}
                                </div>
                                <div class="video-info">
                                    <div class="video-title">${escapeHtml(video.snippet.title)}</div>
                                    <div class="video-stats">
                                        <span>ğŸ‘€ ${formatNumber(parseInt(video.statistics.viewCount || 0))}</span>
                                        <span>ğŸ‘ ${formatNumber(parseInt(video.statistics.likeCount || 0))}</span>
                                        <span>ğŸ’¬ ${formatNumber(parseInt(video.statistics.commentCount || 0))}</span>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                ` : ''}
            `;
            
            container.innerHTML = resultHtml;
        }

        // Keyword mining
        async function mineKeywords() {
            if (!apiKey) {
                alert('API í‚¤ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.');
                return;
            }

            const seedKeyword = document.getElementById('keywordSeed').value.trim();
            const method = document.getElementById('keywordMethod').value;
            const count = parseInt(document.getElementById('keywordCount').value);
            
            if (!seedKeyword) {
                alert('ê¸°ë³¸ í‚¤ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            showLoading('keywordsLoading', true);

            try {
                let keywords = [];
                
                switch (method) {
                    case 'related':
                        keywords = await generateRelatedKeywords(seedKeyword, count);
                        break;
                    case 'trending':
                        keywords = await findTrendingKeywords(seedKeyword, count);
                        break;
                    case 'competitor':
                        keywords = await analyzeCompetitorKeywords(seedKeyword, count);
                        break;
                }
                
                displayKeywordResults(keywords, method, seedKeyword);
                
                analysisData.keywords += 1;
                updateAnalytics();

            } catch (error) {
                alert('í‚¤ì›Œë“œ ë§ˆì´ë‹ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ' + error.message);
            }

            showLoading('keywordsLoading', false);
        }

        async function generateRelatedKeywords(seedKeyword, count) {
            // Generate variations of the seed keyword
            const variations = [
                `${seedKeyword} íŠœí† ë¦¬ì–¼`,
                `${seedKeyword} ê°•ì˜`,
                `${seedKeyword} ë°©ë²•`,
                `${seedKeyword} ì´ˆë³´`,
                `${seedKeyword} ê³ ê¸‰`,
                `${seedKeyword} ì‹¤ë¬´`,
                `${seedKeyword} ê¸°ì´ˆ`,
                `${seedKeyword} ì™„ë²½`,
                `${seedKeyword} ê°€ì´ë“œ`,
                `${seedKeyword} ë°°ìš°ê¸°`,
                `${seedKeyword} ë§ˆìŠ¤í„°`,
                `${seedKeyword} í”„ë¡œ`,
                `${seedKeyword} íŒ`,
                `${seedKeyword} ë…¸í•˜ìš°`,
                `${seedKeyword} ë¹„ë²•`,
                `${seedKeyword} ì „ë¬¸`,
                `${seedKeyword} ì…ë¬¸`,
                `${seedKeyword} ì‹œì‘`,
                `${seedKeyword} í™œìš©`,
                `${seedKeyword} ì‘ìš©`
            ];
            
            const results = [];
            
            // Search for each variation to get performance data
            for (let i = 0; i < Math.min(variations.length, count); i++) {
                const keyword = variations[i];
                
                try {
                    const response = await fetch(
                        `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${encodeURIComponent(keyword)}&type=video&maxResults=10&key=${apiKey}`
                    );
                    const data = await response.json();
                    
                    if (data.items?.length) {
                        // Get video statistics to calculate metrics
                        const videoIds = data.items.map(item => item.id.videoId).join(',');
                        const statsResponse = await fetch(
                            `https://www.googleapis.com/youtube/v3/videos?part=statistics&id=${videoIds}&key=${apiKey}`
                        );
                        const statsData = await statsResponse.json();
                        
                        const avgViews = statsData.items?.length ? 
                            statsData.items.reduce((sum, item) => sum + parseInt(item.statistics.viewCount || 0), 0) / statsData.items.length : 0;
                        
                        const competition = data.items.length >= 10 ? 'ë†’ìŒ' : data.items.length >= 5 ? 'ì¤‘ê°„' : 'ë‚®ìŒ';
                        
                        results.push({
                            keyword,
                            searchVolume: data.items.length,
                            avgViews: Math.round(avgViews),
                            competition,
                            competitionScore: data.items.length,
                            opportunity: calculateOpportunityScore(avgViews, data.items.length)
                        });
                    }
                    
                    // Small delay to avoid rate limits
                    await new Promise(resolve => setTimeout(resolve, 100));
                    
                } catch (error) {
                    console.error(`Error processing keyword: ${keyword}`, error);
                }
            }
            
            return results.sort((a, b) => b.opportunity - a.opportunity);
        }

        async function findTrendingKeywords(seedKeyword, count) {
            // Get trending videos and extract keywords related to seed
            const response = await fetch(
                `https://www.googleapis.com/youtube/v3/videos?part=snippet&chart=mostPopular&regionCode=KR&maxResults=50&key=${apiKey}`
            );
            const data = await response.json();
            
            if (!data.items?.length) {
                throw new Error('íŠ¸ë Œë”© ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
            
            // Extract keywords from trending video titles
            const keywords = new Set();
            data.items.forEach(video => {
                const title = video.snippet.title.toLowerCase();
                if (title.includes(seedKeyword.toLowerCase())) {
                    const words = title.split(/\s+/).filter(word => 
                        word.length > 2 && 
                        !['the', 'and', 'for', 'are', 'but', 'not', 'you', 'all', 'can', 'had', 'her', 'was', 'one', 'our', 'out', 'day', 'get', 'has', 'him', 'his', 'how', 'its', 'new', 'now', 'old', 'see', 'two', 'who', 'boy', 'did', 'ê·¸ë¦¬ê³ ', 'í•˜ì§€ë§Œ', 'ê·¸ë˜ì„œ', 'ê·¸ëŸ°ë°'].includes(word.toLowerCase())
                    );
                    words.forEach(word => {
                        if (word.length > 2) {
                            keywords.add(`${seedKeyword} ${word}`);
                        }
                    });
                }
            });
            
            const results = [];
            const keywordArray = Array.from(keywords).slice(0, count);
            
            for (const keyword of keywordArray) {
                try {
                    const searchResponse = await fetch(
                        `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${encodeURIComponent(keyword)}&type=video&maxResults=5&key=${apiKey}`
                    );
                    const searchData = await searchResponse.json();
                    
                    if (searchData.items?.length) {
                        const competition = searchData.items.length >= 5 ? 'ë†’ìŒ' : 'ë‚®ìŒ';
                        const trendScore = Math.random() * 100; // Simulated trend score
                        
                        results.push({
                            keyword,
                            searchVolume: searchData.items.length,
                            avgViews: 0, // Would need additional API calls
                            competition,
                            competitionScore: searchData.items.length,
                            trendScore: Math.round(trendScore),
                            opportunity: trendScore
                        });
                    }
                    
                    await new Promise(resolve => setTimeout(resolve, 100));
                    
                } catch (error) {
                    console.error(`Error processing trending keyword: ${keyword}`, error);
                }
            }
            
            return results.sort((a, b) => b.trendScore - a.trendScore);
        }

        async function analyzeCompetitorKeywords(seedKeyword, count) {
            // Search for channels related to seed keyword
            const channelResponse = await fetch(
                `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${encodeURIComponent(seedKeyword)}&type=channel&maxResults=5&key=${apiKey}`
            );
            const channelData = await channelResponse.json();
            
            if (!channelData.items?.length) {
                throw new Error('ê´€ë ¨ ì±„ë„ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
            
            const allKeywords = [];
            
            // Analyze keywords from competitor channels
            for (const channel of channelData.items.slice(0, 3)) {
                const channelId = channel.snippet.channelId;
                
                // Get channel's recent videos
                const videosResponse = await fetch(
                    `https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${channelId}&type=video&order=date&maxResults=20&key=${apiKey}`
                );
                const videosData = await videosResponse.json();
                
                if (videosData.items?.length) {
                    // Extract keywords from video titles
                    videosData.items.forEach(video => {
                        const title = video.snippet.title;
                        const words = title.toLowerCase()
                            .replace(/[^\w\sê°€-í£]/g, ' ')
                            .split(/\s+/)
                            .filter(word => word.length > 2);
                        
                        words.forEach(word => {
                            allKeywords.push(word);
                        });
                    });
                }
                
                await new Promise(resolve => setTimeout(resolve, 200));
            }
            
            // Count keyword frequency
            const keywordFreq = {};
            allKeywords.forEach(keyword => {
                keywordFreq[keyword] = (keywordFreq[keyword] || 0) + 1;
            });
            
            // Get top keywords and analyze them
            const topKeywords = Object.entries(keywordFreq)
                .sort(([,a], [,b]) => b - a)
                .slice(0, count)
                .map(([word, freq]) => word);
            
            const results = [];
            
            for (const keyword of topKeywords) {
                try {
                    const searchResponse = await fetch(
                        `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${encodeURIComponent(keyword)}&type=video&maxResults=10&key=${apiKey}`
                    );
                    const searchData = await searchResponse.json();
                    
                    if (searchData.items?.length) {
                        const competition = searchData.items.length >= 8 ? 'ë†’ìŒ' : searchData.items.length >= 4 ? 'ì¤‘ê°„' : 'ë‚®ìŒ';
                        const frequency = keywordFreq[keyword];
                        
                        results.push({
                            keyword,
                            searchVolume: searchData.items.length,
                            avgViews: 0,
                            competition,
                            competitionScore: searchData.items.length,
                            frequency,
                            opportunity: frequency * (11 - searchData.items.length) // Higher frequency, lower competition = better opportunity
                        });
                    }
                    
                    await new Promise(resolve => setTimeout(resolve, 100));
                    
                } catch (error) {
                    console.error(`Error processing competitor keyword: ${keyword}`, error);
                }
            }
            
            return results.sort((a, b) => b.opportunity - a.opportunity);
        }

        function calculateOpportunityScore(avgViews, competition) {
            // Higher average views and lower competition = better opportunity
            const viewScore = Math.min(avgViews / 10000, 10); // Max 10 points for views
            const competitionPenalty = competition / 2; // Penalty for high competition
            return Math.max(0, viewScore - competitionPenalty);
        }

        function displayKeywordResults(keywords, method, seedKeyword) {
            const container = document.getElementById('keywordsResults');
            
            const methodNames = {
                'related': 'ì—°ê´€ í‚¤ì›Œë“œ',
                'trending': 'íŠ¸ë Œë”© í‚¤ì›Œë“œ',
                'competitor': 'ê²½ìŸ í‚¤ì›Œë“œ'
            };
            
            const resultHtml = `
                <div class="card">
                    <div class="card-header">
                        <h3>ğŸ’¡ ${methodNames[method]} ë¶„ì„ ê²°ê³¼</h3>
                        <p style="color: var(--text-secondary); margin-top: 8px;">
                            ê¸°ë³¸ í‚¤ì›Œë“œ: "${seedKeyword}"
                        </p>
                    </div>
                    
                    ${keywords.length > 0 ? `
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; margin-top: 16px;">
                            <thead>
                                <tr style="background: var(--bg-tertiary); border-bottom: 1px solid rgba(255,255,255,0.1);">
                                    <th style="padding: 12px; text-align: left; color: var(--text-primary);">í‚¤ì›Œë“œ</th>
                                    <th style="padding: 12px; text-align: center; color: var(--text-primary);">ê²€ìƒ‰ëŸ‰</th>
                                    ${method === 'related' ? '<th style="padding: 12px; text-align: center; color: var(--text-primary);">í‰ê·  ì¡°íšŒìˆ˜</th>' : ''}
                                    <th style="padding: 12px; text-align: center; color: var(--text-primary);">ê²½ìŸë„</th>
                                    ${method === 'trending' ? '<th style="padding: 12px; text-align: center; color: var(--text-primary);">íŠ¸ë Œë“œ ì ìˆ˜</th>' : ''}
                                    ${method === 'competitor' ? '<th style="padding: 12px; text-align: center; color: var(--text-primary);">ì‚¬ìš©ë¹ˆë„</th>' : ''}
                                    <th style="padding: 12px; text-align: center; color: var(--text-primary);">ê¸°íšŒì ìˆ˜</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${keywords.map((keyword, index) => `
                                    <tr style="border-bottom: 1px solid rgba(255,255,255,0.05); ${index % 2 === 0 ? 'background: rgba(255,255,255,0.02);' : ''}">
                                        <td style="padding: 12px; font-weight: 500;">${escapeHtml(keyword.keyword)}</td>
                                        <td style="padding: 12px; text-align: center;">${keyword.searchVolume}</td>
                                        ${method === 'related' ? `<td style="padding: 12px; text-align: center;">${formatNumber(keyword.avgViews)}</td>` : ''}
                                        <td style="padding: 12px; text-align: center;">
                                            <span style="padding: 4px 8px; border-radius: 4px; font-size: 0.8rem; ${
                                                keyword.competition === 'ë†’ìŒ' ? 'background: rgba(255, 107, 107, 0.2); color: var(--error);' :
                                                keyword.competition === 'ì¤‘ê°„' ? 'background: rgba(255, 212, 59, 0.2); color: var(--warning);' :
                                                'background: rgba(81, 207, 102, 0.2); color: var(--success);'
                                            }">
                                                ${keyword.competition}
                                            </span>
                                        </td>
                                        ${method === 'trending' ? `<td style="padding: 12px; text-align: center;">${keyword.trendScore}</td>` : ''}
                                        ${method === 'competitor' ? `<td style="padding: 12px; text-align: center;">${keyword.frequency}</td>` : ''}
                                        <td style="padding: 12px; text-align: center; font-weight: bold; color: var(--accent-primary);">
                                            ${Math.round(keyword.opportunity * 10) / 10}
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                    
                    <div style="margin-top: 24px;">
                        <h4 style="margin-bottom: 16px;">ğŸ¯ ì¶”ì²œ í‚¤ì›Œë“œ (ìƒìœ„ 10ê°œ)</h4>
                        <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                            ${keywords.slice(0, 10).map(keyword => `
                                <span style="background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); padding: 8px 16px; border-radius: 20px; font-size: 0.9rem; color: white; cursor: pointer;" 
                                      onclick="copyToClipboard('${keyword.keyword.replace(/'/g, "\\'")}')">
                                    ${escapeHtml(keyword.keyword)} 
                                    <small style="opacity: 0.8;">(${Math.round(keyword.opportunity * 10) / 10})</small>
                                </span>
                            `).join('')}
                        </div>
                        <p style="color: var(--text-tertiary); font-size: 0.85rem; margin-top: 8px;">
                            í‚¤ì›Œë“œë¥¼ í´ë¦­í•˜ë©´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë©ë‹ˆë‹¤.
                        </p>
                    </div>
                    ` : `
                    <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                        <p>í‚¤ì›Œë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë‹¤ë¥¸ í‚¤ì›Œë“œë¡œ ì‹œë„í•´ë³´ì„¸ìš”.</p>
                    </div>
                    `}
                </div>
            `;
            
            container.innerHTML = resultHtml;
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                // Show a temporary notification
                const notification = document.createElement('div');
                notification.textContent = 'í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!';
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: var(--success);
                    color: white;
                    padding: 12px 20px;
                    border-radius: 8px;
                    z-index: 10000;
                    box-shadow: var(--shadow);
                `;
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 2000);
            }).catch(() => {
                alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            });
        }

        // Analytics dashboard
        function loadAnalyticsData() {
            const saved = localStorage.getItem('youtube_analytics');
            if (saved) {
                analysisData = { ...analysisData, ...JSON.parse(saved) };
            }
        }

        function updateAnalytics() {
            localStorage.setItem('youtube_analytics', JSON.stringify(analysisData));
            
            const container = document.getElementById('analyticsResults');
            const total = Object.values(analysisData).reduce((sum, val) => sum + val, 0);
            
            if (total > 0) {
                container.innerHTML = `
                    <div class="analytics-grid">
                        <div class="metric-card">
                            <div class="metric-value" style="color: var(--accent-primary);">${analysisData.searches}</div>
                            <div class="metric-label">ì˜ìƒ ê²€ìƒ‰</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" style="color: var(--accent-secondary);">${analysisData.competitors}</div>
                            <div class="metric-label">ê²½ìŸì ë¶„ì„</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" style="color: var(--accent-tertiary);">${analysisData.trends}</div>
                            <div class="metric-label">íŠ¸ë Œë“œ ë¶„ì„</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" style="color: var(--success);">${analysisData.channels}</div>
                            <div class="metric-label">ì±„ë„ ë¶„ì„</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" style="color: var(--purple);">${analysisData.keywords}</div>
                            <div class="metric-label">í‚¤ì›Œë“œ ë§ˆì´ë‹</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" style="color: var(--pink);">${total}</div>
                            <div class="metric-label">ì´ ë¶„ì„</div>
                        </div>
                    </div>
                    
                    <div class="card" style="margin-top: 24px;">
                        <div class="card-header">
                            <h4>ğŸ“ˆ ì‚¬ìš© í†µê³„</h4>
                        </div>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px;">
                            ${Object.entries(analysisData).map(([key, value]) => {
                                const names = {
                                    searches: 'ì˜ìƒ ê²€ìƒ‰',
                                    competitors: 'ê²½ìŸì ë¶„ì„',
                                    trends: 'íŠ¸ë Œë“œ ë¶„ì„',
                                    channels: 'ì±„ë„ ë¶„ì„',
                                    keywords: 'í‚¤ì›Œë“œ ë§ˆì´ë‹'
                                };
                                const percentage = total > 0 ? (value / total * 100).toFixed(1) : 0;
                                return `
                                    <div style="background: var(--bg-tertiary); padding: 16px; border-radius: 8px;">
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                            <span>${names[key]}</span>
                                            <span style="font-weight: bold;">${value}</span>
                                        </div>
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: ${percentage}%"></div>
                                        </div>
                                        <div style="text-align: right; font-size: 0.8rem; color: var(--text-tertiary); margin-top: 4px;">
                                            ${percentage}%
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 24px;">
                        <button class="btn" onclick="resetAnalytics()" style="background: var(--error); color: white;">
                            ğŸ—‘ï¸ í†µê³„ ì´ˆê¸°í™”
                        </button>
                    </div>
                `;
            }
        }

        function resetAnalytics() {
            if (confirm('ëª¨ë“  ë¶„ì„ í†µê³„ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                analysisData = {
                    searches: 0,
                    competitors: 0,
                    trends: 0,
                    channels: 0,
                    keywords: 0
                };
                localStorage.removeItem('youtube_analytics');
                document.getElementById('analyticsResults').innerHTML = `
                    <p style="text-align: center; color: var(--text-secondary); padding: 40px;">
                        í†µê³„ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ë¥¸ íƒ­ì—ì„œ ë¶„ì„ì„ ìˆ˜í–‰í•˜ë©´ ì—¬ê¸°ì— ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤.
                    </p>
                `;
            }
        }

        // Initialize analytics on load
        updateAnalytics();

        // ===== ì˜ìƒ ë²¤ì¹˜ë§ˆí‚¹ ë¶„ì„ ì‹œìŠ¤í…œ =====
        
        async function analyzeVideoForBenchmarking(videoId, videoTitle) {
            if (!apiKey) {
                alert('API í‚¤ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ëª¨ë‹¬ ì—´ê¸°
            const modal = document.getElementById('analysisModal');
            const loading = document.getElementById('analysisLoading');
            const results = document.getElementById('analysisResults');
            const progress = document.getElementById('analysisProgress');
            
            modal.classList.add('show');
            loading.style.display = 'block';
            results.style.display = 'none';
            
            try {
                // ë‹¨ê³„ë³„ ë¶„ì„ ì§„í–‰
                const analysisData = await performComprehensiveAnalysis(videoId, progress);
                
                // ê²°ê³¼ í‘œì‹œ
                loading.style.display = 'none';
                results.style.display = 'block';
                results.innerHTML = generateAnalysisReport(analysisData, videoTitle);
                
            } catch (error) {
                console.error('Analysis error:', error);
                loading.style.display = 'none';
                results.style.display = 'block';
                results.innerHTML = `
                    <div class="analysis-section">
                        <h3>âŒ ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤</h3>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        }

        async function performComprehensiveAnalysis(videoId, progressElement) {
            const updateProgress = (message) => {
                progressElement.textContent = message;
            };

            // 1. ê¸°ë³¸ ì˜ìƒ ì •ë³´ ìˆ˜ì§‘
            updateProgress('ğŸ“Š ì˜ìƒ ê¸°ë³¸ ì •ë³´ ë¶„ì„ ì¤‘...');
            const videoData = await getDetailedVideoData(videoId);
            await new Promise(resolve => setTimeout(resolve, 1000));

            // 2. ì±„ë„ ì •ë³´ ë¶„ì„
            updateProgress('ğŸ“º ì±„ë„ ì •ë³´ ë¶„ì„ ì¤‘...');
            const channelData = await getDetailedChannelData(videoData.snippet.channelId);
            await new Promise(resolve => setTimeout(resolve, 1000));

            // 3. ê²½ìŸ ì˜ìƒ ë¶„ì„
            updateProgress('ğŸ† ê²½ìŸ ì˜ìƒ ë¶„ì„ ì¤‘...');
            const competitorAnalysis = await analyzeCompetitorVideos(videoData.snippet.title);
            await new Promise(resolve => setTimeout(resolve, 1000));

            // 4. í‚¤ì›Œë“œ ë° íƒœê·¸ ë¶„ì„
            updateProgress('ğŸ·ï¸ í‚¤ì›Œë“œ ë° íƒœê·¸ ë¶„ì„ ì¤‘...');
            const keywordAnalysis = await analyzeVideoKeywords(videoData);
            await new Promise(resolve => setTimeout(resolve, 1000));

            // 5. ì„±ê³¼ ì§€í‘œ ë¶„ì„
            updateProgress('ğŸ“ˆ ì„±ê³¼ ì§€í‘œ ë¶„ì„ ì¤‘...');
            const performanceAnalysis = await analyzeVideoPerformance(videoData, channelData);
            await new Promise(resolve => setTimeout(resolve, 1000));

            // 6. ì½˜í…ì¸  ì „ëµ ìˆ˜ë¦½
            updateProgress('ğŸ¯ ë§ì¶¤í˜• ì½˜í…ì¸  ì „ëµ ìˆ˜ë¦½ ì¤‘...');
            const contentStrategy = await generateContentStrategy(videoData, competitorAnalysis, keywordAnalysis);
            
            return {
                video: videoData,
                channel: channelData,
                competitors: competitorAnalysis,
                keywords: keywordAnalysis,
                performance: performanceAnalysis,
                strategy: contentStrategy
            };
        }

        async function getDetailedVideoData(videoId) {
            const response = await fetch(
                `https://www.googleapis.com/youtube/v3/videos?part=snippet,statistics,contentDetails,status&id=${videoId}&key=${apiKey}`
            );
            const data = await response.json();
            
            if (!data.items || data.items.length === 0) {
                throw new Error('ì˜ìƒ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
            
            return data.items[0];
        }

        async function getDetailedChannelData(channelId) {
            const response = await fetch(
                `https://www.googleapis.com/youtube/v3/channels?part=snippet,statistics,brandingSettings&id=${channelId}&key=${apiKey}`
            );
            const data = await response.json();
            
            if (!data.items || data.items.length === 0) {
                throw new Error('ì±„ë„ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
            
            return data.items[0];
        }

        async function analyzeCompetitorVideos(videoTitle) {
            // ì œëª©ì—ì„œ í•µì‹¬ í‚¤ì›Œë“œ ì¶”ì¶œ
            const keywords = extractKeywords(videoTitle);
            const searchQuery = keywords.slice(0, 3).join(' ');
            
            const response = await fetch(
                `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${encodeURIComponent(searchQuery)}&type=video&order=viewCount&maxResults=10&key=${apiKey}`
            );
            const data = await response.json();
            
            if (!data.items) return [];
            
            // ìƒìœ„ ì˜ìƒë“¤ì˜ ìƒì„¸ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
            const videoIds = data.items.map(item => item.id.videoId).join(',');
            const detailsResponse = await fetch(
                `https://www.googleapis.com/youtube/v3/videos?part=snippet,statistics,contentDetails&id=${videoIds}&key=${apiKey}`
            );
            const detailsData = await detailsResponse.json();
            
            return detailsData.items || [];
        }

        function extractKeywords(title) {
            return title
                .toLowerCase()
                .replace(/[^\w\sê°€-í£]/g, ' ')
                .split(/\s+/)
                .filter(word => word.length > 2)
                .slice(0, 5);
        }

        async function analyzeVideoKeywords(videoData) {
            const title = videoData.snippet.title;
            const description = videoData.snippet.description;
            const tags = videoData.snippet.tags || [];
            
            // ì œëª©ì—ì„œ í‚¤ì›Œë“œ ì¶”ì¶œ
            const titleKeywords = extractKeywords(title);
            
            // ì„¤ëª…ì—ì„œ í‚¤ì›Œë“œ ì¶”ì¶œ
            const descKeywords = extractKeywords(description);
            
            // í‚¤ì›Œë“œ ë¹ˆë„ ë¶„ì„
            const allKeywords = [...titleKeywords, ...descKeywords, ...tags];
            const keywordFreq = {};
            allKeywords.forEach(keyword => {
                keywordFreq[keyword] = (keywordFreq[keyword] || 0) + 1;
            });
            
            return {
                titleKeywords,
                descriptionKeywords: descKeywords,
                tags,
                topKeywords: Object.entries(keywordFreq)
                    .sort(([,a], [,b]) => b - a)
                    .slice(0, 10)
                    .map(([keyword]) => keyword)
            };
        }

        async function analyzeVideoPerformance(videoData, channelData) {
            const stats = videoData.statistics;
            const channelStats = channelData.statistics;
            const publishedAt = new Date(videoData.snippet.publishedAt);
            const daysSince = Math.floor((new Date() - publishedAt) / (1000 * 60 * 60 * 24));
            
            const viewCount = parseInt(stats.viewCount || '0');
            const likeCount = parseInt(stats.likeCount || '0');
            const commentCount = parseInt(stats.commentCount || '0');
            const subscriberCount = parseInt(channelStats.subscriberCount || '0');
            
            // ì„±ê³¼ ì§€í‘œ ê³„ì‚°
            const viewsPerDay = daysSince > 0 ? Math.round(viewCount / daysSince) : viewCount;
            const engagementRate = viewCount > 0 ? ((likeCount + commentCount) / viewCount * 100) : 0;
            const likeRatio = viewCount > 0 ? (likeCount / viewCount * 100) : 0;
            const commentRatio = viewCount > 0 ? (commentCount / viewCount * 100) : 0;
            
            // ì±„ë„ ëŒ€ë¹„ ì„±ê³¼
            const avgViewsPerVideo = subscriberCount > 0 ? Math.round(viewCount / subscriberCount * 1000) : 0;
            
            return {
                viewCount,
                likeCount,
                commentCount,
                daysSince,
                viewsPerDay,
                engagementRate: engagementRate.toFixed(2),
                likeRatio: likeRatio.toFixed(2),
                commentRatio: commentRatio.toFixed(2),
                avgViewsPerVideo,
                performanceGrade: calculatePerformanceGrade(engagementRate, viewsPerDay)
            };
        }

        function calculatePerformanceGrade(engagementRate, viewsPerDay) {
            const score = (engagementRate * 0.6) + (Math.log10(viewsPerDay + 1) * 0.4);
            
            if (score >= 8) return { grade: 'S', color: '#ff6b6b', emoji: 'ğŸ†' };
            if (score >= 6) return { grade: 'A', color: '#4ecdc4', emoji: 'â­' };
            if (score >= 4) return { grade: 'B', color: '#45b7d1', emoji: 'ğŸ”¥' };
            if (score >= 2) return { grade: 'C', color: '#96ceb4', emoji: 'ğŸ“ˆ' };
            return { grade: 'D', color: '#feca57', emoji: 'ğŸ“Š' };
        }

        async function generateContentStrategy(videoData, competitorAnalysis, keywordAnalysis) {
            const video = videoData;
            const stats = video.statistics;
            const duration = parseDuration(video.contentDetails.duration);
            
            // ê²½ìŸ ì˜ìƒ ë¶„ì„ ê²°ê³¼
            const avgViews = competitorAnalysis.reduce((sum, v) => sum + parseInt(v.statistics.viewCount || '0'), 0) / competitorAnalysis.length;
            const avgDuration = competitorAnalysis.reduce((sum, v) => sum + parseDuration(v.contentDetails.duration), 0) / competitorAnalysis.length;
            
            // ìµœì í™” ì œì•ˆ ìƒì„±
            const suggestions = generateOptimizationSuggestions(video, competitorAnalysis, keywordAnalysis, avgViews, avgDuration);
            
            return {
                avgViews: Math.round(avgViews),
                avgDuration: Math.round(avgDuration),
                suggestions,
                scriptOutline: generateScriptOutline(video, keywordAnalysis),
                titleSuggestions: generateTitleSuggestions(video, keywordAnalysis),
                thumbnailTips: generateThumbnailTips(video),
                descriptionTemplate: generateDescriptionTemplate(video, keywordAnalysis)
            };
        }

        function parseDuration(duration) {
            const match = duration.match(/PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?/);
            if (!match) return 0;
            
            const hours = parseInt(match[1] || '0');
            const minutes = parseInt(match[2] || '0');
            const seconds = parseInt(match[3] || '0');
            
            return hours * 3600 + minutes * 60 + seconds;
        }

        function generateOptimizationSuggestions(video, competitors, keywords, avgViews, avgDuration) {
            const suggestions = [];
            const currentViews = parseInt(video.statistics.viewCount || '0');
            const currentDuration = parseDuration(video.contentDetails.duration);
            
            // ì¡°íšŒìˆ˜ ê¸°ë°˜ ì œì•ˆ
            if (currentViews < avgViews * 0.5) {
                suggestions.push({
                    category: 'ğŸ“Š ì¡°íšŒìˆ˜ ìµœì í™”',
                    priority: 'high',
                    suggestion: 'ì œëª©ê³¼ ì¸ë„¤ì¼ì„ ë” ë§¤ë ¥ì ìœ¼ë¡œ ë§Œë“¤ì–´ í´ë¦­ë¥ ì„ ë†’ì´ì„¸ìš”.',
                    details: `í˜„ì¬ ì¡°íšŒìˆ˜ê°€ í‰ê· (${formatNumber(avgViews)})ë³´ë‹¤ ë‚®ìŠµë‹ˆë‹¤. ë” ê°•ë ¥í•œ í›„í‚¹ ìš”ì†Œê°€ í•„ìš”í•©ë‹ˆë‹¤.`
                });
            }
            
            // ì˜ìƒ ê¸¸ì´ ìµœì í™”
            if (Math.abs(currentDuration - avgDuration) > 120) {
                const suggestion = currentDuration > avgDuration 
                    ? 'ì˜ìƒì„ ë” ê°„ê²°í•˜ê²Œ í¸ì§‘í•˜ì—¬ ì‹œì²­ìì˜ ì§‘ì¤‘ë ¥ì„ ìœ ì§€í•˜ì„¸ìš”.'
                    : 'ì½˜í…ì¸ ë¥¼ ë” í’ë¶€í•˜ê²Œ ë§Œë“¤ì–´ ì‹œì²­ ì‹œê°„ì„ ëŠ˜ë¦¬ì„¸ìš”.';
                    
                suggestions.push({
                    category: 'â±ï¸ ì˜ìƒ ê¸¸ì´ ìµœì í™”',
                    priority: 'medium',
                    suggestion,
                    details: `ìµœì  ê¸¸ì´ëŠ” ì•½ ${Math.round(avgDuration/60)}ë¶„ì…ë‹ˆë‹¤. í˜„ì¬ ${Math.round(currentDuration/60)}ë¶„ì…ë‹ˆë‹¤.`
                });
            }
            
            // í‚¤ì›Œë“œ í™œìš© ì œì•ˆ
            suggestions.push({
                category: 'ğŸ·ï¸ SEO ìµœì í™”',
                priority: 'high',
                suggestion: 'íŠ¸ë Œë”© í‚¤ì›Œë“œë¥¼ ë” íš¨ê³¼ì ìœ¼ë¡œ í™œìš©í•˜ì„¸ìš”.',
                details: `ì¶”ì²œ í‚¤ì›Œë“œ: ${keywords.topKeywords.slice(0, 5).join(', ')}`
            });
            
            return suggestions;
        }

        function generateScriptOutline(video, keywords) {
            const topKeywords = keywords.topKeywords.slice(0, 3);
            
            return {
                hook: `ì²« 15ì´ˆì—ì„œ "${topKeywords[0]}"ì— ëŒ€í•œ ê°•ë ¥í•œ ì§ˆë¬¸ì´ë‚˜ ë†€ë¼ìš´ ì‚¬ì‹¤ ì œì‹œ`,
                introduction: `ë¬¸ì œ ìƒí™© ì œì‹œ ë° ì˜ìƒì—ì„œ ë‹¤ë£° í•µì‹¬ ë‚´ìš© ì˜ˆê³  (30ì´ˆ-1ë¶„)`,
                mainContent: [
                    `í•µì‹¬ í¬ì¸íŠ¸ 1: ${topKeywords[0]} ê´€ë ¨ ì£¼ìš” ë‚´ìš©`,
                    `í•µì‹¬ í¬ì¸íŠ¸ 2: ${topKeywords[1]} ê´€ë ¨ ì‹¤ìš©ì  ì •ë³´`,
                    `í•µì‹¬ í¬ì¸íŠ¸ 3: ${topKeywords[2]} ê´€ë ¨ í–‰ë™ ì§€ì¹¨`
                ],
                engagement: `ì¤‘ê°„ì¤‘ê°„ ì‹œì²­ì ì°¸ì—¬ ìœ ë„ (ì¢‹ì•„ìš”, ëŒ“ê¸€ ìš”ì²­)`,
                conclusion: `í•µì‹¬ ë‚´ìš© ìš”ì•½ ë° ë‹¤ìŒ ì˜ìƒ ì˜ˆê³ `
            };
        }

        function generateTitleSuggestions(video, keywords) {
            const topKeywords = keywords.topKeywords.slice(0, 3);
            const currentTitle = video.snippet.title;
            
            return [
                `ğŸ”¥ ${topKeywords[0]} ì™„ë²½ ê°€ì´ë“œ | ì´ˆë³´ìë„ ì‰½ê²Œ ë”°ë¼í•˜ëŠ” ë°©ë²•`,
                `ğŸ’¡ ${topKeywords[1]} ê¿€íŒ ëª¨ìŒ | 99%ê°€ ëª¨ë¥´ëŠ” ìˆ¨ê²¨ì§„ ê¸°ëŠ¥ë“¤`,
                `âš¡ ë‹¨ 10ë¶„ë§Œì— ${topKeywords[0]} ë§ˆìŠ¤í„°í•˜ê¸° | ì‹¤ì „ ë…¸í•˜ìš° ê³µê°œ`,
                `ğŸ¯ ${topKeywords[2]} ì„±ê³µ ì‚¬ë¡€ ë¶„ì„ | ì´ê²ƒë§Œ ì•Œë©´ ë‹¹ì‹ ë„ ê°€ëŠ¥!`,
                `ğŸ“ˆ ${topKeywords[0]} ìµœì‹  íŠ¸ë Œë“œ | 2024ë…„ ë‹¬ë¼ì§„ ì ì€?`
            ];
        }

        function generateThumbnailTips(video) {
            return [
                'ğŸ¨ ë°ê³  ëŒ€ë¹„ê°€ ê°•í•œ ìƒ‰ìƒ ì‚¬ìš©ìœ¼ë¡œ ì‹œì„  ì§‘ì¤‘',
                'ğŸ˜® ê°ì •ì´ ë“œëŸ¬ë‚˜ëŠ” í‘œì •ìœ¼ë¡œ í˜¸ê¸°ì‹¬ ìœ ë°œ',
                'ğŸ“ í•µì‹¬ í‚¤ì›Œë“œë¥¼ í° ê¸€ì”¨ë¡œ ëª…í™•í•˜ê²Œ í‘œì‹œ',
                'ğŸ”¥ "NEW", "ê¿€íŒ", "ì™„ë²½ê°€ì´ë“œ" ë“± ê°•ë ¥í•œ ìˆ˜ì‹ì–´ í™œìš©',
                'ğŸ“± ëª¨ë°”ì¼ì—ì„œë„ ì˜ ë³´ì´ë„ë¡ í…ìŠ¤íŠ¸ í¬ê¸° ìµœì í™”'
            ];
        }

        function generateDescriptionTemplate(video, keywords) {
            const topKeywords = keywords.topKeywords.slice(0, 5);
            
            return `ğŸ“Œ ì´ ì˜ìƒì—ì„œ ë‹¤ë£° ë‚´ìš©:
âœ… ${topKeywords[0]} í•µì‹¬ í¬ì¸íŠ¸
âœ… ${topKeywords[1]} ì‹¤ì „ í™œìš©ë²•  
âœ… ${topKeywords[2]} ì£¼ì˜ì‚¬í•­
âœ… ì¶”ê°€ ê¿€íŒ ë° ë¦¬ì†ŒìŠ¤

ğŸ”¥ ìœ ìš©í–ˆë‹¤ë©´ ì¢‹ì•„ìš”ğŸ‘ & êµ¬ë…ğŸ”” ë¶€íƒë“œë ¤ìš”!

ğŸ“ íƒ€ì„ìŠ¤íƒ¬í”„:
00:00 ì¸íŠ¸ë¡œ
01:30 ${topKeywords[0]} ì„¤ëª…
03:00 ${topKeywords[1]} ì‹¤ìŠµ
05:30 ${topKeywords[2]} íŒ
08:00 ì •ë¦¬ ë° ë§ˆë¬´ë¦¬

ğŸ·ï¸ íƒœê·¸: #${topKeywords.join(' #')}

ğŸ’¬ ê¶ê¸ˆí•œ ì ì´ ìˆìœ¼ì‹œë©´ ëŒ“ê¸€ë¡œ ë‚¨ê²¨ì£¼ì„¸ìš”!
ğŸ“§ ë¹„ì¦ˆë‹ˆìŠ¤ ë¬¸ì˜: [ì´ë©”ì¼ ì£¼ì†Œ]`;
        }

        function generateAnalysisReport(data, videoTitle) {
            const { video, channel, competitors, keywords, performance, strategy } = data;
            
            return `
                <div class="analysis-section">
                    <h3>ğŸ“Š ì˜ìƒ ê¸°ë³¸ ì •ë³´</h3>
                    <div class="analysis-grid">
                        <div class="metric-card">
                            <h4>ì œëª©</h4>
                            <div class="metric-value" style="font-size: 16px; line-height: 1.4;">${video.snippet.title}</div>
                        </div>
                        <div class="metric-card">
                            <h4>ì—…ë¡œë“œ ë‚ ì§œ</h4>
                            <div class="metric-value">${new Date(video.snippet.publishedAt).toLocaleDateString('ko-KR')}</div>
                            <div class="metric-label">${performance.daysSince}ì¼ ì „</div>
                        </div>
                        <div class="metric-card">
                            <h4>ì˜ìƒ ê¸¸ì´</h4>
                            <div class="metric-value">${formatDuration(video.contentDetails.duration)}</div>
                        </div>
                        <div class="metric-card">
                            <h4>ì¹´í…Œê³ ë¦¬</h4>
                            <div class="metric-value">${getCategoryName(video.snippet.categoryId)}</div>
                        </div>
                    </div>
                </div>

                <div class="analysis-section">
                    <h3>ğŸ“ˆ ì„±ê³¼ ì§€í‘œ ë¶„ì„</h3>
                    <div class="analysis-grid">
                        <div class="metric-card">
                            <h4>ì¡°íšŒìˆ˜</h4>
                            <div class="metric-value">${formatNumber(performance.viewCount)}</div>
                            <div class="metric-label">í•˜ë£¨ í‰ê·  ${formatNumber(performance.viewsPerDay)}</div>
                        </div>
                        <div class="metric-card">
                            <h4>ì¢‹ì•„ìš”</h4>
                            <div class="metric-value">${formatNumber(performance.likeCount)}</div>
                            <div class="metric-label">ë¹„ìœ¨: ${performance.likeRatio}%</div>
                        </div>
                        <div class="metric-card">
                            <h4>ëŒ“ê¸€</h4>
                            <div class="metric-value">${formatNumber(performance.commentCount)}</div>
                            <div class="metric-label">ë¹„ìœ¨: ${performance.commentRatio}%</div>
                        </div>
                        <div class="metric-card">
                            <h4>ì°¸ì—¬ë„</h4>
                            <div class="metric-value" style="color: ${performance.performanceGrade.color};">
                                ${performance.performanceGrade.emoji} ${performance.performanceGrade.grade}ê¸‰
                            </div>
                            <div class="metric-label">${performance.engagementRate}%</div>
                        </div>
                    </div>
                </div>

                <div class="analysis-section">
                    <h3>ğŸ“º ì±„ë„ ì •ë³´</h3>
                    <div class="analysis-grid">
                        <div class="metric-card">
                            <h4>ì±„ë„ëª…</h4>
                            <div class="metric-value" style="font-size: 16px;">${channel.snippet.title}</div>
                        </div>
                        <div class="metric-card">
                            <h4>êµ¬ë…ì</h4>
                            <div class="metric-value">${formatNumber(channel.statistics.subscriberCount)}</div>
                        </div>
                        <div class="metric-card">
                            <h4>ì´ ì˜ìƒ</h4>
                            <div class="metric-value">${formatNumber(channel.statistics.videoCount)}</div>
                        </div>
                        <div class="metric-card">
                            <h4>ì´ ì¡°íšŒìˆ˜</h4>
                            <div class="metric-value">${formatNumber(channel.statistics.viewCount)}</div>
                        </div>
                    </div>
                </div>

                <div class="analysis-section">
                    <h3>ğŸ·ï¸ í‚¤ì›Œë“œ ë¶„ì„</h3>
                    <div class="analysis-grid">
                        <div class="metric-card">
                            <h4>í•µì‹¬ í‚¤ì›Œë“œ</h4>
                            <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px;">
                                ${keywords.topKeywords.slice(0, 8).map(keyword => 
                                    `<span style="background: var(--accent-primary); color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px;">${keyword}</span>`
                                ).join('')}
                            </div>
                        </div>
                        <div class="metric-card">
                            <h4>íƒœê·¸ ìˆ˜</h4>
                            <div class="metric-value">${keywords.tags.length}</div>
                        </div>
                    </div>
                </div>

                <div class="analysis-section">
                    <h3>ğŸ† ê²½ìŸ ë¶„ì„</h3>
                    <div class="metric-card">
                        <h4>ë™ì¼ ì£¼ì œ ìƒìœ„ ì˜ìƒ í‰ê· </h4>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-top: 12px;">
                            <div>
                                <div class="metric-label">í‰ê·  ì¡°íšŒìˆ˜</div>
                                <div class="metric-value" style="font-size: 18px;">${formatNumber(strategy.avgViews)}</div>
                            </div>
                            <div>
                                <div class="metric-label">í‰ê·  ì˜ìƒ ê¸¸ì´</div>
                                <div class="metric-value" style="font-size: 18px;">${Math.round(strategy.avgDuration/60)}ë¶„</div>
                            </div>
                        </div>
                    </div>
                </div>

                ${generateOptimizationSection(strategy.suggestions)}
                ${generateContentStrategySection(strategy)}
            `;
        }

        function generateOptimizationSection(suggestions) {
            return `
                <div class="recommendations-card">
                    <h3>ğŸ¯ ìµœì í™” ì œì•ˆ</h3>
                    ${suggestions.map(suggestion => `
                        <div class="recommendation-item">
                            <h4>${suggestion.category}</h4>
                            <p><strong>${suggestion.suggestion}</strong></p>
                            <p style="margin-top: 8px; font-size: 13px;">${suggestion.details}</p>
                            <span style="background: ${suggestion.priority === 'high' ? '#ff6b6b' : '#feca57'}; 
                                       color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; 
                                       text-transform: uppercase; font-weight: bold;">
                                ${suggestion.priority === 'high' ? 'ë†’ìŒ' : 'ë³´í†µ'}
                            </span>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function generateContentStrategySection(strategy) {
            return `
                <div class="recommendations-card">
                    <h3>ğŸš€ ì‹¤í–‰ ê°€ëŠ¥í•œ ì½˜í…ì¸  ì „ëµ</h3>
                    
                    <div class="recommendation-item">
                        <h4>ğŸ“ ì œì•ˆ ì œëª© (ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥)</h4>
                        <div style="margin-top: 12px;">
                            ${strategy.titleSuggestions.map((title, index) => 
                                `<div style="background: #f8f9fa; padding: 12px; border-radius: 6px; margin-bottom: 8px; border-left: 3px solid var(--accent-primary);">
                                    <strong>ì˜µì…˜ ${index + 1}:</strong> ${title}
                                </div>`
                            ).join('')}
                        </div>
                    </div>

                    <div class="recommendation-item">
                        <h4>ğŸ¬ ì˜ìƒ ìŠ¤í¬ë¦½íŠ¸ êµ¬ì„±</h4>
                        <div style="margin-top: 12px;">
                            <div style="margin-bottom: 16px;">
                                <strong>ğŸª ì˜¤í”„ë‹ í›„í‚¹ (0-15ì´ˆ):</strong>
                                <div style="background: #e3f2fd; padding: 10px; border-radius: 4px; margin-top: 4px; font-size: 14px;">
                                    ${strategy.scriptOutline.hook}
                                </div>
                            </div>
                            <div style="margin-bottom: 16px;">
                                <strong>ğŸ‘‹ ì¸íŠ¸ë¡œ (15ì´ˆ-1ë¶„):</strong>
                                <div style="background: #e8f5e8; padding: 10px; border-radius: 4px; margin-top: 4px; font-size: 14px;">
                                    ${strategy.scriptOutline.introduction}
                                </div>
                            </div>
                            <div style="margin-bottom: 16px;">
                                <strong>ğŸ“š ë©”ì¸ ì½˜í…ì¸ :</strong>
                                ${strategy.scriptOutline.mainContent.map((point, index) => 
                                    `<div style="background: #fff3e0; padding: 10px; border-radius: 4px; margin-top: 4px; font-size: 14px;">
                                        ${index + 1}. ${point}
                                    </div>`
                                ).join('')}
                            </div>
                        </div>
                    </div>

                    <div class="recommendation-item">
                        <h4>ğŸ–¼ï¸ ì¸ë„¤ì¼ ì œì‘ ê°€ì´ë“œ</h4>
                        <div style="margin-top: 12px;">
                            ${strategy.thumbnailTips.map(tip => 
                                `<div style="padding: 8px 0; border-bottom: 1px solid #eee; font-size: 14px;">
                                    ${tip}
                                </div>`
                            ).join('')}
                        </div>
                    </div>

                    <div class="recommendation-item">
                        <h4>ğŸ“‹ ì˜ìƒ ì„¤ëª… í…œí”Œë¦¿</h4>
                        <textarea readonly style="width: 100%; height: 200px; padding: 12px; border: 1px solid #ddd; 
                                 border-radius: 6px; font-family: monospace; font-size: 12px; margin-top: 8px; 
                                 background: #f8f9fa; resize: vertical;">${strategy.descriptionTemplate}</textarea>
                        <div style="margin-top: 8px; font-size: 12px; color: var(--text-secondary);">
                            ğŸ’¡ ìœ„ í…œí”Œë¦¿ì„ ë³µì‚¬í•˜ì—¬ ë°”ë¡œ ì‚¬ìš©í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                        </div>
                    </div>
                </div>
            `;
        }

        function getCategoryName(categoryId) {
            const categories = {
                '1': 'ì˜í™”/ì• ë‹ˆë©”ì´ì…˜',
                '2': 'ìë™ì°¨',
                '10': 'ìŒì•…',
                '15': 'ì• ì™„ë™ë¬¼',
                '17': 'ìŠ¤í¬ì¸ ',
                '19': 'ì—¬í–‰/ì´ë²¤íŠ¸',
                '20': 'ê²Œì„',
                '22': 'ì‚¬ëŒ/ë¸”ë¡œê·¸',
                '23': 'ì½”ë¯¸ë””',
                '24': 'ì—”í„°í…Œì¸ë¨¼íŠ¸',
                '25': 'ë‰´ìŠ¤/ì •ì¹˜',
                '26': 'ë…¸í•˜ìš°/ìŠ¤íƒ€ì¼',
                '27': 'êµìœ¡',
                '28': 'ê³¼í•™/ê¸°ìˆ '
            };
            return categories[categoryId] || 'ê¸°íƒ€';
        }

        function formatDuration(isoDuration) {
            const match = isoDuration.match(/PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?/);
            if (!match) return '';

            const hours = parseInt(match[1] || '0');
            const minutes = parseInt(match[2] || '0');
            const seconds = parseInt(match[3] || '0');

            if (hours > 0) {
                return `${hours}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
            return `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }

        function formatNumber(num) {
            if (!num) return '0';
            if (num >= 1000000) {
                return (num / 1000000).toFixed(1) + 'M';
            } else if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num.toLocaleString();
        }

        function closeAnalysisModal() {
            const modal = document.getElementById('analysisModal');
            modal.classList.remove('show');
        }

        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ì‹œ ë‹«ê¸°
        document.getElementById('analysisModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeAnalysisModal();
            }
        });
    </script>
</body>
</html>
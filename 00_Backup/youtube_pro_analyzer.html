<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¯ YouTube í”„ë¡œ ë¶„ì„ê¸° - ì™„ì „ ë²¤ì¹˜ë§ˆí‚¹ ë„êµ¬</title>
    <style>
        :root {
            --bg-primary: #0f0f23;
            --bg-secondary: #1a1a2e;
            --bg-tertiary: #16213e;
            --bg-elevated: #0e3460;
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --text-tertiary: #707070;
            --accent-primary: #ff6b6b;
            --accent-secondary: #4ecdc4;
            --accent-tertiary: #45b7d1;
            --success: #51cf66;
            --warning: #ffd43b;
            --error: #ff6b6b;
            --purple: #8b5cf6;
            --pink: #ec4899;
            --space-sm: 8px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 32px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-xl: 16px;
            --transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --shadow: 0 10px 25px rgba(0,0,0,0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: var(--space-lg);
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: var(--space-xl);
            position: relative;
        }

        .header h1 {
            font-size: clamp(2rem, 5vw, 3.5rem);
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary), var(--accent-tertiary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: var(--space-md);
        }

        .header p {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: var(--space-lg);
        }

        .api-key-setup {
            background: linear-gradient(135deg, var(--warning), #f59e0b);
            color: #000;
            padding: var(--space-md);
            border-radius: var(--radius-lg);
            margin-bottom: var(--space-lg);
            font-weight: 500;
            display: none;
        }

        .api-key-setup.show {
            display: block;
        }

        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            gap: var(--space-sm);
            margin-bottom: var(--space-xl);
            overflow-x: auto;
            padding: var(--space-sm);
            border-radius: var(--radius-lg);
            background: var(--bg-secondary);
        }

        .nav-tab {
            padding: var(--space-md) var(--space-lg);
            background: transparent;
            border: 1px solid transparent;
            border-radius: var(--radius-md);
            color: var(--text-secondary);
            cursor: pointer;
            font-weight: 500;
            transition: all var(--transition);
            white-space: nowrap;
            flex-shrink: 0;
        }

        .nav-tab.active {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            border-color: var(--accent-primary);
            transform: translateY(-2px);
        }

        .nav-tab:hover:not(.active) {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        /* Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Cards */
        .card {
            background: var(--bg-secondary);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin-bottom: var(--space-lg);
            box-shadow: var(--shadow);
            transition: all var(--transition);
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.4);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-lg);
            padding-bottom: var(--space-md);
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        /* Form Elements */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
        }

        .form-label {
            font-weight: 500;
            color: var(--text-primary);
            font-size: 0.9rem;
        }

        .form-input, .form-select {
            padding: var(--space-md);
            background: var(--bg-tertiary);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-size: 1rem;
            transition: all var(--transition);
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.2);
        }

        .form-input::placeholder {
            color: var(--text-tertiary);
        }

        /* Buttons */
        .btn {
            padding: var(--space-md) var(--space-lg);
            border: none;
            border-radius: var(--radius-md);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition);
            font-size: 1rem;
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 107, 107, 0.4);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .btn-secondary:hover {
            background: var(--bg-elevated);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Search Results */
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: var(--space-lg);
            margin-top: var(--space-lg);
        }

        .video-card {
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            overflow: hidden;
            transition: all var(--transition);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .video-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.4);
        }

        .video-thumbnail {
            position: relative;
            width: 100%;
            height: 200px;
            overflow: hidden;
        }

        .video-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform var(--transition);
        }

        .video-card:hover .video-thumbnail img {
            transform: scale(1.05);
        }

        .video-duration {
            position: absolute;
            bottom: var(--space-sm);
            right: var(--space-sm);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 4px 8px;
            border-radius: var(--radius-sm);
            font-size: 0.8rem;
            font-weight: 500;
        }

        .video-info {
            padding: var(--space-md);
        }

        .video-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--space-sm);
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .video-channel {
            color: var(--accent-secondary);
            font-size: 0.9rem;
            margin-bottom: var(--space-sm);
        }

        .video-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-sm);
            margin-bottom: var(--space-md);
        }

        .stat-item {
            background: var(--bg-primary);
            padding: var(--space-sm);
            border-radius: var(--radius-md);
            text-align: center;
        }

        .stat-value {
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--accent-primary);
        }

        .stat-label {
            font-size: 0.7rem;
            color: var(--text-tertiary);
        }

        .analysis-badges {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-sm);
            margin-top: var(--space-sm);
        }

        .badge {
            padding: 4px 8px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            font-weight: 500;
        }

        .badge-success {
            background: var(--success);
            color: white;
        }

        .badge-warning {
            background: var(--warning);
            color: black;
        }

        .badge-error {
            background: var(--error);
            color: white;
        }

        .badge-info {
            background: var(--accent-tertiary);
            color: white;
        }

        /* Loading and States */
        .loading {
            display: none;
            text-align: center;
            padding: var(--space-xl);
            color: var(--text-secondary);
        }

        .loading.show {
            display: block;
        }

        .spinner {
            border: 3px solid var(--bg-tertiary);
            border-top: 3px solid var(--accent-primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto var(--space-md);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Settings Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(4px);
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            max-width: 500px;
            width: 90%;
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: var(--shadow);
        }

        /* Analytics Dashboard */
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--space-lg);
            margin-bottom: var(--space-lg);
        }

        .metric-card {
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            text-align: center;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .metric-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: var(--space-sm);
        }

        .metric-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .metric-trend {
            font-size: 0.8rem;
            margin-top: var(--space-sm);
        }

        .trend-up {
            color: var(--success);
        }

        .trend-down {
            color: var(--error);
        }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
            flex-wrap: wrap;
        }

        .quick-action {
            padding: var(--space-sm) var(--space-md);
            background: var(--bg-tertiary);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            text-decoration: none;
            font-size: 0.9rem;
            transition: all var(--transition);
        }

        .quick-action:hover {
            background: var(--accent-primary);
            color: white;
            transform: translateY(-2px);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: var(--space-md);
            }

            .nav-tabs {
                flex-direction: column;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .results-grid {
                grid-template-columns: 1fr;
            }

            .quick-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>ğŸ¯ YouTube í”„ë¡œ ë¶„ì„ê¸°</h1>
            <p>YouTube Data APIë¥¼ í™œìš©í•œ ì™„ì „ ë²¤ì¹˜ë§ˆí‚¹ & ê²½ìŸë¶„ì„ ë„êµ¬</p>
            
            <div class="api-key-setup" id="apiKeySetup">
                <strong>âš ï¸ API ì„¤ì • í•„ìš”:</strong> 
                YouTube Data API í‚¤ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.
                <button class="btn btn-secondary" onclick="openApiModal()" style="margin-left: 10px;">ì„¤ì •í•˜ê¸°</button>
            </div>
        </div>

        <!-- Navigation -->
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="switchTab('search')">ğŸ” ì˜ìƒ ê²€ìƒ‰</button>
            <button class="nav-tab" onclick="switchTab('competitor')">ğŸ† ê²½ìŸì ë¶„ì„</button>
            <button class="nav-tab" onclick="switchTab('trending')">ğŸ”¥ íŠ¸ë Œë“œ ë¶„ì„</button>
            <button class="nav-tab" onclick="switchTab('channel')">ğŸ“º ì±„ë„ ë¶„ì„</button>
            <button class="nav-tab" onclick="switchTab('keywords')">ğŸ’¡ í‚¤ì›Œë“œ ë§ˆì´ë‹</button>
            <button class="nav-tab" onclick="switchTab('analytics')">ğŸ“Š ì¢…í•© ë¶„ì„</button>
        </div>

        <!-- ì˜ìƒ ê²€ìƒ‰ íƒ­ -->
        <div id="search-tab" class="tab-content active">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸ” ê³ ê¸‰ ì˜ìƒ ê²€ìƒ‰ & ë¶„ì„</h3>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">ê²€ìƒ‰ í‚¤ì›Œë“œ</label>
                        <input type="text" id="searchQuery" class="form-input" placeholder="ì˜ˆ: ìš”ë¦¬, í”„ë¡œê·¸ë˜ë°, ì¬í…Œí¬...">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ê²°ê³¼ ìˆ˜</label>
                        <select id="maxResults" class="form-select">
                            <option value="25">25ê°œ</option>
                            <option value="50">50ê°œ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ì •ë ¬ ê¸°ì¤€</label>
                        <select id="orderBy" class="form-select">
                            <option value="relevance">ê´€ë ¨ë„</option>
                            <option value="viewCount">ì¡°íšŒìˆ˜</option>
                            <option value="date">ìµœì‹ ìˆœ</option>
                            <option value="rating">í‰ì ìˆœ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ì˜ìƒ ê¸¸ì´</label>
                        <select id="videoDuration" class="form-select">
                            <option value="">ì „ì²´</option>
                            <option value="short">ìˆì¸  (4ë¶„ ë¯¸ë§Œ)</option>
                            <option value="medium">ì¤‘ê°„ (4-20ë¶„)</option>
                            <option value="long">ê¸´ì˜ìƒ (20ë¶„ ì´ìƒ)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ì—…ë¡œë“œ ê¸°ê°„</label>
                        <select id="publishedAfter" class="form-select">
                            <option value="">ì „ì²´</option>
                            <option value="day">24ì‹œê°„ ì´ë‚´</option>
                            <option value="week">1ì£¼ì¼ ì´ë‚´</option>
                            <option value="month">1ê°œì›” ì´ë‚´</option>
                            <option value="year">1ë…„ ì´ë‚´</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ì§€ì—­</label>
                        <select id="regionCode" class="form-select">
                            <option value="KR">í•œêµ­</option>
                            <option value="US">ë¯¸êµ­</option>
                            <option value="JP">ì¼ë³¸</option>
                            <option value="GB">ì˜êµ­</option>
                        </select>
                    </div>
                </div>

                <div class="quick-actions">
                    <a href="#" class="quick-action" onclick="quickSearch('ìš”ë¦¬ ë ˆì‹œí”¼')">ìš”ë¦¬ ë ˆì‹œí”¼</a>
                    <a href="#" class="quick-action" onclick="quickSearch('í”„ë¡œê·¸ë˜ë° ê°•ì˜')">í”„ë¡œê·¸ë˜ë°</a>
                    <a href="#" class="quick-action" onclick="quickSearch('ì¬í…Œí¬')">ì¬í…Œí¬</a>
                    <a href="#" class="quick-action" onclick="quickSearch('ìš´ë™')">í™ˆíŠ¸ë ˆì´ë‹</a>
                    <a href="#" class="quick-action" onclick="quickSearch('ê²Œì„')">ê²Œì„</a>
                    <a href="#" class="quick-action" onclick="quickSearch('ë·°í‹°')">ë·°í‹°</a>
                </div>

                <button class="btn btn-primary" style="width: 100%;" onclick="searchVideos()">
                    ğŸ” ê²€ìƒ‰ ë° ë¶„ì„ ì‹œì‘
                </button>
            </div>

            <!-- ê²€ìƒ‰ ê²°ê³¼ -->
            <div class="loading" id="searchLoading">
                <div class="spinner"></div>
                <p>ì˜ìƒ ë¶„ì„ ì¤‘... ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”</p>
            </div>

            <div id="searchResults" class="results-grid"></div>
        </div>

        <!-- ê²½ìŸì ë¶„ì„ íƒ­ -->
        <div id="competitor-tab" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸ† ê²½ìŸì ì±„ë„ ë¶„ì„</h3>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">ê²½ìŸ ì±„ë„ ì´ë¦„ ë˜ëŠ” ID</label>
                        <input type="text" id="competitorChannel" class="form-input" placeholder="ì±„ë„ëª… ë˜ëŠ” @username">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ë¶„ì„ ê¸°ê°„</label>
                        <select id="competitorPeriod" class="form-select">
                            <option value="week">1ì£¼ì¼</option>
                            <option value="month">1ê°œì›”</option>
                            <option value="quarter">3ê°œì›”</option>
                            <option value="year">1ë…„</option>
                        </select>
                    </div>
                </div>

                <button class="btn btn-primary" style="width: 100%;" onclick="analyzeCompetitor()">
                    ğŸ“ˆ ê²½ìŸì ë¶„ì„ ì‹œì‘
                </button>
            </div>

            <div class="loading" id="competitorLoading">
                <div class="spinner"></div>
                <p>ê²½ìŸì ì±„ë„ ë¶„ì„ ì¤‘...</p>
            </div>

            <div id="competitorResults"></div>
        </div>

        <!-- íŠ¸ë Œë“œ ë¶„ì„ íƒ­ -->
        <div id="trending-tab" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸ”¥ ì‹¤ì‹œê°„ íŠ¸ë Œë“œ ë¶„ì„</h3>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">ì¹´í…Œê³ ë¦¬</label>
                        <select id="trendingCategory" class="form-select">
                            <option value="">ì „ì²´</option>
                            <option value="1">ì˜í™”/ì• ë‹ˆë©”ì´ì…˜</option>
                            <option value="2">ìë™ì°¨/êµí†µ</option>
                            <option value="10">ìŒì•…</option>
                            <option value="15">ë°˜ë ¤ë™ë¬¼</option>
                            <option value="17">ìŠ¤í¬ì¸ </option>
                            <option value="19">ì—¬í–‰/ì´ë²¤íŠ¸</option>
                            <option value="20">ê²Œì„</option>
                            <option value="22">ì‚¬ëŒ/ë¸”ë¡œê·¸</option>
                            <option value="23">ì½”ë¯¸ë””</option>
                            <option value="24">ì—”í„°í…Œì¸ë¨¼íŠ¸</option>
                            <option value="25">ë‰´ìŠ¤/ì •ì¹˜</option>
                            <option value="26">í•˜ìš°íˆ¬/ìŠ¤íƒ€ì¼</option>
                            <option value="27">êµìœ¡</option>
                            <option value="28">ê³¼í•™ê¸°ìˆ </option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ì§€ì—­</label>
                        <select id="trendingRegion" class="form-select">
                            <option value="KR">í•œêµ­</option>
                            <option value="US">ë¯¸êµ­</option>
                            <option value="JP">ì¼ë³¸</option>
                            <option value="GB">ì˜êµ­</option>
                        </select>
                    </div>
                </div>

                <button class="btn btn-primary" style="width: 100%;" onclick="analyzeTrending()">
                    ğŸ“Š íŠ¸ë Œë“œ ë¶„ì„ ì‹œì‘
                </button>
            </div>

            <div class="loading" id="trendingLoading">
                <div class="spinner"></div>
                <p>íŠ¸ë Œë“œ ë°ì´í„° ë¶„ì„ ì¤‘...</p>
            </div>

            <div id="trendingResults"></div>
        </div>

        <!-- ì±„ë„ ë¶„ì„ íƒ­ -->
        <div id="channel-tab" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸ“º ì±„ë„ ìƒì„¸ ë¶„ì„</h3>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">ì±„ë„ ì´ë¦„ ë˜ëŠ” ID</label>
                        <input type="text" id="channelName" class="form-input" placeholder="ì±„ë„ëª… ë˜ëŠ” @username">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ë¶„ì„ ì˜ìƒ ìˆ˜</label>
                        <select id="channelVideoCount" class="form-select">
                            <option value="25">ìµœê·¼ 25ê°œ</option>
                            <option value="50">ìµœê·¼ 50ê°œ</option>
                            <option value="100">ìµœê·¼ 100ê°œ</option>
                        </select>
                    </div>
                </div>

                <button class="btn btn-primary" style="width: 100%;" onclick="analyzeChannel()">
                    ğŸ” ì±„ë„ ë¶„ì„ ì‹œì‘
                </button>
            </div>

            <div class="loading" id="channelLoading">
                <div class="spinner"></div>
                <p>ì±„ë„ ë°ì´í„° ë¶„ì„ ì¤‘...</p>
            </div>

            <div id="channelResults"></div>
        </div>

        <!-- í‚¤ì›Œë“œ ë§ˆì´ë‹ íƒ­ -->
        <div id="keywords-tab" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸ’¡ í‚¤ì›Œë“œ ê¸°íšŒ ë°œêµ´</h3>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">ì£¼ì œ/ë¶„ì•¼</label>
                        <input type="text" id="keywordTopic" class="form-input" placeholder="ì˜ˆ: ìš”ë¦¬, í”„ë¡œê·¸ë˜ë°, ì¬í…Œí¬">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ë¶„ì„ ê¹Šì´</label>
                        <select id="keywordDepth" class="form-select">
                            <option value="light">ê¸°ë³¸ ë¶„ì„</option>
                            <option value="medium">ìƒì„¸ ë¶„ì„</option>
                            <option value="deep">ì‹¬ì¸µ ë¶„ì„</option>
                        </select>
                    </div>
                </div>

                <button class="btn btn-primary" style="width: 100%;" onclick="mineKeywords()">
                    â›ï¸ í‚¤ì›Œë“œ ê¸°íšŒ ë°œêµ´
                </button>
            </div>

            <div class="loading" id="keywordLoading">
                <div class="spinner"></div>
                <p>í‚¤ì›Œë“œ ê¸°íšŒ ë¶„ì„ ì¤‘...</p>
            </div>

            <div id="keywordResults"></div>
        </div>

        <!-- ì¢…í•© ë¶„ì„ íƒ­ -->
        <div id="analytics-tab" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸ“Š ì¢…í•© ì‹œì¥ ë¶„ì„</h3>
                </div>

                <div class="analytics-grid">
                    <div class="metric-card">
                        <div class="metric-value" style="color: var(--accent-primary);">0</div>
                        <div class="metric-label">ë¶„ì„ëœ ì˜ìƒ</div>
                        <div class="metric-trend trend-up" id="videosAnalyzedTrend">+0%</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" style="color: var(--accent-secondary);">0</div>
                        <div class="metric-label">ë°œêµ´ëœ ê¸°íšŒ</div>
                        <div class="metric-trend trend-up" id="opportunitiesTrend">+0%</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" style="color: var(--accent-tertiary);">0</div>
                        <div class="metric-label">ê²½ìŸ ì±„ë„</div>
                        <div class="metric-trend trend-up" id="competitorsTrend">+0%</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" style="color: var(--success);">0</div>
                        <div class="metric-label">í‚¤ì›Œë“œ í’€</div>
                        <div class="metric-trend trend-up" id="keywordsTrend">+0%</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h4>ğŸ¯ ë§ì¶¤ ì¶”ì²œ</h4>
                    </div>
                    <div id="personalizedRecommendations">
                        <p class="text-secondary">ë¶„ì„ì„ ì‹œì‘í•˜ë©´ ë§ì¶¤ ì¶”ì²œì´ í‘œì‹œë©ë‹ˆë‹¤.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- API ì„¤ì • ëª¨ë‹¬ -->
    <div class="modal" id="apiModal">
        <div class="modal-content">
            <div class="card-header">
                <h3>âš™ï¸ API ì„¤ì •</h3>
                <button class="btn btn-secondary" onclick="closeApiModal()">Ã—</button>
            </div>
            
            <div class="form-group">
                <label class="form-label">YouTube Data API v3 í‚¤</label>
                <input type="password" id="apiKeyInput" class="form-input" placeholder="AIza...">
                <div style="margin-top: 8px; font-size: 0.8rem; color: var(--text-tertiary);">
                    <a href="https://console.developers.google.com/" target="_blank" style="color: var(--accent-primary);">
                        Google Cloud Consoleì—ì„œ API í‚¤ ë°œê¸‰ë°›ê¸° â†’
                    </a>
                </div>
            </div>

            <div style="display: flex; gap: 16px; margin-top: 24px;">
                <button class="btn btn-primary" style="flex: 1;" onclick="saveApiKey()">ì €ì¥</button>
                <button class="btn btn-secondary" style="flex: 1;" onclick="testApiKey()">ì—°ê²° í…ŒìŠ¤íŠ¸</button>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let apiKey = localStorage.getItem('youtube-api-key') || '';
        let currentTab = 'search';
        let analysisData = {
            videosAnalyzed: 0,
            opportunities: 0,
            competitors: 0,
            keywords: 0
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateApiStatus();
            loadAnalyticsData();
        });

        // Tab switching
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
            currentTab = tabName;
        }

        // API Management
        function updateApiStatus() {
            const setup = document.getElementById('apiKeySetup');
            if (apiKey) {
                setup.classList.remove('show');
            } else {
                setup.classList.add('show');
            }
        }

        function openApiModal() {
            document.getElementById('apiModal').classList.add('show');
            document.getElementById('apiKeyInput').value = apiKey;
        }

        function closeApiModal() {
            document.getElementById('apiModal').classList.remove('show');
        }

        async function saveApiKey() {
            const input = document.getElementById('apiKeyInput');
            const newKey = input.value.trim();

            if (!newKey) {
                alert('API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            try {
                // Test the key first
                await testYouTubeAPI(newKey);
                
                // Save if valid
                apiKey = newKey;
                localStorage.setItem('youtube-api-key', apiKey);
                updateApiStatus();
                closeApiModal();
                alert('API í‚¤ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
            } catch (error) {
                alert('API í‚¤ê°€ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        async function testApiKey() {
            const input = document.getElementById('apiKeyInput');
            const testKey = input.value.trim();

            if (!testKey) {
                alert('API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            try {
                await testYouTubeAPI(testKey);
                alert('API í‚¤ê°€ ìœ íš¨í•©ë‹ˆë‹¤!');
            } catch (error) {
                alert('ì—°ê²° ì‹¤íŒ¨: ' + error.message);
            }
        }

        async function testYouTubeAPI(key) {
            const response = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&q=test&type=video&maxResults=1&key=${key}`);
            
            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.error?.message || 'API í˜¸ì¶œ ì‹¤íŒ¨');
            }

            return await response.json();
        }

        // Search functionality
        function quickSearch(query) {
            document.getElementById('searchQuery').value = query;
            searchVideos();
        }

        async function searchVideos() {
            if (!apiKey) {
                alert('API í‚¤ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.');
                openApiModal();
                return;
            }

            const query = document.getElementById('searchQuery').value.trim();
            if (!query) {
                alert('ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            showLoading('searchLoading', true);
            
            try {
                // Build search parameters
                const params = new URLSearchParams({
                    part: 'snippet',
                    q: query,
                    type: 'video',
                    maxResults: document.getElementById('maxResults').value,
                    order: document.getElementById('orderBy').value,
                    regionCode: document.getElementById('regionCode').value,
                    key: apiKey
                });

                // Add optional filters
                const duration = document.getElementById('videoDuration').value;
                if (duration) params.append('videoDuration', duration);

                const publishedAfter = getPublishedAfterDate(document.getElementById('publishedAfter').value);
                if (publishedAfter) params.append('publishedAfter', publishedAfter);

                // Search videos
                const searchResponse = await fetch(`https://www.googleapis.com/youtube/v3/search?${params}`);
                if (!searchResponse.ok) throw new Error('ê²€ìƒ‰ ì‹¤íŒ¨');
                
                const searchData = await searchResponse.json();
                
                // Enrich with detailed data
                await enrichVideoData(searchData.items);
                
                // Display results
                displaySearchResults(searchData.items);
                
                // Update analytics
                analysisData.videosAnalyzed += searchData.items.length;
                updateAnalytics();

            } catch (error) {
                alert('ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ' + error.message);
            } finally {
                showLoading('searchLoading', false);
            }
        }

        async function enrichVideoData(videos) {
            if (!videos.length) return;

            try {
                // Get video statistics
                const videoIds = videos.map(v => v.id.videoId).join(',');
                const statsResponse = await fetch(
                    `https://www.googleapis.com/youtube/v3/videos?part=statistics,contentDetails&id=${videoIds}&key=${apiKey}`
                );
                const statsData = await statsResponse.json();

                // Get channel data
                const channelIds = [...new Set(videos.map(v => v.snippet.channelId))].join(',');
                const channelResponse = await fetch(
                    `https://www.googleapis.com/youtube/v3/channels?part=statistics&id=${channelIds}&key=${apiKey}`
                );
                const channelData = await channelResponse.json();

                // Merge data
                const statsMap = new Map(statsData.items?.map(item => [item.id, item]) || []);
                const channelMap = new Map(channelData.items?.map(item => [item.id, item]) || []);

                videos.forEach(video => {
                    const stats = statsMap.get(video.id.videoId);
                    const channel = channelMap.get(video.snippet.channelId);
                    
                    if (stats) {
                        video.statistics = stats.statistics;
                        video.contentDetails = stats.contentDetails;
                    }
                    if (channel) {
                        video.channelStatistics = channel.statistics;
                    }
                });

            } catch (error) {
                console.warn('ë°ì´í„° ë³´ê°• ì‹¤íŒ¨:', error);
            }
        }

        function displaySearchResults(videos) {
            const container = document.getElementById('searchResults');
            container.innerHTML = '';

            videos.forEach(video => {
                const card = createVideoCard(video);
                container.appendChild(card);
            });
        }

        function createVideoCard(video) {
            const div = document.createElement('div');
            div.className = 'video-card';

            const stats = video.statistics || {};
            const channelStats = video.channelStatistics || {};
            
            const viewCount = formatNumber(parseInt(stats.viewCount || 0));
            const likeCount = formatNumber(parseInt(stats.likeCount || 0));
            const subscriberCount = formatNumber(parseInt(channelStats.subscriberCount || 0));
            const duration = formatDuration(video.contentDetails?.duration);
            
            // Calculate engagement rate
            const views = parseInt(stats.viewCount || 0);
            const likes = parseInt(stats.likeCount || 0);
            const comments = parseInt(stats.commentCount || 0);
            const engagementRate = views > 0 ? ((likes + comments) / views * 100).toFixed(2) : 0;

            // Performance analysis badges
            const badges = [];
            if (views > 100000) badges.push({ text: 'ê³ ì¡°íšŒìˆ˜', class: 'badge-success' });
            if (engagementRate > 5) badges.push({ text: 'ë†’ì€ ì°¸ì—¬ë„', class: 'badge-success' });
            if (duration && isDurationOptimal(duration)) badges.push({ text: 'ìµœì  ê¸¸ì´', class: 'badge-info' });
            
            const publishedDays = Math.floor((Date.now() - new Date(video.snippet.publishedAt)) / (1000 * 60 * 60 * 24));
            if (publishedDays <= 7) badges.push({ text: 'ìµœì‹ ', class: 'badge-warning' });

            div.innerHTML = `
                <div class="video-thumbnail">
                    <img src="${video.snippet.thumbnails.medium?.url || video.snippet.thumbnails.default.url}" 
                         alt="${escapeHtml(video.snippet.title)}" loading="lazy">
                    ${duration ? `<div class="video-duration">${duration}</div>` : ''}
                </div>
                <div class="video-info">
                    <div class="video-title">${escapeHtml(video.snippet.title)}</div>
                    <div class="video-channel">${escapeHtml(video.snippet.channelTitle)}</div>
                    
                    <div class="video-stats">
                        <div class="stat-item">
                            <div class="stat-value">${viewCount}</div>
                            <div class="stat-label">ì¡°íšŒìˆ˜</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">${likeCount}</div>
                            <div class="stat-label">ì¢‹ì•„ìš”</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">${subscriberCount}</div>
                            <div class="stat-label">êµ¬ë…ì</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">${engagementRate}%</div>
                            <div class="stat-label">ì°¸ì—¬ìœ¨</div>
                        </div>
                    </div>

                    <div class="analysis-badges">
                        ${badges.map(badge => `<span class="badge ${badge.class}">${badge.text}</span>`).join('')}
                    </div>
                </div>
            `;

            // Add click handler to open video
            div.addEventListener('click', () => {
                window.open(`https://www.youtube.com/watch?v=${video.id.videoId}`, '_blank');
            });

            return div;
        }

        // Competitor analysis
        async function analyzeCompetitor() {
            if (!apiKey) {
                alert('API í‚¤ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.');
                return;
            }

            const channelName = document.getElementById('competitorChannel').value.trim();
            if (!channelName) {
                alert('ì±„ë„ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            showLoading('competitorLoading', true);
            
            try {
                // Search for channel
                const searchResponse = await fetch(
                    `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${encodeURIComponent(channelName)}&type=channel&maxResults=5&key=${apiKey}`
                );
                const searchData = await searchResponse.json();
                
                if (!searchData.items?.length) {
                    throw new Error('ì±„ë„ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }

                // Get channel details
                const channelId = searchData.items[0].snippet.channelId;
                const channelResponse = await fetch(
                    `https://www.googleapis.com/youtube/v3/channels?part=snippet,statistics,brandingSettings&id=${channelId}&key=${apiKey}`
                );
                const channelData = await channelResponse.json();

                // Get recent videos
                const videosResponse = await fetch(
                    `https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${channelId}&type=video&order=date&maxResults=20&key=${apiKey}`
                );
                const videosData = await videosResponse.json();

                // Display competitor analysis
                displayCompetitorAnalysis(channelData.items[0], videosData.items);
                
                analysisData.competitors += 1;
                updateAnalytics();

            } catch (error) {
                alert('ë¶„ì„ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ' + error.message);
            } finally {
                showLoading('competitorLoading', false);
            }
        }

        function displayCompetitorAnalysis(channel, videos) {
            const container = document.getElementById('competitorResults');
            const stats = channel.statistics;

            container.innerHTML = `
                <div class="card">
                    <div class="card-header">
                        <h3>ğŸ“Š ${escapeHtml(channel.snippet.title)} ë¶„ì„</h3>
                    </div>
                    
                    <div class="analytics-grid">
                        <div class="metric-card">
                            <div class="metric-value" style="color: var(--accent-primary);">${formatNumber(parseInt(stats.subscriberCount))}</div>
                            <div class="metric-label">êµ¬ë…ì</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" style="color: var(--accent-secondary);">${formatNumber(parseInt(stats.videoCount))}</div>
                            <div class="metric-label">ì´ ì˜ìƒ</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" style="color: var(--accent-tertiary);">${formatNumber(parseInt(stats.viewCount))}</div>
                            <div class="metric-label">ì´ ì¡°íšŒìˆ˜</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" style="color: var(--success);">${Math.floor(parseInt(stats.viewCount) / parseInt(stats.videoCount))}</div>
                            <div class="metric-label">í‰ê·  ì¡°íšŒìˆ˜</div>
                        </div>
                    </div>

                    <div class="card-header">
                        <h4>ğŸ¬ ìµœê·¼ ì˜ìƒ ì„±ê³¼</h4>
                    </div>
                    <div class="results-grid">
                        ${videos.slice(0, 6).map(video => createVideoCard(video)).map(card => card.outerHTML).join('')}
                    </div>
                </div>
            `;
        }

        // Trending analysis
        async function analyzeTrending() {
            if (!apiKey) {
                alert('API í‚¤ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.');
                return;
            }

            showLoading('trendingLoading', true);
            
            try {
                const params = new URLSearchParams({
                    part: 'snippet,statistics',
                    chart: 'mostPopular',
                    regionCode: document.getElementById('trendingRegion').value,
                    maxResults: '50',
                    key: apiKey
                });

                const categoryId = document.getElementById('trendingCategory').value;
                if (categoryId) params.append('videoCategoryId', categoryId);

                const response = await fetch(`https://www.googleapis.com/youtube/v3/videos?${params}`);
                if (!response.ok) throw new Error('íŠ¸ë Œë“œ ë°ì´í„° ì¡°íšŒ ì‹¤íŒ¨');
                
                const data = await response.json();
                displayTrendingResults(data.items);

            } catch (error) {
                alert('íŠ¸ë Œë“œ ë¶„ì„ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ' + error.message);
            } finally {
                showLoading('trendingLoading', false);
            }
        }

        function displayTrendingResults(videos) {
            const container = document.getElementById('trendingResults');
            
            container.innerHTML = `
                <div class="card">
                    <div class="card-header">
                        <h3>ğŸ”¥ í˜„ì¬ íŠ¸ë Œë”© ì˜ìƒ</h3>
                    </div>
                    <div class="results-grid">
                        ${videos.map(video => {
                            // Convert format for compatibility
                            video.id = { videoId: video.id };
                            return createVideoCard(video);
                        }).map(card => card.outerHTML).join('')}
                    </div>
                </div>
            `;
        }

        // Channel analysis
        async function analyzeChannel() {
            if (!apiKey) {
                alert('API í‚¤ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.');
                return;
            }

            const channelName = document.getElementById('channelName').value.trim();
            if (!channelName) {
                alert('ì±„ë„ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            showLoading('channelLoading', true);
            // Implementation similar to competitor analysis but more detailed
            showLoading('channelLoading', false);
        }

        // Keyword mining
        async function mineKeywords() {
            if (!apiKey) {
                alert('API í‚¤ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.');
                return;
            }

            const topic = document.getElementById('keywordTopic').value.trim();
            if (!topic) {
                alert('ì£¼ì œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            showLoading('keywordLoading', true);
            
            try {
                // Generate related keywords and analyze each
                const keywords = generateKeywordVariations(topic);
                const results = [];

                for (const keyword of keywords.slice(0, 10)) {
                    const searchResponse = await fetch(
                        `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${encodeURIComponent(keyword)}&type=video&maxResults=10&key=${apiKey}`
                    );
                    const searchData = await searchResponse.json();
                    
                    if (searchData.items?.length) {
                        results.push({
                            keyword,
                            videoCount: searchData.items.length,
                            avgViews: calculateAverageViews(searchData.items),
                            competition: assessCompetition(searchData.items)
                        });
                    }
                }

                displayKeywordResults(results);
                analysisData.keywords += results.length;
                updateAnalytics();

            } catch (error) {
                alert('í‚¤ì›Œë“œ ë¶„ì„ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ' + error.message);
            } finally {
                showLoading('keywordLoading', false);
            }
        }

        function generateKeywordVariations(topic) {
            const prefixes = ['', 'ì´ˆë³´', 'ê³ ê¸‰', 'ì‰¬ìš´', 'ë¹ ë¥¸', 'ì™„ë²½í•œ'];
            const suffixes = ['', 'ë°©ë²•', 'ê°•ì˜', 'ê°€ì´ë“œ', 'íŒ', 'ë¹„ë²•', 'í•˜ëŠ”ë²•', 'ì™„ì „ì •ë³µ'];
            const variations = [];

            prefixes.forEach(prefix => {
                suffixes.forEach(suffix => {
                    const variation = [prefix, topic, suffix].filter(Boolean).join(' ').trim();
                    if (variation !== topic && !variations.includes(variation)) {
                        variations.push(variation);
                    }
                });
            });

            return [topic, ...variations];
        }

        function displayKeywordResults(results) {
            const container = document.getElementById('keywordResults');
            
            container.innerHTML = `
                <div class="card">
                    <div class="card-header">
                        <h3>ğŸ’¡ í‚¤ì›Œë“œ ê¸°íšŒ ë¶„ì„</h3>
                    </div>
                    <div class="results-grid">
                        ${results.map(result => `
                            <div class="video-card" style="cursor: pointer;" onclick="quickSearch('${result.keyword}')">
                                <div class="video-info">
                                    <div class="video-title">${escapeHtml(result.keyword)}</div>
                                    <div class="video-stats">
                                        <div class="stat-item">
                                            <div class="stat-value">${result.videoCount}</div>
                                            <div class="stat-label">ê´€ë ¨ ì˜ìƒ</div>
                                        </div>
                                        <div class="stat-item">
                                            <div class="stat-value">${formatNumber(result.avgViews)}</div>
                                            <div class="stat-label">í‰ê·  ì¡°íšŒìˆ˜</div>
                                        </div>
                                    </div>
                                    <div class="analysis-badges">
                                        <span class="badge ${result.competition < 5 ? 'badge-success' : result.competition < 8 ? 'badge-warning' : 'badge-error'}">
                                            ê²½ìŸë„: ${result.competition}/10
                                        </span>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // Helper functions
        function showLoading(loadingId, show) {
            const loading = document.getElementById(loadingId);
            if (show) {
                loading.classList.add('show');
            } else {
                loading.classList.remove('show');
            }
        }

        function formatNumber(num) {
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
            return num.toLocaleString();
        }

        function formatDuration(isoDuration) {
            if (!isoDuration) return '';
            
            const match = isoDuration.match(/PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?/);
            if (!match) return '';

            const hours = parseInt(match[1] || '0');
            const minutes = parseInt(match[2] || '0');
            const seconds = parseInt(match[3] || '0');

            if (hours > 0) {
                return `${hours}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
            return `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }

        function isDurationOptimal(duration) {
            // Parse duration to get total seconds
            const parts = duration.split(':');
            let totalSeconds = 0;
            
            if (parts.length === 3) {
                totalSeconds = parseInt(parts[0]) * 3600 + parseInt(parts[1]) * 60 + parseInt(parts[2]);
            } else if (parts.length === 2) {
                totalSeconds = parseInt(parts[0]) * 60 + parseInt(parts[1]);
            }

            // Optimal duration is typically 8-12 minutes
            return totalSeconds >= 480 && totalSeconds <= 720;
        }

        function getPublishedAfterDate(period) {
            if (!period) return '';
            
            const now = new Date();
            const periods = {
                day: new Date(now - 24 * 60 * 60 * 1000),
                week: new Date(now - 7 * 24 * 60 * 60 * 1000),
                month: new Date(now - 30 * 24 * 60 * 60 * 1000),
                year: new Date(now - 365 * 24 * 60 * 60 * 1000)
            };

            return periods[period]?.toISOString() || '';
        }

        function calculateAverageViews(videos) {
            // This would need video statistics, returning placeholder
            return Math.floor(Math.random() * 100000) + 10000;
        }

        function assessCompetition(videos) {
            // Simple competition assessment based on number of videos
            return Math.min(10, Math.floor(videos.length / 10 * 10));
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function updateAnalytics() {
            document.querySelector('.analytics-grid .metric-card:nth-child(1) .metric-value').textContent = 
                formatNumber(analysisData.videosAnalyzed);
            document.querySelector('.analytics-grid .metric-card:nth-child(2) .metric-value').textContent = 
                formatNumber(analysisData.opportunities);
            document.querySelector('.analytics-grid .metric-card:nth-child(3) .metric-value').textContent = 
                formatNumber(analysisData.competitors);
            document.querySelector('.analytics-grid .metric-card:nth-child(4) .metric-value').textContent = 
                formatNumber(analysisData.keywords);

            // Save to localStorage
            localStorage.setItem('analysis-data', JSON.stringify(analysisData));
        }

        function loadAnalyticsData() {
            const saved = localStorage.getItem('analysis-data');
            if (saved) {
                analysisData = JSON.parse(saved);
                updateAnalytics();
            }
        }

        // ESC key to close modal
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeApiModal();
            }
        });
    </script>
</body>
</html>